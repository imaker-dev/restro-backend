2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis max retries reached
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:30 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:30 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis max retries reached
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis max retries reached
2026-02-03 12:18:31 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:44 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:44 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:44 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:44 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Redis max retries reached
2026-02-03 12:18:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Redis max retries reached
2026-02-03 12:18:45 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis max retries reached
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis max retries reached
2026-02-03 12:19:19 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:19 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:19 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:19 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:20 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:20 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:20 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:20 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:20 [ERROR]: Redis max retries reached
2026-02-03 12:19:20 [ERROR]: Redis max retries reached
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:29 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:29 [ERROR]: Redis max retries reached
2026-02-03 12:19:29 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:29 [ERROR]: Redis max retries reached
2026-02-03 12:20:21 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:21 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis max retries reached
2026-02-03 12:20:22 [ERROR]: Redis max retries reached
2026-02-03 12:23:40 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:40 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:40 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:40 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:41 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:41 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:41 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:41 [ERROR]: Redis max retries reached
2026-02-03 12:23:41 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:41 [ERROR]: Redis max retries reached
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:46 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:46 [ERROR]: Redis max retries reached
2026-02-03 12:38:46 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:46 [ERROR]: Redis max retries reached
2026-02-03 13:11:31 [ERROR]: Unhandled error: cache.delete is not a function
TypeError: cache.delete is not a function
    at Object.invalidateCache (E:\restro-backend\src\services\table.service.js:879:23)
    at Object.startSession (E:\restro-backend\src\services\table.service.js:387:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:140:22)
2026-02-03 13:11:59 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:140:22)
2026-02-03 13:34:20 [ERROR]: Get tax groups error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"\n      SELECT tg.*,\n        (SELECT JSON_ARRAYAGG(JSON_OBJECT(\n          'id', tc.id,\n          'name', tc.name,\n          'code', tc.code,\n          'rate', tc.rate\n        ))\n        FROM tax_group_components tgc\n        JOIN tax_components tc ON tgc.tax_component_id = tc.id\n        WHERE tgc.tax_group_id = tg.id AND tgc.is_active = 1\n        ) as components\n      FROM tax_groups tg\n      WHERE tg.is_active = 1\n     ORDER BY tg.is_default DESC, tg.name","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTaxGroups (E:\restro-backend\src\services\tax.service.js:238:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTaxGroups (E:\restro-backend\src\controllers\tax.controller.js:105:22)
2026-02-03 15:07:16 [ERROR]: Create order error: Column 'created_by' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('83cac48f-ed7e-42e0-8852-687359a4828e', 4, 'ORD2602030009', 'dine_in', 7, 3, NULL, NULL, NULL, 'Test Customer', '9876543210', 1, 'pending', 'pending', 'Test order for lifecycle verification', NULL)","sqlState":"23000","sqlMessage":"Column 'created_by' cannot be null"}
Error: Column 'created_by' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:98:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-03 15:07:16 [ERROR]: Add items error: Unknown column 'u.full_name' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT o.*, t.table_number, t.name as table_name,\n        f.name as floor_name, s.name as section_name,\n        u.full_name as created_by_name\n       FROM orders o\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON o.floor_id = f.id\n       LEFT JOIN sections s ON o.section_id = s.id\n       LEFT JOIN users u ON o.created_by = u.id\n       WHERE o.id = 'null'","sqlState":"42S22","sqlMessage":"Unknown column 'u.full_name' in 'field list'"}
Error: Unknown column 'u.full_name' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getById (E:\restro-backend\src\services\order.service.js:316:31)
    at Object.addItems (E:\restro-backend\src\services\order.service.js:144:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:07:17 [ERROR]: Generate bill error: Unknown column 'u.full_name' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT o.*, t.table_number, t.name as table_name,\n        f.name as floor_name, s.name as section_name,\n        u.full_name as created_by_name\n       FROM orders o\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON o.floor_id = f.id\n       LEFT JOIN sections s ON o.section_id = s.id\n       LEFT JOIN users u ON o.created_by = u.id\n       WHERE o.id = 'null'","sqlState":"42S22","sqlMessage":"Unknown column 'u.full_name' in 'field list'"}
Error: Unknown column 'u.full_name' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getById (E:\restro-backend\src\services\order.service.js:316:31)
    at Object.getOrderWithItems (E:\restro-backend\src\services\order.service.js:338:30)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:51:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:07:17 [ERROR]: Get order error: Unknown column 'u.full_name' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT o.*, t.table_number, t.name as table_name,\n        f.name as floor_name, s.name as section_name,\n        u.full_name as created_by_name\n       FROM orders o\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON o.floor_id = f.id\n       LEFT JOIN sections s ON o.section_id = s.id\n       LEFT JOIN users u ON o.created_by = u.id\n       WHERE o.id = 'null'","sqlState":"42S22","sqlMessage":"Unknown column 'u.full_name' in 'field list'"}
Error: Unknown column 'u.full_name' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getById (E:\restro-backend\src\services\order.service.js:316:31)
    at Object.getOrderWithItems (E:\restro-backend\src\services\order.service.js:338:30)
    at getOrder (E:\restro-backend\src\controllers\order.controller.js:33:40)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
2026-02-03 15:09:25 [ERROR]: Create order error: Column 'created_by' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('8a632d3a-e7eb-4d45-b5d4-d9aba04715fd', 4, 'ORD2602030009', 'dine_in', 8, 4, NULL, NULL, NULL, 'Test Customer', '9876543210', 2, 'pending', 'pending', 'Test order for lifecycle verification', NULL)","sqlState":"23000","sqlMessage":"Column 'created_by' cannot be null"}
Error: Column 'created_by' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:98:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-03 15:09:25 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:145:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:09:25 [ERROR]: Generate bill error: Order not found
Error: Order not found
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:52:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:10:05 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:118:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-03 15:10:05 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.addItems (E:\restro-backend\src\services\order.service.js:263:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:10:05 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.addItems (E:\restro-backend\src\services\order.service.js:263:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:10:05 [ERROR]: Generate bill error: Cannot read properties of undefined (reading 'includes')
TypeError: Cannot read properties of undefined (reading 'includes')
    at Object.calculateBillDetails (E:\restro-backend\src\services\billing.service.js:224:25)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:77:38)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:10:49 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:118:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-03 15:10:49 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.addItems (E:\restro-backend\src\services\order.service.js:263:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:170:20)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:170:20)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-03 15:10:49 [ERROR]: Send KOT error: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:196:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-03 15:10:49 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.addItems (E:\restro-backend\src\services\order.service.js:263:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:170:20)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-03 15:10:49 [ERROR]: Send KOT error: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:196:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.acceptKot (E:\restro-backend\src\services\kot.service.js:274:16)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async acceptKot (E:\restro-backend\src\controllers\order.controller.js:218:19)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.markKotServed (E:\restro-backend\src\services\kot.service.js:487:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markKotServed (E:\restro-backend\src\controllers\order.controller.js:258:19)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.markKotServed (E:\restro-backend\src\services\kot.service.js:487:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markKotServed (E:\restro-backend\src\controllers\order.controller.js:258:19)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.markKotServed (E:\restro-backend\src\services\kot.service.js:487:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markKotServed (E:\restro-backend\src\controllers\order.controller.js:258:19)
2026-02-03 15:10:49 [ERROR]: Mark KOT served error: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.checkOrderServedStatus (E:\restro-backend\src\services\kot.service.js:548:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.markKotServed (E:\restro-backend\src\services\kot.service.js:490:7)
    at async markKotServed (E:\restro-backend\src\controllers\order.controller.js:258:19)
2026-02-03 15:10:49 [ERROR]: Generate bill error: Cannot read properties of undefined (reading 'includes')
TypeError: Cannot read properties of undefined (reading 'includes')
    at Object.calculateBillDetails (E:\restro-backend\src\services\billing.service.js:224:25)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:77:38)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:11:38 [ERROR]: Generate bill error: Cannot read properties of undefined (reading 'includes')
TypeError: Cannot read properties of undefined (reading 'includes')
    at Object.calculateBillDetails (E:\restro-backend\src\services\billing.service.js:224:25)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:77:38)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:25:35 [ERROR]: Failed to create print job for invoice INV/2526/000003: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:27:24 [ERROR]: Failed to create print job for invoice INV/2526/000004: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:28:39 [ERROR]: Failed to create print job for invoice INV/2526/000005: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:29:07 [ERROR]: Failed to create print job for invoice INV/2526/000006: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:29:07 [ERROR]: Process payment error: Column 'outlet_id' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO payments (\n          uuid, outlet_id, order_id, invoice_id, payment_number,\n          payment_mode, amount, tip_amount, total_amount, status,\n          transaction_id, reference_number,\n          card_last_four, card_type, upi_id, wallet_name, bank_name,\n          notes, received_by\n        ) VALUES ('1fae1d48-c051-4cc2-af35-54b897b728bd', NULL, 15, 6, 'PAY2602030001', 'cash', 2541, 0, 2541, 'completed', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1)","sqlState":"23000","sqlMessage":"Column 'outlet_id' cannot be null"}
Error: Column 'outlet_id' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:90:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-03 15:29:38 [ERROR]: Failed to create print job for invoice INV/2526/000007: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:29:38 [ERROR]: Process payment error: Column 'outlet_id' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO payments (\n          uuid, outlet_id, order_id, invoice_id, payment_number,\n          payment_mode, amount, tip_amount, total_amount, status,\n          transaction_id, reference_number,\n          card_last_four, card_type, upi_id, wallet_name, bank_name,\n          notes, received_by\n        ) VALUES ('a70eabce-0dd5-4e4e-8c9d-6091be489a69', NULL, 16, 7, 'PAY2602030001', 'cash', 2541, 0, 2541, 'completed', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1)","sqlState":"23000","sqlMessage":"Column 'outlet_id' cannot be null"}
Error: Column 'outlet_id' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:90:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-03 18:01:29 [ERROR]: Create user failed: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
Error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
    at UserService.createUser (E:\restro-backend\src\services\user.service.js:211:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createUser (E:\restro-backend\src\controllers\user.controller.js:52:18)
2026-02-03 18:01:29 [ERROR]: Unhandled error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
Error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
    at UserService.createUser (E:\restro-backend\src\services\user.service.js:211:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createUser (E:\restro-backend\src\controllers\user.controller.js:52:18)
2026-02-03 18:01:29 [ERROR]: Update user failed: Managers cannot update admin or manager users
Error: Managers cannot update admin or manager users
    at UserService.updateUser (E:\restro-backend\src\services\user.service.js:308:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateUser (E:\restro-backend\src\controllers\user.controller.js:77:18)
2026-02-03 18:01:29 [ERROR]: Unhandled error: Managers cannot update admin or manager users
Error: Managers cannot update admin or manager users
    at UserService.updateUser (E:\restro-backend\src\services\user.service.js:308:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateUser (E:\restro-backend\src\controllers\user.controller.js:77:18)
2026-02-03 18:26:50 [ERROR]: Get my permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getMyPermissions (E:\restro-backend\src\controllers\permission.controller.js:34:25)
2026-02-03 18:26:50 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getMyPermissions (E:\restro-backend\src\controllers\permission.controller.js:34:25)
2026-02-03 18:26:50 [ERROR]: Check permission failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async checkPermission (E:\restro-backend\src\controllers\permission.controller.js:288:25)
2026-02-03 18:26:50 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async checkPermission (E:\restro-backend\src\controllers\permission.controller.js:288:25)
2026-02-03 18:26:50 [ERROR]: Get grantable permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.getGrantablePermissions (E:\restro-backend\src\services\permission.service.js:566:26)
    at async getGrantablePermissions (E:\restro-backend\src\controllers\permission.controller.js:53:25)
2026-02-03 18:26:50 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.getGrantablePermissions (E:\restro-backend\src\services\permission.service.js:566:26)
    at async getGrantablePermissions (E:\restro-backend\src\controllers\permission.controller.js:53:25)
2026-02-03 18:26:51 [ERROR]: Get user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:51 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:51 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:51 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:51 [ERROR]: Get user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:51 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:51 [ERROR]: Get my permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getMyPermissions (E:\restro-backend\src\controllers\permission.controller.js:34:25)
2026-02-03 18:26:51 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getMyPermissions (E:\restro-backend\src\controllers\permission.controller.js:34:25)
2026-02-03 18:26:52 [ERROR]: Get user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:52 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Revoke permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.revokePermissions (E:\restro-backend\src\services\permission.service.js:289:26)
    at async revokePermissions (E:\restro-backend\src\controllers\permission.controller.js:192:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.revokePermissions (E:\restro-backend\src\services\permission.service.js:289:26)
    at async revokePermissions (E:\restro-backend\src\controllers\permission.controller.js:192:20)
2026-02-03 18:26:52 [ERROR]: Get user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:52 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Get grantable permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.getGrantablePermissions (E:\restro-backend\src\services\permission.service.js:566:26)
    at async getGrantablePermissions (E:\restro-backend\src\controllers\permission.controller.js:53:25)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.getGrantablePermissions (E:\restro-backend\src\services\permission.service.js:566:26)
    at async getGrantablePermissions (E:\restro-backend\src\controllers\permission.controller.js:53:25)
2026-02-03 18:26:52 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Set user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.setUserPermissions (E:\restro-backend\src\services\permission.service.js:369:25)
    at async setUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:102:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.setUserPermissions (E:\restro-backend\src\services\permission.service.js:369:25)
    at async setUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:102:20)
2026-02-03 18:26:52 [ERROR]: Get user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:48:00 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN is required for all staff"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 10:21:41 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-04 10:22:35 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-04 10:34:48 [ERROR]: Create user failed: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
Error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
    at UserService.createUser (E:\restro-backend\src\services\user.service.js:224:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createUser (E:\restro-backend\src\controllers\user.controller.js:52:18)
2026-02-04 10:34:48 [ERROR]: Unhandled error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
Error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
    at UserService.createUser (E:\restro-backend\src\services\user.service.js:224:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createUser (E:\restro-backend\src\controllers\user.controller.js:52:18)
2026-02-04 11:43:14 [ERROR]: Unhandled error: Unexpected token ',', ..."utletId": ,
  "devic"... is not valid JSON {"expose":true,"statusCode":400,"status":400,"body":"{\n  \"employeeCode\": \"CAP001\",\n  \"pin\": \"1234\",\n  \"outletId\": ,\n  \"deviceType\": \"captain_app\"\n}","type":"entity.parse.failed"}
SyntaxError: Unexpected token ',', ..."utletId": ,
  "devic"... is not valid JSON
    at JSON.parse (<anonymous>)
    at parse (E:\restro-backend\node_modules\body-parser\lib\types\json.js:92:19)
    at E:\restro-backend\node_modules\body-parser\lib\read.js:128:18
    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)
    at invokeCallback (E:\restro-backend\node_modules\raw-body\index.js:238:16)
    at done (E:\restro-backend\node_modules\raw-body\index.js:227:7)
    at IncomingMessage.onEnd (E:\restro-backend\node_modules\raw-body\index.js:287:7)
    at IncomingMessage.emit (node:events:518:28)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)
2026-02-04 11:43:25 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 11:43:33 [ERROR]: Unhandled error: Expected double-quoted property name in JSON at position 49 (line 6 column 1) {"expose":true,"statusCode":400,"status":400,"body":"{\n  \"employeeCode\": \"CAP001\",\n  \"pin\": \"1234\",\n\n\n}","type":"entity.parse.failed"}
SyntaxError: Expected double-quoted property name in JSON at position 49 (line 6 column 1)
    at JSON.parse (<anonymous>)
    at parse (E:\restro-backend\node_modules\body-parser\lib\types\json.js:92:19)
    at E:\restro-backend\node_modules\body-parser\lib\read.js:128:18
    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)
    at invokeCallback (E:\restro-backend\node_modules\raw-body\index.js:238:16)
    at done (E:\restro-backend\node_modules\raw-body\index.js:227:7)
    at IncomingMessage.onEnd (E:\restro-backend\node_modules\raw-body\index.js:287:7)
    at IncomingMessage.emit (node:events:518:28)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)
2026-02-04 11:43:41 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 11:47:02 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"},{"field":"pin","message":"PIN is required for all staff"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 11:49:12 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"},{"field":"pin","message":"PIN is required for all staff"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:07:26 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"},{"field":"tableNumber","message":"tableNumber is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:07:27 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"discountType","message":"discountType is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:16:14 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:16:26 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:17:02 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:41:58 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-04 12:42:06 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-04 12:42:15 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"email","message":"Email is required"},{"field":"password","message":"Password is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 12:42:33 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-04 12:50:46 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"employeeCode","message":"Employee code is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 12:53:43 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"email","message":"Email is required"},{"field":"password","message":"Password is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 13:05:44 [ERROR]: Create kitchen station error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Main Kitchen', 'KITCHEN', 'kitchen', 'Main food preparation area', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:05:44 [ERROR]: Create kitchen station error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Dessert Station', 'DESSERT', 'dessert', 'Desserts and sweets', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:05:44 [ERROR]: Create counter error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO counters (outlet_id, floor_id, name, code, counter_type, description, printer_id, is_active, display_order)\n       VALUES (4, 2, 'Main Bar', 'MAINBAR', 'bar', 'Main bar counter', NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'"}
Error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createCounter (E:\restro-backend\src\services\kitchenStation.service.js:100:33)
    at createCounter (E:\restro-backend\src\controllers\tax.controller.js:424:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:05:44 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Food Items', 'food-items', 'Main food items', 'https://example.com/food.jpg', NULL, NULL, 0, true, true)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:05:44 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Liquor', 'liquor', 'Alcoholic beverages', 'https://example.com/liquor.jpg', NULL, NULL, 0, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:05:44 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Desserts', 'desserts', 'Sweet treats', 'https://example.com/dessert.jpg', NULL, NULL, 0, true, true)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:05:44 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Mocktails', 'mocktails', 'Non-alcoholic beverages', 'https://example.com/mocktail.jpg', NULL, NULL, 0, true, true)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 13:05:44 [ERROR]: Preview menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id AND cf.floor_id = 1 AND cf.is_available = 1)\n        )\n      \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async previewMenu (E:\restro-backend\src\controllers\menu.controller.js:419:20)
2026-02-04 13:05:44 [ERROR]: Preview menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id AND cf.floor_id = 2 AND cf.is_available = 1)\n        )\n      \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async previewMenu (E:\restro-backend\src\controllers\menu.controller.js:419:20)
2026-02-04 13:05:44 [ERROR]: Get captain menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.getCaptainMenu (E:\restro-backend\src\services\menuEngine.service.js:151:18)
    at async getCaptainMenu (E:\restro-backend\src\controllers\menu.controller.js:407:20)
2026-02-04 13:06:00 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Test Main Course', 'test-main-course', 'Main course food items', NULL, NULL, NULL, 1, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:06:00 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Test Beverages', 'test-beverages', 'Non-alcoholic beverages', NULL, NULL, NULL, 2, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:06:00 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Test Desserts', 'test-desserts', 'Sweet treats', NULL, NULL, NULL, 3, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:06:00 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Test Liquor', 'test-liquor', 'Alcoholic beverages - Bar only', NULL, NULL, NULL, 4, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:06:00 [ERROR]: Create addon error: Unknown column 'image_url' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO addons (addon_group_id, name, price, item_type, image_url, is_default, display_order, is_active)\n       VALUES (7, 'Extra Cheese', 50, 'veg', NULL, false, 0, true)","sqlState":"42S22","sqlMessage":"Unknown column 'image_url' in 'field list'"}
Error: Unknown column 'image_url' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createAddon (E:\restro-backend\src\services\addon.service.js:121:33)
    at createAddon (E:\restro-backend\src\controllers\menu.controller.js:309:40)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\validate.js:28:5
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:06:00 [ERROR]: Create addon error: Unknown column 'image_url' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO addons (addon_group_id, name, price, item_type, image_url, is_default, display_order, is_active)\n       VALUES (7, 'Jalapenos', 30, 'veg', NULL, false, 0, true)","sqlState":"42S22","sqlMessage":"Unknown column 'image_url' in 'field list'"}
Error: Unknown column 'image_url' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createAddon (E:\restro-backend\src\services\addon.service.js:121:33)
    at createAddon (E:\restro-backend\src\controllers\menu.controller.js:309:40)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\validate.js:28:5
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:06:00 [ERROR]: Get menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getMenu (E:\restro-backend\src\controllers\menu.controller.js:390:20)
2026-02-04 13:06:00 [ERROR]: Get captain menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.getCaptainMenu (E:\restro-backend\src\services\menuEngine.service.js:151:18)
    at async getCaptainMenu (E:\restro-backend\src\controllers\menu.controller.js:407:20)
2026-02-04 13:06:00 [ERROR]: Preview menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id AND cf.floor_id = 1 AND cf.is_available = 1)\n        )\n      \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at Object.previewMenu (E:\restro-backend\src\services\menuEngine.service.js:220:17)
    at previewMenu (E:\restro-backend\src\controllers\menu.controller.js:419:44)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
2026-02-04 13:07:02 [ERROR]: Create kitchen station error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Main Kitchen', 'KITCHEN', 'kitchen', 'Main food preparation area', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:07:02 [ERROR]: Create kitchen station error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Bar Counter', 'BAR', 'bar', 'Bar for alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:07:02 [ERROR]: Create kitchen station error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Dessert Station', 'DESSERT', 'dessert', 'Desserts and sweets', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:07:02 [ERROR]: Create kitchen station error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Mocktail Counter', 'MOCKTAIL', 'mocktail', 'Non-alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:07:02 [ERROR]: Create counter error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO counters (outlet_id, floor_id, name, code, counter_type, description, printer_id, is_active, display_order)\n       VALUES (4, 2, 'Main Bar', 'MAINBAR', 'bar', 'Main bar counter', NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'"}
Error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createCounter (E:\restro-backend\src\services\kitchenStation.service.js:100:33)
    at createCounter (E:\restro-backend\src\controllers\tax.controller.js:424:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:07:02 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 13:29:27 [ERROR]: Unhandled error: cache.delete is not a function
TypeError: cache.delete is not a function
    at Object.update (E:\restro-backend\src\services\outlet.service.js:155:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateOutlet (E:\restro-backend\src\controllers\outlet.controller.js:68:22)
2026-02-04 13:52:24 [ERROR]: Create kitchen station error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Main Kitchen', 'KITCHEN', 'kitchen', 'Main food preparation area', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:24 [ERROR]: Create kitchen station error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Bar Counter', 'BAR', 'bar', 'Bar for alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:24 [ERROR]: Create kitchen station error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Dessert Station', 'DESSERT', 'dessert', 'Desserts and sweets', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:24 [ERROR]: Create kitchen station error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Mocktail Counter', 'MOCKTAIL', 'mocktail', 'Non-alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:25 [ERROR]: Create counter error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO counters (outlet_id, floor_id, name, code, counter_type, description, printer_id, is_active, display_order)\n       VALUES (4, 2, 'Main Bar', 'MAINBAR', 'bar', 'Main bar counter', NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'"}
Error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createCounter (E:\restro-backend\src\services\kitchenStation.service.js:100:33)
    at createCounter (E:\restro-backend\src\controllers\tax.controller.js:424:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:25 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 13:52:56 [ERROR]: Create kitchen station error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Main Kitchen', 'KITCHEN', 'kitchen', 'Main food preparation area', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:56 [ERROR]: Create kitchen station error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Bar Counter', 'BAR', 'bar', 'Bar for alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:56 [ERROR]: Create kitchen station error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Dessert Station', 'DESSERT', 'dessert', 'Desserts and sweets', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:56 [ERROR]: Create kitchen station error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Mocktail Counter', 'MOCKTAIL', 'mocktail', 'Non-alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:56 [ERROR]: Create counter error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO counters (outlet_id, floor_id, name, code, counter_type, description, printer_id, is_active, display_order)\n       VALUES (4, 2, 'Main Bar', 'MAINBAR', 'bar', 'Main bar counter', NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'"}
Error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createCounter (E:\restro-backend\src\services\kitchenStation.service.js:100:33)
    at createCounter (E:\restro-backend\src\controllers\tax.controller.js:424:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:56 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 14:37:42 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 14:37:47 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 14:37:51 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 15:51:20 [ERROR]: Failed to create print job for invoice INV/2526/000008: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 15:51:20 [ERROR]: Process payment error: Column 'outlet_id' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO payments (\n          uuid, outlet_id, order_id, invoice_id, payment_number,\n          payment_mode, amount, tip_amount, total_amount, status,\n          transaction_id, reference_number,\n          card_last_four, card_type, upi_id, wallet_name, bank_name,\n          notes, received_by\n        ) VALUES ('4b2cb7e2-2eb7-464d-be0b-1c4b61137058', NULL, 17, 8, 'PAY2602040001', 'cash', 2541, 0, 2541, 'completed', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1)","sqlState":"23000","sqlMessage":"Column 'outlet_id' cannot be null"}
Error: Column 'outlet_id' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:90:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-04 15:59:28 [ERROR]: Failed to create print job for invoice INV/2526/000009: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 15:59:28 [ERROR]: Process payment error: Column 'outlet_id' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO payments (\n          uuid, outlet_id, order_id, invoice_id, payment_number,\n          payment_mode, amount, tip_amount, total_amount, status,\n          transaction_id, reference_number,\n          card_last_four, card_type, upi_id, wallet_name, bank_name,\n          notes, received_by\n        ) VALUES ('61f34e85-23ee-465f-9890-3448b2db123e', NULL, 18, 9, 'PAY2602040001', 'cash', 2541, 0, 2541, 'completed', NULL, 'CASH-1770200968906', NULL, NULL, NULL, NULL, NULL, NULL, 1)","sqlState":"23000","sqlMessage":"Column 'outlet_id' cannot be null"}
Error: Column 'outlet_id' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:90:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-04 16:00:43 [ERROR]: Failed to create print job for invoice INV/2526/000010: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 16:00:43 [ERROR]: Process payment error: Unknown column 'end_time' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE table_sessions SET \n              status = 'completed', end_time = NOW(), \n              total_amount = 2541, payment_status = 'paid'\n             WHERE id = 15","sqlState":"42S22","sqlMessage":"Unknown column 'end_time' in 'field list'"}
Error: Unknown column 'end_time' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:170:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-04 16:01:08 [ERROR]: Failed to create print job for invoice INV/2526/000011: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 16:01:09 [ERROR]: Process payment error: Unknown column 'total_amount' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE table_sessions SET \n              status = 'completed', ended_at = NOW(), \n              total_amount = 2541, payment_status = 'paid'\n             WHERE id = 16","sqlState":"42S22","sqlMessage":"Unknown column 'total_amount' in 'field list'"}
Error: Unknown column 'total_amount' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:170:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-04 16:01:35 [ERROR]: Failed to create print job for invoice INV/2526/000012: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 17:32:33 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"items.2.addons.0","message":"items[2].addons[0] must be a number"},{"field":"items.2.addons.1","message":"items[2].addons[1] must be a number"},{"field":"items.3.addons.0","message":"items[3].addons[0] must be a number"},{"field":"items.3.addons.1","message":"items[3].addons[1] must be a number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-04 17:32:33 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-04 17:32:34 [ERROR]: Failed to create print job for invoice INV/2526/000013: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 17:33:35 [ERROR]: Failed to create print job for invoice INV/2526/000014: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 18:23:31 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:140:22)
2026-02-04 18:23:58 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '7' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:842:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:263:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-04 18:24:12 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '1' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:842:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:263:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-04 18:37:44 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:649:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 18:39:34 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:649:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 18:40:43 [ERROR]: Unhandled error: Unknown column 'kt.kitchen_station_id' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT kt.*, ks.name as station_name, ks.station_type,\n                u.name as accepted_by_name\n               FROM kot_tickets kt\n               LEFT JOIN kitchen_stations ks ON kt.kitchen_station_id = ks.id\n               LEFT JOIN users u ON kt.accepted_by = u.id\n               WHERE kt.order_id = 24\n               ORDER BY kt.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'kt.kitchen_station_id' in 'on clause'"}
Error: Unknown column 'kt.kitchen_station_id' in 'on clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getFullDetails (E:\restro-backend\src\services\table.service.js:272:39)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTableById (E:\restro-backend\src\controllers\table.controller.js:52:21)
2026-02-04 19:14:13 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-05 09:53:01 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '6' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:1143:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:264:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-05 09:53:11 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '5' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:1143:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:264:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-05 09:53:29 [ERROR]: Unhandled error: Table is currently billing
Error: Table is currently billing
    at Object.startSession (E:\restro-backend\src\services\table.service.js:651:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 10:47:32 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-05 12:34:14 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 12:35:08 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:35:09 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-05 12:36:31 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:36:31 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:36:31 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:36:31 [ERROR]: Create order error: Table is currently cleaning
Error: Table is currently cleaning
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 12:36:31 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:36:58 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:36:58 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-05 12:37:30 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:37:32 [ERROR]: Failed to create print job for invoice INV/2526/000015: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 12:37:32 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"paymentMode","message":"paymentMode is required"},{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-05 12:38:27 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:27 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:27 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:27 [ERROR]: Create order error: Table is currently cleaning
Error: Table is currently cleaning
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 12:38:27 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:53 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:53 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:53 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:55 [ERROR]: Failed to create print job for invoice INV/2526/000016: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 12:38:55 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"paymentMode","message":"paymentMode is required"},{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-05 12:39:28 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:39:28 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:39:28 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:39:30 [ERROR]: Failed to create print job for invoice INV/2526/000017: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 12:39:30 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"paymentMode","message":"paymentMode is required"},{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-05 12:39:36 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:58:13 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:58:13 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:58:13 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:58:15 [ERROR]: Failed to create print job for invoice INV/2526/000018: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 12:58:15 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"paymentMode","message":"paymentMode is required"},{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-05 13:03:16 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"paymentMode","message":"paymentMode is required"},{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-05 13:07:39 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 13:07:39 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 13:07:41 [ERROR]: Failed to create print job for invoice INV/2526/000019: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 14:10:05 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 14:11:24 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 14:14:46 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 14:15:47 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 14:15:56 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 14:16:17 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 14:16:18 [ERROR]: Failed to create print job for invoice INV/2526/000020: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 14:24:40 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 16:29:37 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:36:38 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:36:40 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:44:44 [ERROR]: Create order error: tableService.getActiveSession is not a function
TypeError: tableService.getActiveSession is not a function
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:128:52)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:46:01 [ERROR]: Create order error: Unknown column 'u.role_id' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT r.name as role_name FROM users u JOIN roles r ON u.role_id = r.id WHERE u.id = 1","sqlState":"42S22","sqlMessage":"Unknown column 'u.role_id' in 'on clause'"}
Error: Unknown column 'u.role_id' in 'on clause'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:137:47)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:47:32 [ERROR]: Create order error: Only the captain who started this session can create orders. Contact manager to transfer table.
Error: Only the captain who started this session can create orders. Contact manager to transfer table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:148:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:48:17 [ERROR]: Create order error: Only the captain who started this session can create orders. Contact manager to transfer table.
Error: Only the captain who started this session can create orders. Contact manager to transfer table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:148:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:49:57 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 16:49:58 [ERROR]: Failed to create print job for invoice INV/2526/000021: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 16:56:21 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 16:56:21 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 16:56:55 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 16:56:55 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 16:56:55 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 17:11:32 [ERROR]: Add items error: Variant 5 not found
Error: Variant 5 not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:272:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-05 17:11:44 [ERROR]: Add items error: Variant 9 not found
Error: Variant 9 not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:272:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-05 17:11:50 [ERROR]: Add items error: Variant 1 not found
Error: Variant 1 not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:272:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-05 18:15:54 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 18:15:54 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 18:45:27 [ERROR]: Add items error: Variant 2 not found
Error: Variant 2 not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:272:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-05 18:47:20 [ERROR]: Unhandled error: Unexpected token ']', ..." },
   
  ]
}" is not valid JSON {"expose":true,"statusCode":400,"status":400,"body":"{\n  \"items\": [\n    {\n      \"itemId\": 1,\n      \"quantity\": 2,\n      \"specialInstructions\": \"Extra spicy\"\n    },\n   \n  ]\n}","type":"entity.parse.failed"}
SyntaxError: Unexpected token ']', ..." },
   
  ]
}" is not valid JSON
    at JSON.parse (<anonymous>)
    at parse (E:\restro-backend\node_modules\body-parser\lib\types\json.js:92:19)
    at E:\restro-backend\node_modules\body-parser\lib\read.js:128:18
    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)
    at invokeCallback (E:\restro-backend\node_modules\raw-body\index.js:238:16)
    at done (E:\restro-backend\node_modules\raw-body\index.js:227:7)
    at IncomingMessage.onEnd (E:\restro-backend\node_modules\raw-body\index.js:287:7)
    at IncomingMessage.emit (node:events:518:28)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)
2026-02-06 10:00:11 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-06 10:16:12 [ERROR]: Create order error: Table already has an active order
Error: Table already has an active order
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:135:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 10:16:37 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:718:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:115:21)
2026-02-06 10:21:07 [ERROR]: Add items error: Variant 2 not found
Error: Variant 2 not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:272:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-06 10:55:01 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-06 11:12:32 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 11:12:40 [ERROR]: Create order error: Only the captain who started this session can create orders. Contact manager to transfer table.
Error: Only the captain who started this session can create orders. Contact manager to transfer table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:148:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 11:12:54 [ERROR]: Create order error: Only the captain who started this session can create orders. Contact manager to transfer table.
Error: Only the captain who started this session can create orders. Contact manager to transfer table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:148:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 11:31:42 [ERROR]: Create order error: Only the captain who started this session can create orders. Contact manager to transfer table.
Error: Only the captain who started this session can create orders. Contact manager to transfer table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:148:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 11:32:23 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 11:50:00 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:50:03 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:50:16 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:52:06 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:52:09 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:52:17 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:52:22 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 12:47:30 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:15:04 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 14:15:08 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 14:15:45 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:15:55 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 14:46:18 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 14:46:18 [ERROR]: Create order error: Table already has an active order (Order ID: 51). Use existing order or end session first.
Error: Table already has an active order (Order ID: 51). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:47:02 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 14:47:02 [ERROR]: Create order error: Table already has an active order (Order ID: 51). Use existing order or end session first.
Error: Table already has an active order (Order ID: 51). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:50:51 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:51:10 [ERROR]: Create order error: Table already has an active order (Order ID: 30). Use existing order or end session first.
Error: Table already has an active order (Order ID: 30). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:54:00 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:54:14 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:57:18 [ERROR]: Create order error: Table already has an active order (Order ID: 52). Use existing order or end session first.
Error: Table already has an active order (Order ID: 52). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 15:33:54 [ERROR]: Get captain order history error: Unknown column 'o.sub_total' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT \n        o.id,\n        o.order_number,\n        o.order_type,\n        o.status,\n        o.sub_total,\n        o.tax_amount,\n        o.discount_amount,\n        o.total_amount,\n        o.guest_count,\n        o.customer_name,\n        o.customer_phone,\n        o.created_at,\n        o.updated_at,\n        o.cancelled_at,\n        o.cancel_reason,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        ts.started_at as session_started_at,\n        ts.ended_at as session_ended_at,\n        (SELECT COUNT(*) FROM order_items oi WHERE oi.order_id = o.id AND oi.status != 'cancelled') as item_count,\n        (SELECT COUNT(*) FROM kot_tickets kt WHERE kt.order_id = o.id) as kot_count,\n        u.name as created_by_name\n      FROM orders o\n      LEFT JOIN tables t ON o.table_id = t.id\n      LEFT JOIN floors f ON o.floor_id = f.id\n      LEFT JOIN table_sessions ts ON o.table_session_id = ts.id\n      LEFT JOIN users u ON o.created_by = u.id\n      WHERE o.outlet_id = '4' AND o.created_by = 1\n     ORDER BY o.created_at DESC LIMIT 20 OFFSET 0","sqlState":"42S22","sqlMessage":"Unknown column 'o.sub_total' in 'field list'"}
Error: Unknown column 'o.sub_total' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getCaptainOrderHistory (E:\restro-backend\src\services\order.service.js:911:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCaptainOrderHistory (E:\restro-backend\src\controllers\order.controller.js:665:22)
2026-02-06 15:33:54 [ERROR]: Get captain order detail error: Table 'restro.item_variants' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT oi.*, \n        i.name as item_name, i.short_name,\n        v.name as variant_name,\n        uc.name as cancelled_by_name\n       FROM order_items oi\n       LEFT JOIN items i ON oi.item_id = i.id\n       LEFT JOIN item_variants v ON oi.variant_id = v.id\n       LEFT JOIN users uc ON oi.cancelled_by = uc.id\n       WHERE oi.order_id = '54'\n       ORDER BY oi.created_at","sqlState":"42S02","sqlMessage":"Table 'restro.item_variants' doesn't exist"}
Error: Table 'restro.item_variants' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getCaptainOrderDetail (E:\restro-backend\src\services\order.service.js:970:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCaptainOrderDetail (E:\restro-backend\src\controllers\order.controller.js:680:21)
2026-02-06 15:33:54 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:758:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:115:21)
2026-02-06 15:34:33 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-06 15:34:34 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:758:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:115:21)
2026-02-06 15:59:32 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-06 15:59:33 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:361:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:238:19)
2026-02-06 16:00:11 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-06 17:05:32 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-06 17:22:59 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-06 17:23:27 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 17:23:27 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-06 17:24:09 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 17:24:09 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-06 17:25:05 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 17:25:05 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-07 09:56:59 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 09:57:59 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:32 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:32 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:32 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:32 [ERROR]: Redis max retries reached
2026-02-07 10:27:32 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:32 [ERROR]: Redis max retries reached
2026-02-07 10:37:24 [ERROR]: Get active KOTs error: Table 'restro.user_roles' doesn't exist in engine {"errno":1932,"sql":"SELECT ur.outlet_id \n       FROM user_roles ur\n       WHERE ur.user_id = 8 AND ur.is_active = 1 AND ur.outlet_id IS NOT NULL\n       ORDER BY ur.assigned_at DESC\n       LIMIT 1","sqlState":"42S02","sqlMessage":"Table 'restro.user_roles' doesn't exist in engine"}
Error: Table 'restro.user_roles' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 10:37:24 [ERROR]: Get current user failed: Table 'restro.users' doesn't exist in engine {"errno":1932,"sql":"SELECT u.id, u.uuid, u.employee_code, u.name, u.email, u.phone, \n              u.avatar_url, u.is_active, u.is_verified, u.last_login_at\n       FROM users u\n       WHERE u.id = 8 AND u.deleted_at IS NULL","sqlState":"42S02","sqlMessage":"Table 'restro.users' doesn't exist in engine"}
Error: Table 'restro.users' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:37:24 [ERROR]: Unhandled error: Table 'restro.users' doesn't exist in engine {"errno":1932,"sql":"SELECT u.id, u.uuid, u.employee_code, u.name, u.email, u.phone, \n              u.avatar_url, u.is_active, u.is_verified, u.last_login_at\n       FROM users u\n       WHERE u.id = 8 AND u.deleted_at IS NULL","sqlState":"42S02","sqlMessage":"Table 'restro.users' doesn't exist in engine"}
Error: Table 'restro.users' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:37:24 [ERROR]: Get active KOTs error: Table 'restro.user_roles' doesn't exist in engine {"errno":1932,"sql":"SELECT ur.outlet_id \n       FROM user_roles ur\n       WHERE ur.user_id = 8 AND ur.is_active = 1 AND ur.outlet_id IS NOT NULL\n       ORDER BY ur.assigned_at DESC\n       LIMIT 1","sqlState":"42S02","sqlMessage":"Table 'restro.user_roles' doesn't exist in engine"}
Error: Table 'restro.user_roles' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 10:37:24 [ERROR]: Get current user failed: Table 'restro.users' doesn't exist in engine {"errno":1932,"sql":"SELECT u.id, u.uuid, u.employee_code, u.name, u.email, u.phone, \n              u.avatar_url, u.is_active, u.is_verified, u.last_login_at\n       FROM users u\n       WHERE u.id = 8 AND u.deleted_at IS NULL","sqlState":"42S02","sqlMessage":"Table 'restro.users' doesn't exist in engine"}
Error: Table 'restro.users' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:37:24 [ERROR]: Unhandled error: Table 'restro.users' doesn't exist in engine {"errno":1932,"sql":"SELECT u.id, u.uuid, u.employee_code, u.name, u.email, u.phone, \n              u.avatar_url, u.is_active, u.is_verified, u.last_login_at\n       FROM users u\n       WHERE u.id = 8 AND u.deleted_at IS NULL","sqlState":"42S02","sqlMessage":"Table 'restro.users' doesn't exist in engine"}
Error: Table 'restro.users' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:37:24 [ERROR]: Get active KOTs error: Table 'restro.user_roles' doesn't exist in engine {"errno":1932,"sql":"SELECT ur.outlet_id \n       FROM user_roles ur\n       WHERE ur.user_id = 8 AND ur.is_active = 1 AND ur.outlet_id IS NOT NULL\n       ORDER BY ur.assigned_at DESC\n       LIMIT 1","sqlState":"42S02","sqlMessage":"Table 'restro.user_roles' doesn't exist in engine"}
Error: Table 'restro.user_roles' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 10:37:24 [ERROR]: Get active KOTs error: Table 'restro.user_roles' doesn't exist in engine {"errno":1932,"sql":"SELECT ur.outlet_id \n       FROM user_roles ur\n       WHERE ur.user_id = 8 AND ur.is_active = 1 AND ur.outlet_id IS NOT NULL\n       ORDER BY ur.assigned_at DESC\n       LIMIT 1","sqlState":"42S02","sqlMessage":"Table 'restro.user_roles' doesn't exist in engine"}
Error: Table 'restro.user_roles' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 10:39:18 [ERROR]: Get current user failed: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:39:18 [ERROR]: Unhandled error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:39:19 [ERROR]: Get current user failed: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:39:19 [ERROR]: Unhandled error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:39:38 [ERROR]: Get active KOTs error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 10:39:38 [ERROR]: Get active KOTs error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 11:09:53 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:758:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:23:57 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:758:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:40:12 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-07 11:40:12 [ERROR]: Create order error: Table already has an active order (Order ID: 64). Use existing order or end session first.
Error: Table already has an active order (Order ID: 64). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:40:49 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-07 11:40:49 [ERROR]: Create order error: Table already has an active order (Order ID: 64). Use existing order or end session first.
Error: Table already has an active order (Order ID: 64). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:41:09 [ERROR]: Create order error: Table already has an active order (Order ID: 64). Use existing order or end session first.
Error: Table already has an active order (Order ID: 64). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:42:06 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"email","message":"Please provide a valid email address"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-07 11:44:11 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"email","message":"Please provide a valid email address"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-07 11:45:12 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:45:12 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:45:44 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:45:44 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:46:49 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:46:49 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:47:08 [ERROR]: Create order error: Table already has an active order (Order ID: 53). Use existing order or end session first.
Error: Table already has an active order (Order ID: 53). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:47:08 [ERROR]: Create order error: Table already has an active order (Order ID: 53). Use existing order or end session first.
Error: Table already has an active order (Order ID: 53). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:47:48 [ERROR]: Create order error: Table already has an active order (Order ID: 67). Use existing order or end session first.
Error: Table already has an active order (Order ID: 67). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:47:48 [ERROR]: Create order error: Table already has an active order (Order ID: 67). Use existing order or end session first.
Error: Table already has an active order (Order ID: 67). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:48:31 [ERROR]: Create order error: Table already has an active order (Order ID: 67). Use existing order or end session first.
Error: Table already has an active order (Order ID: 67). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:48:56 [ERROR]: Cancel order error: Unknown column 'kt.table_id' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT kt.*, t.table_number \n         FROM kot_tickets kt\n         LEFT JOIN tables t ON kt.table_id = t.id\n         WHERE kt.order_id = '67' AND kt.status NOT IN ('served', 'cancelled')","sqlState":"42S22","sqlMessage":"Unknown column 'kt.table_id' in 'on clause'"}
Error: Unknown column 'kt.table_id' in 'on clause'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:799:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:48:56 [ERROR]: Create order error: Table already has an active order (Order ID: 67). Use existing order or end session first.
Error: Table already has an active order (Order ID: 67). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:49:55 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:49:57 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:52:11 [ERROR]: Cancel item error: Unknown column 'cancelled_at' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE kot_items SET status = 'cancelled', cancelled_at = NOW() WHERE order_item_id = '206'","sqlState":"42S22","sqlMessage":"Unknown column 'cancelled_at' in 'field list'"}
Error: Unknown column 'cancelled_at' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:695:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-07 11:52:11 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 11:53:55 [ERROR]: Cancel item error: Unknown column 'cancelled_at' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE kot_items SET status = 'cancelled', cancelled_at = NOW() WHERE order_item_id = '208'","sqlState":"42S22","sqlMessage":"Unknown column 'cancelled_at' in 'field list'"}
Error: Unknown column 'cancelled_at' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:695:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-07 11:53:55 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 11:53:55 [ERROR]: Cancel order error: Unknown column 'kt.table_id' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT kt.*, t.table_number \n         FROM kot_tickets kt\n         LEFT JOIN tables t ON kt.table_id = t.id\n         WHERE kt.order_id = '73' AND kt.status NOT IN ('served', 'cancelled')","sqlState":"42S22","sqlMessage":"Unknown column 'kt.table_id' in 'on clause'"}
Error: Unknown column 'kt.table_id' in 'on clause'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:799:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:54:35 [ERROR]: Cancel item error: Unknown column 'cancelled_at' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE kot_items SET status = 'cancelled', cancelled_at = NOW() WHERE order_item_id = '211'","sqlState":"42S22","sqlMessage":"Unknown column 'cancelled_at' in 'field list'"}
Error: Unknown column 'cancelled_at' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:695:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-07 11:54:35 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 11:54:35 [ERROR]: Cancel order error: Unknown column 'kt.table_id' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT kt.*, t.table_number \n         FROM kot_tickets kt\n         LEFT JOIN tables t ON kt.table_id = t.id\n         WHERE kt.order_id = '75' AND kt.status NOT IN ('served', 'cancelled')","sqlState":"42S22","sqlMessage":"Unknown column 'kt.table_id' in 'on clause'"}
Error: Unknown column 'kt.table_id' in 'on clause'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:799:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 12:08:59 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 12:09:49 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 12:12:55 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 12:37:46 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 12:37:46 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:238:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-07 12:37:46 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:77:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:174:22)
2026-02-07 12:37:46 [ERROR]: Cancel item error: Order item not found
Error: Order item not found
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:641:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-07 12:37:46 [ERROR]: Reprint KOT error: KOT not found
Error: KOT not found
    at Object.reprintKot (E:\restro-backend\src\services\kot.service.js:759:21)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async reprintKot (E:\restro-backend\src\controllers\order.controller.js:333:19)
2026-02-07 12:37:46 [ERROR]: Accept KOT error: Cannot read properties of null (reading 'outlet_id')
TypeError: Cannot read properties of null (reading 'outlet_id')
    at Object.acceptKot (E:\restro-backend\src\services\kot.service.js:290:34)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async acceptKot (E:\restro-backend\src\controllers\order.controller.js:249:19)
2026-02-07 12:37:46 [ERROR]: Cancel order error: Order not found
Error: Order not found
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:778:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 12:37:46 [ERROR]: Cancel order error: Order not found
Error: Order not found
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:778:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 12:37:46 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-07 12:37:46 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 12:37:46 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:238:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-07 12:37:46 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:77:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:174:22)
2026-02-07 12:37:46 [ERROR]: Cancel order error: Order not found
Error: Order not found
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:778:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 12:59:21 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 12:59:21 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:784:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:01:44 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 13:01:44 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:04:18 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 13:04:18 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:04:57 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:05:21 [ERROR]: Cancel order error: Table not found
Error: Table not found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:732:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.cancelOrder (E:\restro-backend\src\services\order.service.js:850:11)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:08:30 [ERROR]: Create order error: Table already has an active order (Order ID: 80). Use existing order or end session first.
Error: Table already has an active order (Order ID: 80). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:08:34 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:09:01 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:09:44 [ERROR]: Cancel order error: Table not found
Error: Table not found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:732:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.cancelOrder (E:\restro-backend\src\services\order.service.js:850:11)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:13:59 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:14:47 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:15:04 [ERROR]: Create order error: Table already has an active order (Order ID: 80). Use existing order or end session first.
Error: Table already has an active order (Order ID: 80). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:15:29 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:25:02 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:25:19 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:25:19 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:238:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-07 13:25:19 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:77:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:174:22)
2026-02-07 13:25:20 [ERROR]: Cancel order error: Order not found
Error: Order not found
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:778:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:25:20 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-07 13:25:20 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:25:20 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:238:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-07 13:25:20 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:77:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:174:22)
2026-02-07 13:25:20 [ERROR]: Cancel order error: Order not found
Error: Order not found
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:778:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:26:04 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 13:26:04 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:784:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:26:13 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:784:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:26:29 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 13:27:26 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:27:52 [ERROR]: Create order error: Table already has an active order (Order ID: 80). Use existing order or end session first.
Error: Table already has an active order (Order ID: 80). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:28:46 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:29:29 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:31:58 [ERROR]: Create order error: Table already has an active order (Order ID: 94). Use existing order or end session first.
Error: Table already has an active order (Order ID: 94). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:32:26 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-07 13:40:04 [ERROR]: Create order error: Table already has an active order (Order ID: 97). Use existing order or end session first.
Error: Table already has an active order (Order ID: 97). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 15:45:01 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:744:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-07 16:14:05 [ERROR]: Create order error: Table already has an active order (Order ID: 97). Use existing order or end session first.
Error: Table already has an active order (Order ID: 97). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 16:14:13 [ERROR]: Create order error: Table already has an active order (Order ID: 97). Use existing order or end session first.
Error: Table already has an active order (Order ID: 97). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 17:47:15 [ERROR]: Create order error: Table already has an active order (Order ID: 97). Use existing order or end session first.
Error: Table already has an active order (Order ID: 97). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 18:11:36 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:744:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-07 18:27:54 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:744:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-07 18:27:56 [ERROR]: Create order error: Table already has an active order (Order ID: 107). Use existing order or end session first.
Error: Table already has an active order (Order ID: 107). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 18:27:56 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:822:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)

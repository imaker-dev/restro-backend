2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:15:53 [ERROR]: Redis max retries reached
2026-02-03 12:15:53 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:30 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:30 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis max retries reached
2026-02-03 12:18:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Redis max retries reached
2026-02-03 12:18:31 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:31 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:32 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:33 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:34 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:35 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:36 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:37 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:38 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:41 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:44 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:44 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:44 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:44 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Redis max retries reached
2026-02-03 12:18:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Redis max retries reached
2026-02-03 12:18:45 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:45 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:46 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:47 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:48 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:49 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:50 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:51 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:52 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:18:55 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:03 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis max retries reached
2026-02-03 12:19:11 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:11 [ERROR]: Redis max retries reached
2026-02-03 12:19:19 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:19 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:19 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:19 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:20 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:20 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:20 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:20 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:20 [ERROR]: Redis max retries reached
2026-02-03 12:19:20 [ERROR]: Redis max retries reached
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:28 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:29 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:29 [ERROR]: Redis max retries reached
2026-02-03 12:19:29 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:19:29 [ERROR]: Redis max retries reached
2026-02-03 12:20:21 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:21 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:20:22 [ERROR]: Redis max retries reached
2026-02-03 12:20:22 [ERROR]: Redis max retries reached
2026-02-03 12:23:40 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:40 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:40 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:40 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:41 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:41 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:41 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:41 [ERROR]: Redis max retries reached
2026-02-03 12:23:41 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:23:41 [ERROR]: Redis max retries reached
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:45 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:46 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:46 [ERROR]: Redis max retries reached
2026-02-03 12:38:46 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-03 12:38:46 [ERROR]: Redis max retries reached
2026-02-03 13:11:31 [ERROR]: Unhandled error: cache.delete is not a function
TypeError: cache.delete is not a function
    at Object.invalidateCache (E:\restro-backend\src\services\table.service.js:879:23)
    at Object.startSession (E:\restro-backend\src\services\table.service.js:387:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:140:22)
2026-02-03 13:11:59 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:140:22)
2026-02-03 13:34:20 [ERROR]: Get tax groups error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"\n      SELECT tg.*,\n        (SELECT JSON_ARRAYAGG(JSON_OBJECT(\n          'id', tc.id,\n          'name', tc.name,\n          'code', tc.code,\n          'rate', tc.rate\n        ))\n        FROM tax_group_components tgc\n        JOIN tax_components tc ON tgc.tax_component_id = tc.id\n        WHERE tgc.tax_group_id = tg.id AND tgc.is_active = 1\n        ) as components\n      FROM tax_groups tg\n      WHERE tg.is_active = 1\n     ORDER BY tg.is_default DESC, tg.name","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTaxGroups (E:\restro-backend\src\services\tax.service.js:238:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTaxGroups (E:\restro-backend\src\controllers\tax.controller.js:105:22)
2026-02-03 15:07:16 [ERROR]: Create order error: Column 'created_by' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('83cac48f-ed7e-42e0-8852-687359a4828e', 4, 'ORD2602030009', 'dine_in', 7, 3, NULL, NULL, NULL, 'Test Customer', '9876543210', 1, 'pending', 'pending', 'Test order for lifecycle verification', NULL)","sqlState":"23000","sqlMessage":"Column 'created_by' cannot be null"}
Error: Column 'created_by' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:98:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-03 15:07:16 [ERROR]: Add items error: Unknown column 'u.full_name' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT o.*, t.table_number, t.name as table_name,\n        f.name as floor_name, s.name as section_name,\n        u.full_name as created_by_name\n       FROM orders o\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON o.floor_id = f.id\n       LEFT JOIN sections s ON o.section_id = s.id\n       LEFT JOIN users u ON o.created_by = u.id\n       WHERE o.id = 'null'","sqlState":"42S22","sqlMessage":"Unknown column 'u.full_name' in 'field list'"}
Error: Unknown column 'u.full_name' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getById (E:\restro-backend\src\services\order.service.js:316:31)
    at Object.addItems (E:\restro-backend\src\services\order.service.js:144:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:07:17 [ERROR]: Generate bill error: Unknown column 'u.full_name' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT o.*, t.table_number, t.name as table_name,\n        f.name as floor_name, s.name as section_name,\n        u.full_name as created_by_name\n       FROM orders o\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON o.floor_id = f.id\n       LEFT JOIN sections s ON o.section_id = s.id\n       LEFT JOIN users u ON o.created_by = u.id\n       WHERE o.id = 'null'","sqlState":"42S22","sqlMessage":"Unknown column 'u.full_name' in 'field list'"}
Error: Unknown column 'u.full_name' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getById (E:\restro-backend\src\services\order.service.js:316:31)
    at Object.getOrderWithItems (E:\restro-backend\src\services\order.service.js:338:30)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:51:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:07:17 [ERROR]: Get order error: Unknown column 'u.full_name' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT o.*, t.table_number, t.name as table_name,\n        f.name as floor_name, s.name as section_name,\n        u.full_name as created_by_name\n       FROM orders o\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON o.floor_id = f.id\n       LEFT JOIN sections s ON o.section_id = s.id\n       LEFT JOIN users u ON o.created_by = u.id\n       WHERE o.id = 'null'","sqlState":"42S22","sqlMessage":"Unknown column 'u.full_name' in 'field list'"}
Error: Unknown column 'u.full_name' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getById (E:\restro-backend\src\services\order.service.js:316:31)
    at Object.getOrderWithItems (E:\restro-backend\src\services\order.service.js:338:30)
    at getOrder (E:\restro-backend\src\controllers\order.controller.js:33:40)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
2026-02-03 15:09:25 [ERROR]: Create order error: Column 'created_by' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('8a632d3a-e7eb-4d45-b5d4-d9aba04715fd', 4, 'ORD2602030009', 'dine_in', 8, 4, NULL, NULL, NULL, 'Test Customer', '9876543210', 2, 'pending', 'pending', 'Test order for lifecycle verification', NULL)","sqlState":"23000","sqlMessage":"Column 'created_by' cannot be null"}
Error: Column 'created_by' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:98:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-03 15:09:25 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:145:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:09:25 [ERROR]: Generate bill error: Order not found
Error: Order not found
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:52:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:10:05 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:118:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-03 15:10:05 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.addItems (E:\restro-backend\src\services\order.service.js:263:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:10:05 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.addItems (E:\restro-backend\src\services\order.service.js:263:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:10:05 [ERROR]: Generate bill error: Cannot read properties of undefined (reading 'includes')
TypeError: Cannot read properties of undefined (reading 'includes')
    at Object.calculateBillDetails (E:\restro-backend\src\services\billing.service.js:224:25)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:77:38)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:10:49 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:118:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-03 15:10:49 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.addItems (E:\restro-backend\src\services\order.service.js:263:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:170:20)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:170:20)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-03 15:10:49 [ERROR]: Send KOT error: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:196:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-03 15:10:49 [ERROR]: Failed to emit order update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitOrderUpdate (E:\restro-backend\src\services\order.service.js:741:13)
    at Object.addItems (E:\restro-backend\src\services\order.service.js:263:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:170:20)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-03 15:10:49 [ERROR]: Send KOT error: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:196:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.acceptKot (E:\restro-backend\src\services\kot.service.js:274:16)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async acceptKot (E:\restro-backend\src\controllers\order.controller.js:218:19)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.markKotServed (E:\restro-backend\src\services\kot.service.js:487:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markKotServed (E:\restro-backend\src\controllers\order.controller.js:258:19)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.markKotServed (E:\restro-backend\src\services\kot.service.js:487:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markKotServed (E:\restro-backend\src\controllers\order.controller.js:258:19)
2026-02-03 15:10:49 [ERROR]: Failed to emit KOT update: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:679:13)
    at Object.markKotServed (E:\restro-backend\src\services\kot.service.js:487:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markKotServed (E:\restro-backend\src\controllers\order.controller.js:258:19)
2026-02-03 15:10:49 [ERROR]: Mark KOT served error: publishMessage is not a function
TypeError: publishMessage is not a function
    at Object.checkOrderServedStatus (E:\restro-backend\src\services\kot.service.js:548:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.markKotServed (E:\restro-backend\src\services\kot.service.js:490:7)
    at async markKotServed (E:\restro-backend\src\controllers\order.controller.js:258:19)
2026-02-03 15:10:49 [ERROR]: Generate bill error: Cannot read properties of undefined (reading 'includes')
TypeError: Cannot read properties of undefined (reading 'includes')
    at Object.calculateBillDetails (E:\restro-backend\src\services\billing.service.js:224:25)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:77:38)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:11:38 [ERROR]: Generate bill error: Cannot read properties of undefined (reading 'includes')
TypeError: Cannot read properties of undefined (reading 'includes')
    at Object.calculateBillDetails (E:\restro-backend\src\services\billing.service.js:224:25)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:77:38)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:25:35 [ERROR]: Failed to create print job for invoice INV/2526/000003: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:27:24 [ERROR]: Failed to create print job for invoice INV/2526/000004: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:28:39 [ERROR]: Failed to create print job for invoice INV/2526/000005: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:29:07 [ERROR]: Failed to create print job for invoice INV/2526/000006: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:29:07 [ERROR]: Process payment error: Column 'outlet_id' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO payments (\n          uuid, outlet_id, order_id, invoice_id, payment_number,\n          payment_mode, amount, tip_amount, total_amount, status,\n          transaction_id, reference_number,\n          card_last_four, card_type, upi_id, wallet_name, bank_name,\n          notes, received_by\n        ) VALUES ('1fae1d48-c051-4cc2-af35-54b897b728bd', NULL, 15, 6, 'PAY2602030001', 'cash', 2541, 0, 2541, 'completed', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1)","sqlState":"23000","sqlMessage":"Column 'outlet_id' cannot be null"}
Error: Column 'outlet_id' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:90:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-03 15:29:38 [ERROR]: Failed to create print job for invoice INV/2526/000007: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-03 15:29:38 [ERROR]: Process payment error: Column 'outlet_id' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO payments (\n          uuid, outlet_id, order_id, invoice_id, payment_number,\n          payment_mode, amount, tip_amount, total_amount, status,\n          transaction_id, reference_number,\n          card_last_four, card_type, upi_id, wallet_name, bank_name,\n          notes, received_by\n        ) VALUES ('a70eabce-0dd5-4e4e-8c9d-6091be489a69', NULL, 16, 7, 'PAY2602030001', 'cash', 2541, 0, 2541, 'completed', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1)","sqlState":"23000","sqlMessage":"Column 'outlet_id' cannot be null"}
Error: Column 'outlet_id' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:90:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-03 18:01:29 [ERROR]: Create user failed: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
Error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
    at UserService.createUser (E:\restro-backend\src\services\user.service.js:211:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createUser (E:\restro-backend\src\controllers\user.controller.js:52:18)
2026-02-03 18:01:29 [ERROR]: Unhandled error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
Error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
    at UserService.createUser (E:\restro-backend\src\services\user.service.js:211:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createUser (E:\restro-backend\src\controllers\user.controller.js:52:18)
2026-02-03 18:01:29 [ERROR]: Update user failed: Managers cannot update admin or manager users
Error: Managers cannot update admin or manager users
    at UserService.updateUser (E:\restro-backend\src\services\user.service.js:308:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateUser (E:\restro-backend\src\controllers\user.controller.js:77:18)
2026-02-03 18:01:29 [ERROR]: Unhandled error: Managers cannot update admin or manager users
Error: Managers cannot update admin or manager users
    at UserService.updateUser (E:\restro-backend\src\services\user.service.js:308:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateUser (E:\restro-backend\src\controllers\user.controller.js:77:18)
2026-02-03 18:26:50 [ERROR]: Get my permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getMyPermissions (E:\restro-backend\src\controllers\permission.controller.js:34:25)
2026-02-03 18:26:50 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getMyPermissions (E:\restro-backend\src\controllers\permission.controller.js:34:25)
2026-02-03 18:26:50 [ERROR]: Check permission failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async checkPermission (E:\restro-backend\src\controllers\permission.controller.js:288:25)
2026-02-03 18:26:50 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async checkPermission (E:\restro-backend\src\controllers\permission.controller.js:288:25)
2026-02-03 18:26:50 [ERROR]: Get grantable permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.getGrantablePermissions (E:\restro-backend\src\services\permission.service.js:566:26)
    at async getGrantablePermissions (E:\restro-backend\src\controllers\permission.controller.js:53:25)
2026-02-03 18:26:50 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.getGrantablePermissions (E:\restro-backend\src\services\permission.service.js:566:26)
    at async getGrantablePermissions (E:\restro-backend\src\controllers\permission.controller.js:53:25)
2026-02-03 18:26:51 [ERROR]: Get user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:51 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:51 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:51 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:51 [ERROR]: Get user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:51 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:51 [ERROR]: Get my permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getMyPermissions (E:\restro-backend\src\controllers\permission.controller.js:34:25)
2026-02-03 18:26:51 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getMyPermissions (E:\restro-backend\src\controllers\permission.controller.js:34:25)
2026-02-03 18:26:52 [ERROR]: Get user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:52 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Revoke permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.revokePermissions (E:\restro-backend\src\services\permission.service.js:289:26)
    at async revokePermissions (E:\restro-backend\src\controllers\permission.controller.js:192:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.revokePermissions (E:\restro-backend\src\services\permission.service.js:289:26)
    at async revokePermissions (E:\restro-backend\src\controllers\permission.controller.js:192:20)
2026-02-03 18:26:52 [ERROR]: Get user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:52 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Get grantable permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.getGrantablePermissions (E:\restro-backend\src\services\permission.service.js:566:26)
    at async getGrantablePermissions (E:\restro-backend\src\controllers\permission.controller.js:53:25)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.getGrantablePermissions (E:\restro-backend\src\services\permission.service.js:566:26)
    at async getGrantablePermissions (E:\restro-backend\src\controllers\permission.controller.js:53:25)
2026-02-03 18:26:52 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Grant permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.grantPermissions (E:\restro-backend\src\services\permission.service.js:195:26)
    at async grantPermissions (E:\restro-backend\src\controllers\permission.controller.js:147:20)
2026-02-03 18:26:52 [ERROR]: Set user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.setUserPermissions (E:\restro-backend\src\services\permission.service.js:369:25)
    at async setUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:102:20)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:90:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async PermissionService.setUserPermissions (E:\restro-backend\src\services\permission.service.js:369:25)
    at async setUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:102:20)
2026-02-03 18:26:52 [ERROR]: Get user permissions failed: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:26:52 [ERROR]: Unhandled error: cache.setex is not a function
TypeError: cache.setex is not a function
    at PermissionService.getUserPermissions (E:\restro-backend\src\services\permission.service.js:157:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getUserPermissions (E:\restro-backend\src\controllers\permission.controller.js:74:25)
2026-02-03 18:48:00 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN is required for all staff"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 10:21:41 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-04 10:22:35 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-04 10:34:48 [ERROR]: Create user failed: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
Error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
    at UserService.createUser (E:\restro-backend\src\services\user.service.js:224:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createUser (E:\restro-backend\src\controllers\user.controller.js:52:18)
2026-02-04 10:34:48 [ERROR]: Unhandled error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
Error: Managers can only create staff users (captain, waiter, bartender, kitchen, cashier)
    at UserService.createUser (E:\restro-backend\src\services\user.service.js:224:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createUser (E:\restro-backend\src\controllers\user.controller.js:52:18)
2026-02-04 11:43:14 [ERROR]: Unhandled error: Unexpected token ',', ..."utletId": ,
  "devic"... is not valid JSON {"expose":true,"statusCode":400,"status":400,"body":"{\n  \"employeeCode\": \"CAP001\",\n  \"pin\": \"1234\",\n  \"outletId\": ,\n  \"deviceType\": \"captain_app\"\n}","type":"entity.parse.failed"}
SyntaxError: Unexpected token ',', ..."utletId": ,
  "devic"... is not valid JSON
    at JSON.parse (<anonymous>)
    at parse (E:\restro-backend\node_modules\body-parser\lib\types\json.js:92:19)
    at E:\restro-backend\node_modules\body-parser\lib\read.js:128:18
    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)
    at invokeCallback (E:\restro-backend\node_modules\raw-body\index.js:238:16)
    at done (E:\restro-backend\node_modules\raw-body\index.js:227:7)
    at IncomingMessage.onEnd (E:\restro-backend\node_modules\raw-body\index.js:287:7)
    at IncomingMessage.emit (node:events:518:28)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)
2026-02-04 11:43:25 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 11:43:33 [ERROR]: Unhandled error: Expected double-quoted property name in JSON at position 49 (line 6 column 1) {"expose":true,"statusCode":400,"status":400,"body":"{\n  \"employeeCode\": \"CAP001\",\n  \"pin\": \"1234\",\n\n\n}","type":"entity.parse.failed"}
SyntaxError: Expected double-quoted property name in JSON at position 49 (line 6 column 1)
    at JSON.parse (<anonymous>)
    at parse (E:\restro-backend\node_modules\body-parser\lib\types\json.js:92:19)
    at E:\restro-backend\node_modules\body-parser\lib\read.js:128:18
    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)
    at invokeCallback (E:\restro-backend\node_modules\raw-body\index.js:238:16)
    at done (E:\restro-backend\node_modules\raw-body\index.js:227:7)
    at IncomingMessage.onEnd (E:\restro-backend\node_modules\raw-body\index.js:287:7)
    at IncomingMessage.emit (node:events:518:28)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)
2026-02-04 11:43:41 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 11:47:02 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"},{"field":"pin","message":"PIN is required for all staff"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 11:49:12 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"},{"field":"pin","message":"PIN is required for all staff"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:07:26 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"},{"field":"tableNumber","message":"tableNumber is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:07:27 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"discountType","message":"discountType is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:16:14 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:16:26 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:17:02 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 12:41:58 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-04 12:42:06 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-04 12:42:15 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"email","message":"Email is required"},{"field":"password","message":"Password is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 12:42:33 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-04 12:50:46 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"employeeCode","message":"Employee code is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 12:53:43 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"email","message":"Email is required"},{"field":"password","message":"Password is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 13:05:44 [ERROR]: Create kitchen station error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Main Kitchen', 'KITCHEN', 'kitchen', 'Main food preparation area', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:05:44 [ERROR]: Create kitchen station error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Dessert Station', 'DESSERT', 'dessert', 'Desserts and sweets', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:05:44 [ERROR]: Create counter error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO counters (outlet_id, floor_id, name, code, counter_type, description, printer_id, is_active, display_order)\n       VALUES (4, 2, 'Main Bar', 'MAINBAR', 'bar', 'Main bar counter', NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'"}
Error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createCounter (E:\restro-backend\src\services\kitchenStation.service.js:100:33)
    at createCounter (E:\restro-backend\src\controllers\tax.controller.js:424:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:05:44 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Food Items', 'food-items', 'Main food items', 'https://example.com/food.jpg', NULL, NULL, 0, true, true)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:05:44 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Liquor', 'liquor', 'Alcoholic beverages', 'https://example.com/liquor.jpg', NULL, NULL, 0, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:05:44 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Desserts', 'desserts', 'Sweet treats', 'https://example.com/dessert.jpg', NULL, NULL, 0, true, true)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:05:44 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Mocktails', 'mocktails', 'Non-alcoholic beverages', 'https://example.com/mocktail.jpg', NULL, NULL, 0, true, true)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"categoryId","message":"categoryId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-04 13:05:44 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 13:05:44 [ERROR]: Preview menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id AND cf.floor_id = 1 AND cf.is_available = 1)\n        )\n      \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async previewMenu (E:\restro-backend\src\controllers\menu.controller.js:419:20)
2026-02-04 13:05:44 [ERROR]: Preview menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id AND cf.floor_id = 2 AND cf.is_available = 1)\n        )\n      \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async previewMenu (E:\restro-backend\src\controllers\menu.controller.js:419:20)
2026-02-04 13:05:44 [ERROR]: Get captain menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.getCaptainMenu (E:\restro-backend\src\services\menuEngine.service.js:151:18)
    at async getCaptainMenu (E:\restro-backend\src\controllers\menu.controller.js:407:20)
2026-02-04 13:06:00 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Test Main Course', 'test-main-course', 'Main course food items', NULL, NULL, NULL, 1, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:06:00 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Test Beverages', 'test-beverages', 'Non-alcoholic beverages', NULL, NULL, NULL, 2, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:06:00 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Test Desserts', 'test-desserts', 'Sweet treats', NULL, NULL, NULL, 3, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:06:00 [ERROR]: Create category error: Unknown column 'is_global' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO categories (outlet_id, parent_id, name, slug, description, image_url, icon, color_code, display_order, is_active, is_global)\n         VALUES (4, NULL, 'Test Liquor', 'test-liquor', 'Alcoholic beverages - Bar only', NULL, NULL, NULL, 4, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'is_global' in 'field list'"}
Error: Unknown column 'is_global' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.create (E:\restro-backend\src\services\category.service.js:33:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createCategory (E:\restro-backend\src\controllers\menu.controller.js:19:24)
2026-02-04 13:06:00 [ERROR]: Create addon error: Unknown column 'image_url' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO addons (addon_group_id, name, price, item_type, image_url, is_default, display_order, is_active)\n       VALUES (7, 'Extra Cheese', 50, 'veg', NULL, false, 0, true)","sqlState":"42S22","sqlMessage":"Unknown column 'image_url' in 'field list'"}
Error: Unknown column 'image_url' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createAddon (E:\restro-backend\src\services\addon.service.js:121:33)
    at createAddon (E:\restro-backend\src\controllers\menu.controller.js:309:40)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\validate.js:28:5
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:06:00 [ERROR]: Create addon error: Unknown column 'image_url' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO addons (addon_group_id, name, price, item_type, image_url, is_default, display_order, is_active)\n       VALUES (7, 'Jalapenos', 30, 'veg', NULL, false, 0, true)","sqlState":"42S22","sqlMessage":"Unknown column 'image_url' in 'field list'"}
Error: Unknown column 'image_url' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createAddon (E:\restro-backend\src\services\addon.service.js:121:33)
    at createAddon (E:\restro-backend\src\controllers\menu.controller.js:309:40)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\validate.js:28:5
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:06:00 [ERROR]: Get menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getMenu (E:\restro-backend\src\controllers\menu.controller.js:390:20)
2026-02-04 13:06:00 [ERROR]: Get captain menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.getCaptainMenu (E:\restro-backend\src\services\menuEngine.service.js:151:18)
    at async getCaptainMenu (E:\restro-backend\src\controllers\menu.controller.js:407:20)
2026-02-04 13:06:00 [ERROR]: Preview menu error: Unknown column 'c.is_global' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT c.*,\n        pc.name as parent_name,\n        (SELECT COUNT(*) FROM items i WHERE i.category_id = c.id AND i.is_active = 1 AND i.deleted_at IS NULL) as item_count\n      FROM categories c\n      LEFT JOIN categories pc ON c.parent_id = pc.id\n      WHERE c.outlet_id = '4' AND c.is_active = 1 AND c.deleted_at IS NULL\n    \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_floors cf WHERE cf.category_id = c.id AND cf.floor_id = 1 AND cf.is_available = 1)\n        )\n      \n        AND (\n          c.is_global = 1\n          OR NOT EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id)\n          OR EXISTS (SELECT 1 FROM category_time_slots cts WHERE cts.category_id = c.id AND cts.time_slot_id = 23 AND cts.is_available = 1)\n        )\n       ORDER BY c.display_order, c.name","sqlState":"42S22","sqlMessage":"Unknown column 'c.is_global' in 'where clause'"}
Error: Unknown column 'c.is_global' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getVisibleCategories (E:\restro-backend\src\services\category.service.js:354:37)
    at Object.buildMenu (E:\restro-backend\src\services\menuEngine.service.js:38:46)
    at Object.previewMenu (E:\restro-backend\src\services\menuEngine.service.js:220:17)
    at previewMenu (E:\restro-backend\src\controllers\menu.controller.js:419:44)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
2026-02-04 13:07:02 [ERROR]: Create kitchen station error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Main Kitchen', 'KITCHEN', 'kitchen', 'Main food preparation area', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:07:02 [ERROR]: Create kitchen station error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Bar Counter', 'BAR', 'bar', 'Bar for alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:07:02 [ERROR]: Create kitchen station error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Dessert Station', 'DESSERT', 'dessert', 'Desserts and sweets', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:07:02 [ERROR]: Create kitchen station error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Mocktail Counter', 'MOCKTAIL', 'mocktail', 'Non-alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:07:02 [ERROR]: Create counter error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO counters (outlet_id, floor_id, name, code, counter_type, description, printer_id, is_active, display_order)\n       VALUES (4, 2, 'Main Bar', 'MAINBAR', 'bar', 'Main bar counter', NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'"}
Error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createCounter (E:\restro-backend\src\services\kitchenStation.service.js:100:33)
    at createCounter (E:\restro-backend\src\controllers\tax.controller.js:424:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:07:02 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 13:29:27 [ERROR]: Unhandled error: cache.delete is not a function
TypeError: cache.delete is not a function
    at Object.update (E:\restro-backend\src\services\outlet.service.js:155:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateOutlet (E:\restro-backend\src\controllers\outlet.controller.js:68:22)
2026-02-04 13:52:24 [ERROR]: Create kitchen station error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Main Kitchen', 'KITCHEN', 'kitchen', 'Main food preparation area', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:24 [ERROR]: Create kitchen station error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Bar Counter', 'BAR', 'bar', 'Bar for alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:24 [ERROR]: Create kitchen station error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Dessert Station', 'DESSERT', 'dessert', 'Desserts and sweets', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:24 [ERROR]: Create kitchen station error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Mocktail Counter', 'MOCKTAIL', 'mocktail', 'Non-alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:25 [ERROR]: Create counter error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO counters (outlet_id, floor_id, name, code, counter_type, description, printer_id, is_active, display_order)\n       VALUES (4, 2, 'Main Bar', 'MAINBAR', 'bar', 'Main bar counter', NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'"}
Error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createCounter (E:\restro-backend\src\services\kitchenStation.service.js:100:33)
    at createCounter (E:\restro-backend\src\controllers\tax.controller.js:424:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:25 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 13:52:56 [ERROR]: Create kitchen station error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Main Kitchen', 'KITCHEN', 'kitchen', 'Main food preparation area', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Main Kitchen' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:56 [ERROR]: Create kitchen station error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Bar Counter', 'BAR', 'bar', 'Bar for alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Bar Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:56 [ERROR]: Create kitchen station error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Dessert Station', 'DESSERT', 'dessert', 'Desserts and sweets', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Dessert Station' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:56 [ERROR]: Create kitchen station error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO kitchen_stations (outlet_id, name, code, station_type, description, printer_id, display_id, is_active, display_order)\n       VALUES (4, 'Mocktail Counter', 'MOCKTAIL', 'mocktail', 'Non-alcoholic beverages', NULL, NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'"}
Error: Duplicate entry '4-Mocktail Counter' for key 'uk_station_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createStation (E:\restro-backend\src\services\kitchenStation.service.js:24:33)
    at createKitchenStation (E:\restro-backend\src\controllers\tax.controller.js:373:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:56 [ERROR]: Create counter error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO counters (outlet_id, floor_id, name, code, counter_type, description, printer_id, is_active, display_order)\n       VALUES (4, 2, 'Main Bar', 'MAINBAR', 'bar', 'Main bar counter', NULL, true, 0)","sqlState":"23000","sqlMessage":"Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'"}
Error: Duplicate entry '4-Main Bar' for key 'uk_counter_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createCounter (E:\restro-backend\src\services\kitchenStation.service.js:100:33)
    at createCounter (E:\restro-backend\src\controllers\tax.controller.js:424:51)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-04 13:52:56 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 14:37:42 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 14:37:47 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 14:37:51 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-04 15:51:20 [ERROR]: Failed to create print job for invoice INV/2526/000008: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 15:51:20 [ERROR]: Process payment error: Column 'outlet_id' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO payments (\n          uuid, outlet_id, order_id, invoice_id, payment_number,\n          payment_mode, amount, tip_amount, total_amount, status,\n          transaction_id, reference_number,\n          card_last_four, card_type, upi_id, wallet_name, bank_name,\n          notes, received_by\n        ) VALUES ('4b2cb7e2-2eb7-464d-be0b-1c4b61137058', NULL, 17, 8, 'PAY2602040001', 'cash', 2541, 0, 2541, 'completed', NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1)","sqlState":"23000","sqlMessage":"Column 'outlet_id' cannot be null"}
Error: Column 'outlet_id' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:90:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-04 15:59:28 [ERROR]: Failed to create print job for invoice INV/2526/000009: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 15:59:28 [ERROR]: Process payment error: Column 'outlet_id' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO payments (\n          uuid, outlet_id, order_id, invoice_id, payment_number,\n          payment_mode, amount, tip_amount, total_amount, status,\n          transaction_id, reference_number,\n          card_last_four, card_type, upi_id, wallet_name, bank_name,\n          notes, received_by\n        ) VALUES ('61f34e85-23ee-465f-9890-3448b2db123e', NULL, 18, 9, 'PAY2602040001', 'cash', 2541, 0, 2541, 'completed', NULL, 'CASH-1770200968906', NULL, NULL, NULL, NULL, NULL, NULL, 1)","sqlState":"23000","sqlMessage":"Column 'outlet_id' cannot be null"}
Error: Column 'outlet_id' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:90:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-04 16:00:43 [ERROR]: Failed to create print job for invoice INV/2526/000010: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 16:00:43 [ERROR]: Process payment error: Unknown column 'end_time' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE table_sessions SET \n              status = 'completed', end_time = NOW(), \n              total_amount = 2541, payment_status = 'paid'\n             WHERE id = 15","sqlState":"42S22","sqlMessage":"Unknown column 'end_time' in 'field list'"}
Error: Unknown column 'end_time' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:170:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-04 16:01:08 [ERROR]: Failed to create print job for invoice INV/2526/000011: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 16:01:09 [ERROR]: Process payment error: Unknown column 'total_amount' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE table_sessions SET \n              status = 'completed', ended_at = NOW(), \n              total_amount = 2541, payment_status = 'paid'\n             WHERE id = 16","sqlState":"42S22","sqlMessage":"Unknown column 'total_amount' in 'field list'"}
Error: Unknown column 'total_amount' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:170:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:392:23)
2026-02-04 16:01:35 [ERROR]: Failed to create print job for invoice INV/2526/000012: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 17:32:33 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"items.2.addons.0","message":"items[2].addons[0] must be a number"},{"field":"items.2.addons.1","message":"items[2].addons[1] must be a number"},{"field":"items.3.addons.0","message":"items[3].addons[0] must be a number"},{"field":"items.3.addons.1","message":"items[3].addons[1] must be a number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-04 17:32:33 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-04 17:32:34 [ERROR]: Failed to create print job for invoice INV/2526/000013: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 17:33:35 [ERROR]: Failed to create print job for invoice INV/2526/000014: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-04 18:23:31 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:350:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:140:22)
2026-02-04 18:23:58 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '7' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:842:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:263:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-04 18:24:12 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '1' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:842:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:263:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-04 18:37:44 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:649:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 18:39:34 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:649:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-04 18:40:43 [ERROR]: Unhandled error: Unknown column 'kt.kitchen_station_id' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT kt.*, ks.name as station_name, ks.station_type,\n                u.name as accepted_by_name\n               FROM kot_tickets kt\n               LEFT JOIN kitchen_stations ks ON kt.kitchen_station_id = ks.id\n               LEFT JOIN users u ON kt.accepted_by = u.id\n               WHERE kt.order_id = 24\n               ORDER BY kt.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'kt.kitchen_station_id' in 'on clause'"}
Error: Unknown column 'kt.kitchen_station_id' in 'on clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getFullDetails (E:\restro-backend\src\services\table.service.js:272:39)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTableById (E:\restro-backend\src\controllers\table.controller.js:52:21)
2026-02-04 19:14:13 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-05 09:53:01 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '6' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:1143:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:264:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-05 09:53:11 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '5' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:1143:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:264:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-05 09:53:29 [ERROR]: Unhandled error: Table is currently billing
Error: Table is currently billing
    at Object.startSession (E:\restro-backend\src\services\table.service.js:651:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 10:47:32 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-05 12:34:14 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 12:35:08 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:35:09 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-05 12:36:31 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:36:31 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:36:31 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:36:31 [ERROR]: Create order error: Table is currently cleaning
Error: Table is currently cleaning
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 12:36:31 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:36:58 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:36:58 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-05 12:37:30 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:37:32 [ERROR]: Failed to create print job for invoice INV/2526/000015: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 12:37:32 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"paymentMode","message":"paymentMode is required"},{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-05 12:38:27 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:27 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:27 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:27 [ERROR]: Create order error: Table is currently cleaning
Error: Table is currently cleaning
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 12:38:27 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:53 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:53 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:53 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:38:55 [ERROR]: Failed to create print job for invoice INV/2526/000016: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 12:38:55 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"paymentMode","message":"paymentMode is required"},{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-05 12:39:28 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:39:28 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:39:28 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:39:30 [ERROR]: Failed to create print job for invoice INV/2526/000017: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:141:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 12:39:30 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"paymentMode","message":"paymentMode is required"},{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-05 12:39:36 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:58:13 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:58:13 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:58:13 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 12:58:15 [ERROR]: Failed to create print job for invoice INV/2526/000018: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 12:58:15 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"paymentMode","message":"paymentMode is required"},{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-05 13:03:16 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"paymentMode","message":"paymentMode is required"},{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-05 13:07:39 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 13:07:39 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 13:07:41 [ERROR]: Failed to create print job for invoice INV/2526/000019: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 14:10:05 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 14:11:24 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 14:14:46 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 14:15:47 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 14:15:56 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 14:16:17 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 14:16:18 [ERROR]: Failed to create print job for invoice INV/2526/000020: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 14:24:40 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-05 16:29:37 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:36:38 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:36:40 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:86:25)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:44:44 [ERROR]: Create order error: tableService.getActiveSession is not a function
TypeError: tableService.getActiveSession is not a function
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:128:52)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:46:01 [ERROR]: Create order error: Unknown column 'u.role_id' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT r.name as role_name FROM users u JOIN roles r ON u.role_id = r.id WHERE u.id = 1","sqlState":"42S22","sqlMessage":"Unknown column 'u.role_id' in 'on clause'"}
Error: Unknown column 'u.role_id' in 'on clause'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:137:47)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:47:32 [ERROR]: Create order error: Only the captain who started this session can create orders. Contact manager to transfer table.
Error: Only the captain who started this session can create orders. Contact manager to transfer table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:148:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:48:17 [ERROR]: Create order error: Only the captain who started this session can create orders. Contact manager to transfer table.
Error: Only the captain who started this session can create orders. Contact manager to transfer table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:148:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-05 16:49:57 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 16:49:58 [ERROR]: Failed to create print job for invoice INV/2526/000021: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:432:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:541:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:293:23)
2026-02-05 16:56:21 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 16:56:21 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 16:56:55 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 16:56:55 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 16:56:55 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 17:11:32 [ERROR]: Add items error: Variant 5 not found
Error: Variant 5 not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:272:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-05 17:11:44 [ERROR]: Add items error: Variant 9 not found
Error: Variant 9 not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:272:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-05 17:11:50 [ERROR]: Add items error: Variant 1 not found
Error: Variant 1 not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:272:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-05 18:15:54 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 18:15:54 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-05 18:45:27 [ERROR]: Add items error: Variant 2 not found
Error: Variant 2 not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:272:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-05 18:47:20 [ERROR]: Unhandled error: Unexpected token ']', ..." },
   
  ]
}" is not valid JSON {"expose":true,"statusCode":400,"status":400,"body":"{\n  \"items\": [\n    {\n      \"itemId\": 1,\n      \"quantity\": 2,\n      \"specialInstructions\": \"Extra spicy\"\n    },\n   \n  ]\n}","type":"entity.parse.failed"}
SyntaxError: Unexpected token ']', ..." },
   
  ]
}" is not valid JSON
    at JSON.parse (<anonymous>)
    at parse (E:\restro-backend\node_modules\body-parser\lib\types\json.js:92:19)
    at E:\restro-backend\node_modules\body-parser\lib\read.js:128:18
    at AsyncResource.runInAsyncScope (node:async_hooks:211:14)
    at invokeCallback (E:\restro-backend\node_modules\raw-body\index.js:238:16)
    at done (E:\restro-backend\node_modules\raw-body\index.js:227:7)
    at IncomingMessage.onEnd (E:\restro-backend\node_modules\raw-body\index.js:287:7)
    at IncomingMessage.emit (node:events:518:28)
    at endReadableNT (node:internal/streams/readable:1698:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)
2026-02-06 10:00:11 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-06 10:16:12 [ERROR]: Create order error: Table already has an active order
Error: Table already has an active order
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:135:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 10:16:37 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:718:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:115:21)
2026-02-06 10:21:07 [ERROR]: Add items error: Variant 2 not found
Error: Variant 2 not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:272:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:73:22)
2026-02-06 10:55:01 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:95:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:173:22)
2026-02-06 11:12:32 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 11:12:40 [ERROR]: Create order error: Only the captain who started this session can create orders. Contact manager to transfer table.
Error: Only the captain who started this session can create orders. Contact manager to transfer table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:148:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 11:12:54 [ERROR]: Create order error: Only the captain who started this session can create orders. Contact manager to transfer table.
Error: Only the captain who started this session can create orders. Contact manager to transfer table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:148:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 11:31:42 [ERROR]: Create order error: Only the captain who started this session can create orders. Contact manager to transfer table.
Error: Only the captain who started this session can create orders. Contact manager to transfer table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:148:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 11:32:23 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 11:50:00 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:50:03 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:50:16 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:52:06 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:52:09 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:52:17 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 11:52:22 [ERROR]: Search items error: Unknown column 'i.tax_rate' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT DISTINCT i.id, i.name, i.short_name, i.description, i.base_price,\n        i.image_url, i.item_type, i.has_variants, i.has_addons,\n        i.is_bestseller, i.is_recommended, i.is_new, i.spice_level,\n        i.preparation_time_mins, i.category_id, i.tax_group_id, i.tax_rate, i.tax_inclusive,\n        c.name as category_name, c.id as cat_id\n      FROM items i\n      JOIN categories c ON i.category_id = c.id\n      WHERE i.outlet_id = '4' AND i.is_active = 1 AND i.is_available = 1 AND i.deleted_at IS NULL\n      AND (i.name LIKE '%undefined%' OR i.short_name LIKE '%undefined%' OR i.sku LIKE '%undefined%' OR i.tags LIKE '%undefined%')\n     ORDER BY i.is_bestseller DESC, i.name LIMIT 20","sqlState":"42S22","sqlMessage":"Unknown column 'i.tax_rate' in 'field list'"}
Error: Unknown column 'i.tax_rate' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.searchItems (E:\restro-backend\src\services\menuEngine.service.js:488:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async searchItems (E:\restro-backend\src\controllers\menu.controller.js:480:21)
2026-02-06 12:47:30 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:15:04 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 14:15:08 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 14:15:45 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:15:55 [ERROR]: Unhandled error: Table is currently 
Error: Table is currently 
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 14:46:18 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 14:46:18 [ERROR]: Create order error: Table already has an active order (Order ID: 51). Use existing order or end session first.
Error: Table already has an active order (Order ID: 51). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:47:02 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 14:47:02 [ERROR]: Create order error: Table already has an active order (Order ID: 51). Use existing order or end session first.
Error: Table already has an active order (Order ID: 51). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:50:51 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:51:10 [ERROR]: Create order error: Table already has an active order (Order ID: 30). Use existing order or end session first.
Error: Table already has an active order (Order ID: 30). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:54:00 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:54:14 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 14:57:18 [ERROR]: Create order error: Table already has an active order (Order ID: 52). Use existing order or end session first.
Error: Table already has an active order (Order ID: 52). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:20:21)
2026-02-06 15:33:54 [ERROR]: Get captain order history error: Unknown column 'o.sub_total' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"\n      SELECT \n        o.id,\n        o.order_number,\n        o.order_type,\n        o.status,\n        o.sub_total,\n        o.tax_amount,\n        o.discount_amount,\n        o.total_amount,\n        o.guest_count,\n        o.customer_name,\n        o.customer_phone,\n        o.created_at,\n        o.updated_at,\n        o.cancelled_at,\n        o.cancel_reason,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        ts.started_at as session_started_at,\n        ts.ended_at as session_ended_at,\n        (SELECT COUNT(*) FROM order_items oi WHERE oi.order_id = o.id AND oi.status != 'cancelled') as item_count,\n        (SELECT COUNT(*) FROM kot_tickets kt WHERE kt.order_id = o.id) as kot_count,\n        u.name as created_by_name\n      FROM orders o\n      LEFT JOIN tables t ON o.table_id = t.id\n      LEFT JOIN floors f ON o.floor_id = f.id\n      LEFT JOIN table_sessions ts ON o.table_session_id = ts.id\n      LEFT JOIN users u ON o.created_by = u.id\n      WHERE o.outlet_id = '4' AND o.created_by = 1\n     ORDER BY o.created_at DESC LIMIT 20 OFFSET 0","sqlState":"42S22","sqlMessage":"Unknown column 'o.sub_total' in 'field list'"}
Error: Unknown column 'o.sub_total' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getCaptainOrderHistory (E:\restro-backend\src\services\order.service.js:911:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCaptainOrderHistory (E:\restro-backend\src\controllers\order.controller.js:665:22)
2026-02-06 15:33:54 [ERROR]: Get captain order detail error: Table 'restro.item_variants' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT oi.*, \n        i.name as item_name, i.short_name,\n        v.name as variant_name,\n        uc.name as cancelled_by_name\n       FROM order_items oi\n       LEFT JOIN items i ON oi.item_id = i.id\n       LEFT JOIN item_variants v ON oi.variant_id = v.id\n       LEFT JOIN users uc ON oi.cancelled_by = uc.id\n       WHERE oi.order_id = '54'\n       ORDER BY oi.created_at","sqlState":"42S02","sqlMessage":"Table 'restro.item_variants' doesn't exist"}
Error: Table 'restro.item_variants' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getCaptainOrderDetail (E:\restro-backend\src\services\order.service.js:970:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCaptainOrderDetail (E:\restro-backend\src\controllers\order.controller.js:680:21)
2026-02-06 15:33:54 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:758:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:115:21)
2026-02-06 15:34:33 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-06 15:34:34 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:758:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:115:21)
2026-02-06 15:59:32 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-06 15:59:33 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:361:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:238:19)
2026-02-06 16:00:11 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-06 17:05:32 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-06 17:22:59 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-06 17:23:27 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 17:23:27 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-06 17:24:09 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 17:24:09 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-06 17:25:05 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-06 17:25:05 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-07 09:56:59 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 09:57:59 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:31 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:32 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:32 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:32 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:32 [ERROR]: Redis max retries reached
2026-02-07 10:27:32 [ERROR]: Redis error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-07 10:27:32 [ERROR]: Redis max retries reached
2026-02-07 10:37:24 [ERROR]: Get active KOTs error: Table 'restro.user_roles' doesn't exist in engine {"errno":1932,"sql":"SELECT ur.outlet_id \n       FROM user_roles ur\n       WHERE ur.user_id = 8 AND ur.is_active = 1 AND ur.outlet_id IS NOT NULL\n       ORDER BY ur.assigned_at DESC\n       LIMIT 1","sqlState":"42S02","sqlMessage":"Table 'restro.user_roles' doesn't exist in engine"}
Error: Table 'restro.user_roles' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 10:37:24 [ERROR]: Get current user failed: Table 'restro.users' doesn't exist in engine {"errno":1932,"sql":"SELECT u.id, u.uuid, u.employee_code, u.name, u.email, u.phone, \n              u.avatar_url, u.is_active, u.is_verified, u.last_login_at\n       FROM users u\n       WHERE u.id = 8 AND u.deleted_at IS NULL","sqlState":"42S02","sqlMessage":"Table 'restro.users' doesn't exist in engine"}
Error: Table 'restro.users' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:37:24 [ERROR]: Unhandled error: Table 'restro.users' doesn't exist in engine {"errno":1932,"sql":"SELECT u.id, u.uuid, u.employee_code, u.name, u.email, u.phone, \n              u.avatar_url, u.is_active, u.is_verified, u.last_login_at\n       FROM users u\n       WHERE u.id = 8 AND u.deleted_at IS NULL","sqlState":"42S02","sqlMessage":"Table 'restro.users' doesn't exist in engine"}
Error: Table 'restro.users' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:37:24 [ERROR]: Get active KOTs error: Table 'restro.user_roles' doesn't exist in engine {"errno":1932,"sql":"SELECT ur.outlet_id \n       FROM user_roles ur\n       WHERE ur.user_id = 8 AND ur.is_active = 1 AND ur.outlet_id IS NOT NULL\n       ORDER BY ur.assigned_at DESC\n       LIMIT 1","sqlState":"42S02","sqlMessage":"Table 'restro.user_roles' doesn't exist in engine"}
Error: Table 'restro.user_roles' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 10:37:24 [ERROR]: Get current user failed: Table 'restro.users' doesn't exist in engine {"errno":1932,"sql":"SELECT u.id, u.uuid, u.employee_code, u.name, u.email, u.phone, \n              u.avatar_url, u.is_active, u.is_verified, u.last_login_at\n       FROM users u\n       WHERE u.id = 8 AND u.deleted_at IS NULL","sqlState":"42S02","sqlMessage":"Table 'restro.users' doesn't exist in engine"}
Error: Table 'restro.users' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:37:24 [ERROR]: Unhandled error: Table 'restro.users' doesn't exist in engine {"errno":1932,"sql":"SELECT u.id, u.uuid, u.employee_code, u.name, u.email, u.phone, \n              u.avatar_url, u.is_active, u.is_verified, u.last_login_at\n       FROM users u\n       WHERE u.id = 8 AND u.deleted_at IS NULL","sqlState":"42S02","sqlMessage":"Table 'restro.users' doesn't exist in engine"}
Error: Table 'restro.users' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:37:24 [ERROR]: Get active KOTs error: Table 'restro.user_roles' doesn't exist in engine {"errno":1932,"sql":"SELECT ur.outlet_id \n       FROM user_roles ur\n       WHERE ur.user_id = 8 AND ur.is_active = 1 AND ur.outlet_id IS NOT NULL\n       ORDER BY ur.assigned_at DESC\n       LIMIT 1","sqlState":"42S02","sqlMessage":"Table 'restro.user_roles' doesn't exist in engine"}
Error: Table 'restro.user_roles' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 10:37:24 [ERROR]: Get active KOTs error: Table 'restro.user_roles' doesn't exist in engine {"errno":1932,"sql":"SELECT ur.outlet_id \n       FROM user_roles ur\n       WHERE ur.user_id = 8 AND ur.is_active = 1 AND ur.outlet_id IS NOT NULL\n       ORDER BY ur.assigned_at DESC\n       LIMIT 1","sqlState":"42S02","sqlMessage":"Table 'restro.user_roles' doesn't exist in engine"}
Error: Table 'restro.user_roles' doesn't exist in engine
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 10:39:18 [ERROR]: Get current user failed: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:39:18 [ERROR]: Unhandled error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:39:19 [ERROR]: Get current user failed: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:39:19 [ERROR]: Unhandled error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:263:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-07 10:39:38 [ERROR]: Get active KOTs error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 10:39:38 [ERROR]: Get active KOTs error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at UserService.getUserOutletId (E:\restro-backend\src\services\user.service.js:559:33)
    at getActiveKotsForUser (E:\restro-backend\src\controllers\order.controller.js:189:38)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-07 11:09:53 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:758:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:23:57 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:758:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:40:12 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-07 11:40:12 [ERROR]: Create order error: Table already has an active order (Order ID: 64). Use existing order or end session first.
Error: Table already has an active order (Order ID: 64). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:40:49 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-07 11:40:49 [ERROR]: Create order error: Table already has an active order (Order ID: 64). Use existing order or end session first.
Error: Table already has an active order (Order ID: 64). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:41:09 [ERROR]: Create order error: Table already has an active order (Order ID: 64). Use existing order or end session first.
Error: Table already has an active order (Order ID: 64). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:42:06 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"email","message":"Please provide a valid email address"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-07 11:44:11 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"email","message":"Please provide a valid email address"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-07 11:45:12 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:45:12 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:45:44 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:45:44 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:46:49 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:46:49 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:47:08 [ERROR]: Create order error: Table already has an active order (Order ID: 53). Use existing order or end session first.
Error: Table already has an active order (Order ID: 53). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:47:08 [ERROR]: Create order error: Table already has an active order (Order ID: 53). Use existing order or end session first.
Error: Table already has an active order (Order ID: 53). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:47:48 [ERROR]: Create order error: Table already has an active order (Order ID: 67). Use existing order or end session first.
Error: Table already has an active order (Order ID: 67). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:47:48 [ERROR]: Create order error: Table already has an active order (Order ID: 67). Use existing order or end session first.
Error: Table already has an active order (Order ID: 67). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:48:31 [ERROR]: Create order error: Table already has an active order (Order ID: 67). Use existing order or end session first.
Error: Table already has an active order (Order ID: 67). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:48:56 [ERROR]: Cancel order error: Unknown column 'kt.table_id' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT kt.*, t.table_number \n         FROM kot_tickets kt\n         LEFT JOIN tables t ON kt.table_id = t.id\n         WHERE kt.order_id = '67' AND kt.status NOT IN ('served', 'cancelled')","sqlState":"42S22","sqlMessage":"Unknown column 'kt.table_id' in 'on clause'"}
Error: Unknown column 'kt.table_id' in 'on clause'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:799:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:48:56 [ERROR]: Create order error: Table already has an active order (Order ID: 67). Use existing order or end session first.
Error: Table already has an active order (Order ID: 67). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 11:49:55 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:49:57 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:52:11 [ERROR]: Cancel item error: Unknown column 'cancelled_at' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE kot_items SET status = 'cancelled', cancelled_at = NOW() WHERE order_item_id = '206'","sqlState":"42S22","sqlMessage":"Unknown column 'cancelled_at' in 'field list'"}
Error: Unknown column 'cancelled_at' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:695:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-07 11:52:11 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 11:53:55 [ERROR]: Cancel item error: Unknown column 'cancelled_at' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE kot_items SET status = 'cancelled', cancelled_at = NOW() WHERE order_item_id = '208'","sqlState":"42S22","sqlMessage":"Unknown column 'cancelled_at' in 'field list'"}
Error: Unknown column 'cancelled_at' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:695:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-07 11:53:55 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 11:53:55 [ERROR]: Cancel order error: Unknown column 'kt.table_id' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT kt.*, t.table_number \n         FROM kot_tickets kt\n         LEFT JOIN tables t ON kt.table_id = t.id\n         WHERE kt.order_id = '73' AND kt.status NOT IN ('served', 'cancelled')","sqlState":"42S22","sqlMessage":"Unknown column 'kt.table_id' in 'on clause'"}
Error: Unknown column 'kt.table_id' in 'on clause'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:799:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 11:54:35 [ERROR]: Cancel item error: Unknown column 'cancelled_at' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE kot_items SET status = 'cancelled', cancelled_at = NOW() WHERE order_item_id = '211'","sqlState":"42S22","sqlMessage":"Unknown column 'cancelled_at' in 'field list'"}
Error: Unknown column 'cancelled_at' in 'field list'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:695:26)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-07 11:54:35 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 11:54:35 [ERROR]: Cancel order error: Unknown column 'kt.table_id' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT kt.*, t.table_number \n         FROM kot_tickets kt\n         LEFT JOIN tables t ON kt.table_id = t.id\n         WHERE kt.order_id = '75' AND kt.status NOT IN ('served', 'cancelled')","sqlState":"42S22","sqlMessage":"Unknown column 'kt.table_id' in 'on clause'"}
Error: Unknown column 'kt.table_id' in 'on clause'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:799:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 12:08:59 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 12:09:49 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 12:12:55 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 12:37:46 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 12:37:46 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:238:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-07 12:37:46 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:77:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:174:22)
2026-02-07 12:37:46 [ERROR]: Cancel item error: Order item not found
Error: Order item not found
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:641:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-07 12:37:46 [ERROR]: Reprint KOT error: KOT not found
Error: KOT not found
    at Object.reprintKot (E:\restro-backend\src\services\kot.service.js:759:21)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async reprintKot (E:\restro-backend\src\controllers\order.controller.js:333:19)
2026-02-07 12:37:46 [ERROR]: Accept KOT error: Cannot read properties of null (reading 'outlet_id')
TypeError: Cannot read properties of null (reading 'outlet_id')
    at Object.acceptKot (E:\restro-backend\src\services\kot.service.js:290:34)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async acceptKot (E:\restro-backend\src\controllers\order.controller.js:249:19)
2026-02-07 12:37:46 [ERROR]: Cancel order error: Order not found
Error: Order not found
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:778:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 12:37:46 [ERROR]: Cancel order error: Order not found
Error: Order not found
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:778:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 12:37:46 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-07 12:37:46 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 12:37:46 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:238:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-07 12:37:46 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:77:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:174:22)
2026-02-07 12:37:46 [ERROR]: Cancel order error: Order not found
Error: Order not found
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:778:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 12:59:21 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 12:59:21 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:784:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:01:44 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 13:01:44 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:04:18 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 13:04:18 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:04:57 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:05:21 [ERROR]: Cancel order error: Table not found
Error: Table not found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:732:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.cancelOrder (E:\restro-backend\src\services\order.service.js:850:11)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:08:30 [ERROR]: Create order error: Table already has an active order (Order ID: 80). Use existing order or end session first.
Error: Table already has an active order (Order ID: 80). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:08:34 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:09:01 [ERROR]: Cancel order error: Manager approval required to cancel order with prepared items
Error: Manager approval required to cancel order with prepared items
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:795:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:09:44 [ERROR]: Cancel order error: Table not found
Error: Table not found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:732:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.cancelOrder (E:\restro-backend\src\services\order.service.js:850:11)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:13:59 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:14:47 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:15:04 [ERROR]: Create order error: Table already has an active order (Order ID: 80). Use existing order or end session first.
Error: Table already has an active order (Order ID: 80). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:15:29 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:25:02 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:25:19 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:25:19 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:238:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-07 13:25:19 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:77:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:174:22)
2026-02-07 13:25:20 [ERROR]: Cancel order error: Order not found
Error: Order not found
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:778:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:25:20 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:673:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-07 13:25:20 [ERROR]: Create order error: Table already has an active order (Order ID: 66). Use existing order or end session first.
Error: Table already has an active order (Order ID: 66). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:25:20 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:238:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-07 13:25:20 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:77:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:174:22)
2026-02-07 13:25:20 [ERROR]: Cancel order error: Order not found
Error: Order not found
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:778:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:26:04 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 13:26:04 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:784:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:26:13 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:784:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-07 13:26:29 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-07 13:27:26 [ERROR]: Create order error: Table already has an active order (Order ID: 50). Use existing order or end session first.
Error: Table already has an active order (Order ID: 50). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:27:52 [ERROR]: Create order error: Table already has an active order (Order ID: 80). Use existing order or end session first.
Error: Table already has an active order (Order ID: 80). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:28:46 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:29:29 [ERROR]: Create order error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by System Admin. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:31:58 [ERROR]: Create order error: Table already has an active order (Order ID: 94). Use existing order or end session first.
Error: Table already has an active order (Order ID: 94). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 13:32:26 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:740:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-07 13:40:04 [ERROR]: Create order error: Table already has an active order (Order ID: 97). Use existing order or end session first.
Error: Table already has an active order (Order ID: 97). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 15:45:01 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:744:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-07 16:14:05 [ERROR]: Create order error: Table already has an active order (Order ID: 97). Use existing order or end session first.
Error: Table already has an active order (Order ID: 97). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 16:14:13 [ERROR]: Create order error: Table already has an active order (Order ID: 97). Use existing order or end session first.
Error: Table already has an active order (Order ID: 97). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 17:47:15 [ERROR]: Create order error: Table already has an active order (Order ID: 97). Use existing order or end session first.
Error: Table already has an active order (Order ID: 97). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 18:11:36 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:744:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-07 18:27:54 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:744:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-07 18:27:56 [ERROR]: Create order error: Table already has an active order (Order ID: 107). Use existing order or end session first.
Error: Table already has an active order (Order ID: 107). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-07 18:27:56 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:822:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-09 10:13:34 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:887:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-09 10:14:08 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:887:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-09 10:15:19 [ERROR]: Create order error: Table is currently blocked
Error: Table is currently blocked
    at Object.startSession (E:\restro-backend\src\services\table.service.js:820:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:168:27)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 10:32:27 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:915:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-09 10:41:46 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:922:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:154:7)
2026-02-09 11:32:09 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"},{"field":"pin","message":"PIN is required for all staff"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-09 11:32:09 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"},{"field":"pin","message":"PIN is required for all staff"},{"field":"roles.0","message":"roles[0] must be of type object"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-09 11:33:38 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:540:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:531:22)
2026-02-09 11:33:38 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-09 11:34:09 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-09 11:35:29 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:504:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:516:22)
2026-02-09 11:36:23 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:504:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:516:22)
2026-02-09 11:41:36 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-09 11:42:04 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-09 11:45:35 [ERROR]: Failed to create print job for invoice INV/2526/000022: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 11:45:35 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:168:27)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 11:49:32 [ERROR]: Create order error: This table session was started by Test Cashier. Only they can create orders for this table, or contact a manager to transfer the table.
Error: This table session was started by Test Cashier. Only they can create orders for this table, or contact a manager to transfer the table.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:161:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 11:49:44 [ERROR]: Failed to create print job for invoice INV/2526/000023: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 11:49:45 [ERROR]: Failed to create print job for invoice INV/2526/000024: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 11:49:45 [ERROR]: Process split payment error: Column 'outlet_id' cannot be null {"code":"ER_BAD_NULL_ERROR","errno":1048,"sql":"INSERT INTO payments (\n          uuid, outlet_id, order_id, invoice_id, payment_number,\n          payment_mode, amount, total_amount, status, received_by\n        ) VALUES ('272346d9-b79b-4d72-a95f-51f556452e71', NULL, 123, 25, 'PAY2602090001', 'split', 387, 387, 'completed', 104)","sqlState":"23000","sqlMessage":"Column 'outlet_id' cannot be null"}
Error: Column 'outlet_id' cannot be null
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.processSplitPayment (E:\restro-backend\src\services\payment.service.js:245:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processSplitPayment (E:\restro-backend\src\controllers\order.controller.js:463:23)
2026-02-09 11:55:53 [ERROR]: Failed to create print job for invoice INV/2526/000025: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 11:55:54 [ERROR]: Failed to create print job for invoice INV/2526/000026: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 11:59:24 [ERROR]: Failed to create print job for invoice INV/2526/000027: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 11:59:24 [ERROR]: Failed to create print job for invoice INV/2526/000028: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 12:04:26 [ERROR]: Failed to create print job for invoice INV/2526/000029: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 12:04:26 [ERROR]: Failed to create print job for invoice INV/2526/000030: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 12:05:57 [ERROR]: Could not close connections in time, forcefully shutting down
2026-02-09 12:16:49 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"items","message":"items must contain at least 1 items"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-09 12:19:20 [ERROR]: Failed to create print job for invoice INV/2526/000031: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 12:19:20 [ERROR]: Failed to create print job for invoice INV/2526/000032: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 12:43:10 [ERROR]: Could not close connections in time, forcefully shutting down
2026-02-09 13:00:47 [ERROR]: Failed to create print job for invoice INV/2526/000033: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 13:00:47 [ERROR]: Failed to create print job for invoice INV/2526/000034: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 13:59:09 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 15:25:53 [ERROR]: Cancel item error: Manager approval required to cancel prepared items
Error: Manager approval required to cancel prepared items
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:655:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-09 15:31:55 [ERROR]: Cancel item error: Manager approval required to cancel prepared items
Error: Manager approval required to cancel prepared items
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:655:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-09 16:57:37 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 16:57:38 [ERROR]: Failed to create print job for invoice INV/2526/000035: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 16:57:38 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 17:13:59 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 17:14:00 [ERROR]: Failed to create print job for invoice INV/2526/000036: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 17:14:00 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 17:14:00 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-09 17:14:00 [ERROR]: Create order error: Table already has an active order (Order ID: 161). Use existing order or end session first.
Error: Table already has an active order (Order ID: 161). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:14:00 [ERROR]: Create order error: Table already has an active order (Order ID: 161). Use existing order or end session first.
Error: Table already has an active order (Order ID: 161). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:14:00 [ERROR]: Create order error: Duplicate entry '4-ORD2602090048' for key 'uk_order_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('07a1049c-5eaf-4520-b010-5b45615d80b0', 4, 'ORD2602090048', 'takeaway', NULL, NULL, NULL, NULL, NULL, 'Test Customer', '9876543210', 2, 'pending', 'pending', NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-ORD2602090048' for key 'uk_order_number_outlet'"}
Error: Duplicate entry '4-ORD2602090048' for key 'uk_order_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:183:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:17:34 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 17:17:35 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-09 17:17:36 [ERROR]: Create order error: Duplicate entry '4-ORD2602090048' for key 'uk_order_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('e87c7aba-b6e7-44bb-8439-2e0bca9407f8', 4, 'ORD2602090048', 'takeaway', NULL, NULL, NULL, NULL, NULL, 'Takeaway Customer', '9876543210', 1, 'pending', 'pending', NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-ORD2602090048' for key 'uk_order_number_outlet'"}
Error: Duplicate entry '4-ORD2602090048' for key 'uk_order_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:183:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:17:37 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-09 17:17:39 [ERROR]: Create order error: Table already has an active order (Order ID: 161). Use existing order or end session first.
Error: Table already has an active order (Order ID: 161). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:17:40 [ERROR]: Create order error: Table already has an active order (Order ID: 161). Use existing order or end session first.
Error: Table already has an active order (Order ID: 161). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:138:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:17:41 [ERROR]: Create order error: Duplicate entry '4-ORD2602090048' for key 'uk_order_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('c7a2950d-92f6-4ee6-ba79-f8e5afc4cdef', 4, 'ORD2602090048', 'takeaway', NULL, NULL, NULL, NULL, NULL, 'Test Customer', '9876543210', 2, 'pending', 'pending', NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-ORD2602090048' for key 'uk_order_number_outlet'"}
Error: Duplicate entry '4-ORD2602090048' for key 'uk_order_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:183:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:20:47 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 17:20:49 [ERROR]: Failed to create print job for invoice INV/2526/000037: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 17:20:49 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 17:20:51 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-09 17:20:52 [ERROR]: Create order error: Table already has an active order (Order ID: 166). Use existing order or end session first.
Error: Table already has an active order (Order ID: 166). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:20:54 [ERROR]: Create order error: Table already has an active order (Order ID: 166). Use existing order or end session first.
Error: Table already has an active order (Order ID: 166). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:20:55 [ERROR]: Create order error: Duplicate entry '4-ORD2602090050' for key 'uk_order_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('c610ea16-4804-4908-8689-b0bd0b65b514', 4, 'ORD2602090050', 'takeaway', NULL, NULL, NULL, NULL, NULL, 'Test Customer', '9876543210', 2, 'pending', 'pending', NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-ORD2602090050' for key 'uk_order_number_outlet'"}
Error: Duplicate entry '4-ORD2602090050' for key 'uk_order_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:185:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:24:13 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 17:24:15 [ERROR]: Failed to create print job for invoice INV/2526/000038: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 17:24:15 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 17:24:17 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-09 17:24:18 [ERROR]: Create order error: Table already has an active order (Order ID: 169). Use existing order or end session first.
Error: Table already has an active order (Order ID: 169). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:24:20 [ERROR]: Create order error: Table already has an active order (Order ID: 169). Use existing order or end session first.
Error: Table already has an active order (Order ID: 169). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:24:21 [ERROR]: Create order error: Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('d2c4705e-885f-4845-8cfc-6fc73966135d', 4, 'ORD2602090052', 'takeaway', NULL, NULL, NULL, NULL, NULL, 'Test Customer', '9876543210', 2, 'pending', 'pending', NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet'"}
Error: Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:185:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:28:41 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 17:28:41 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-09 17:28:42 [ERROR]: Create order error: Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('127713c6-5abb-420d-a1a5-f7da6020982b', 4, 'ORD2602090052', 'takeaway', NULL, NULL, NULL, NULL, NULL, 'Takeaway Customer', '9876543210', 1, 'pending', 'pending', NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet'"}
Error: Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:185:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:28:44 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-09 17:28:45 [ERROR]: Create order error: Table already has an active order (Order ID: 169). Use existing order or end session first.
Error: Table already has an active order (Order ID: 169). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:28:46 [ERROR]: Create order error: Table already has an active order (Order ID: 169). Use existing order or end session first.
Error: Table already has an active order (Order ID: 169). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:28:47 [ERROR]: Create order error: Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('fbd58880-d60d-4574-8733-af976e183503', 4, 'ORD2602090052', 'takeaway', NULL, NULL, NULL, NULL, NULL, 'Test Customer', '9876543210', 2, 'pending', 'pending', NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet'"}
Error: Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:185:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:34:08 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 17:34:09 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-09 17:34:10 [ERROR]: Create order error: Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('902ce4c5-4e7b-4a0c-8612-8ee8b26eaf9b', 4, 'ORD2602090052', 'takeaway', NULL, NULL, NULL, NULL, NULL, 'Takeaway Customer', '9876543210', 1, 'pending', 'pending', NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet'"}
Error: Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:185:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:34:12 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-09 17:34:13 [ERROR]: Create order error: Table already has an active order (Order ID: 169). Use existing order or end session first.
Error: Table already has an active order (Order ID: 169). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:34:14 [ERROR]: Create order error: Table already has an active order (Order ID: 169). Use existing order or end session first.
Error: Table already has an active order (Order ID: 169). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:34:15 [ERROR]: Create order error: Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('9ea7ec79-df0b-44e4-acc7-a0906eb9752c', 4, 'ORD2602090052', 'takeaway', NULL, NULL, NULL, NULL, NULL, 'Test Customer', '9876543210', 2, 'pending', 'pending', NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet'"}
Error: Duplicate entry '4-ORD2602090052' for key 'uk_order_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:185:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:38:03 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 17:38:07 [ERROR]: Failed to create print job for invoice INV/2526/000039: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 17:38:07 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 17:38:10 [ERROR]: Create order error: Table already has an active order (Order ID: 176). Use existing order or end session first.
Error: Table already has an active order (Order ID: 176). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:38:11 [ERROR]: Create order error: Table already has an active order (Order ID: 176). Use existing order or end session first.
Error: Table already has an active order (Order ID: 176). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:38:12 [ERROR]: Create order error: Table already has an active order (Order ID: 176). Use existing order or end session first.
Error: Table already has an active order (Order ID: 176). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:38:13 [ERROR]: Create order error: Duplicate entry '4-ORD2602090054' for key 'uk_order_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO orders (\n          uuid, outlet_id, order_number, order_type,\n          table_id, table_session_id, floor_id, section_id,\n          customer_id, customer_name, customer_phone, guest_count,\n          status, payment_status, special_instructions, created_by\n        ) VALUES ('3547b96e-e6cf-4321-afc3-99f94a9d91db', 4, 'ORD2602090054', 'takeaway', NULL, NULL, NULL, NULL, NULL, 'Test Customer', '9876543210', 2, 'pending', 'pending', NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-ORD2602090054' for key 'uk_order_number_outlet'"}
Error: Duplicate entry '4-ORD2602090054' for key 'uk_order_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:185:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:41:49 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 17:41:53 [ERROR]: Failed to create print job for invoice INV/2526/000040: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 17:41:53 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 17:41:56 [ERROR]: Create order error: Table already has an active order (Order ID: 179). Use existing order or end session first.
Error: Table already has an active order (Order ID: 179). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:41:57 [ERROR]: Create order error: Table already has an active order (Order ID: 179). Use existing order or end session first.
Error: Table already has an active order (Order ID: 179). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:41:58 [ERROR]: Create order error: Table already has an active order (Order ID: 179). Use existing order or end session first.
Error: Table already has an active order (Order ID: 179). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:47:39 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 17:47:43 [ERROR]: Failed to create print job for invoice INV/2526/000041: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 17:47:43 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 17:47:45 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:260:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-09 17:47:47 [ERROR]: Create order error: Table already has an active order (Order ID: 182). Use existing order or end session first.
Error: Table already has an active order (Order ID: 182). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:47:49 [ERROR]: Create order error: Table already has an active order (Order ID: 182). Use existing order or end session first.
Error: Table already has an active order (Order ID: 182). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:47:51 [ERROR]: Create order error: Table already has an active order (Order ID: 182). Use existing order or end session first.
Error: Table already has an active order (Order ID: 182). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:47:53 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:260:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-09 17:59:07 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 17:59:11 [ERROR]: Failed to create print job for invoice INV/2526/000042: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 17:59:11 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 17:59:12 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:260:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-09 17:59:15 [ERROR]: Create order error: Table already has an active order (Order ID: 185). Use existing order or end session first.
Error: Table already has an active order (Order ID: 185). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:59:17 [ERROR]: Create order error: Table already has an active order (Order ID: 185). Use existing order or end session first.
Error: Table already has an active order (Order ID: 185). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:59:19 [ERROR]: Create order error: Table already has an active order (Order ID: 185). Use existing order or end session first.
Error: Table already has an active order (Order ID: 185). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 17:59:21 [ERROR]: Add items error: Order not found
Error: Order not found
    at Object.addItems (E:\restro-backend\src\services\order.service.js:260:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-09 18:03:39 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:03:43 [ERROR]: Failed to create print job for invoice INV/2526/000043: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:03:43 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 18:03:45 [ERROR]: Mark KOT ready error: Cannot read properties of null (reading 'outletId')
TypeError: Cannot read properties of null (reading 'outletId')
    at Object.markKotReady (E:\restro-backend\src\services\kot.service.js:523:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markKotReady (E:\restro-backend\src\controllers\order.controller.js:282:19)
2026-02-09 18:03:47 [ERROR]: Create order error: Table already has an active order (Order ID: 188). Use existing order or end session first.
Error: Table already has an active order (Order ID: 188). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:03:49 [ERROR]: Create order error: Table already has an active order (Order ID: 188). Use existing order or end session first.
Error: Table already has an active order (Order ID: 188). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:03:51 [ERROR]: Create order error: Table already has an active order (Order ID: 188). Use existing order or end session first.
Error: Table already has an active order (Order ID: 188). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:03:53 [ERROR]: Mark KOT ready error: Cannot read properties of null (reading 'outletId')
TypeError: Cannot read properties of null (reading 'outletId')
    at Object.markKotReady (E:\restro-backend\src\services\kot.service.js:523:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markKotReady (E:\restro-backend\src\controllers\order.controller.js:282:19)
2026-02-09 18:09:26 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:09:29 [ERROR]: Failed to create print job for invoice INV/2526/000044: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:09:29 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 18:09:31 [ERROR]: Mark KOT ready error: Cannot read properties of null (reading 'outletId')
TypeError: Cannot read properties of null (reading 'outletId')
    at Object.markKotReady (E:\restro-backend\src\services\kot.service.js:523:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markKotReady (E:\restro-backend\src\controllers\order.controller.js:282:19)
2026-02-09 18:09:33 [ERROR]: Create order error: Table already has an active order (Order ID: 191). Use existing order or end session first.
Error: Table already has an active order (Order ID: 191). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:09:35 [ERROR]: Create order error: Table already has an active order (Order ID: 191). Use existing order or end session first.
Error: Table already has an active order (Order ID: 191). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:09:38 [ERROR]: Create order error: Table already has an active order (Order ID: 191). Use existing order or end session first.
Error: Table already has an active order (Order ID: 191). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:09:39 [ERROR]: Mark KOT ready error: Cannot read properties of null (reading 'outletId')
TypeError: Cannot read properties of null (reading 'outletId')
    at Object.markKotReady (E:\restro-backend\src\services\kot.service.js:523:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markKotReady (E:\restro-backend\src\controllers\order.controller.js:282:19)
2026-02-09 18:14:16 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:14:20 [ERROR]: Failed to create print job for invoice INV/2526/000045: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:14:20 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 18:15:13 [ERROR]: Generate bill error: Lock wait timeout exceeded; try restarting transaction {"code":"ER_LOCK_WAIT_TIMEOUT","errno":1205,"sql":"INSERT INTO invoices (\n          uuid, outlet_id, order_id, invoice_number, invoice_date, invoice_time,\n          customer_id, customer_name, customer_phone, customer_email,\n          customer_gstin, customer_address, billing_address,\n          subtotal, discount_amount, taxable_amount,\n          cgst_amount, sgst_amount, igst_amount, vat_amount, cess_amount, total_tax,\n          service_charge, packaging_charge, delivery_charge, round_off, grand_total,\n          amount_in_words, payment_status, tax_breakup, hsn_summary,\n          notes, terms_conditions, generated_by\n        ) VALUES ('c1846ae7-2684-48bc-8171-d847e86aebb7', 4, '195', 'INV/2526/000046', '2026-02-09', '18:14:22', NULL, 'Takeaway Customer', '9876543210', NULL, NULL, NULL, NULL, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Zero Rupees Only', 'pending', '{}', '{}', NULL, NULL, 7)","sqlState":"HY000","sqlMessage":"Lock wait timeout exceeded; try restarting transaction"}
Error: Lock wait timeout exceeded; try restarting transaction
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:85:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:18:38 [ERROR]: Generate bill error: Lock wait timeout exceeded; try restarting transaction {"code":"ER_LOCK_WAIT_TIMEOUT","errno":1205,"sql":"INSERT INTO invoices (\n          uuid, outlet_id, order_id, invoice_number, invoice_date, invoice_time,\n          customer_id, customer_name, customer_phone, customer_email,\n          customer_gstin, customer_address, billing_address,\n          subtotal, discount_amount, taxable_amount,\n          cgst_amount, sgst_amount, igst_amount, vat_amount, cess_amount, total_tax,\n          service_charge, packaging_charge, delivery_charge, round_off, grand_total,\n          amount_in_words, payment_status, tax_breakup, hsn_summary,\n          notes, terms_conditions, generated_by\n        ) VALUES ('40a02d87-e1e2-49ad-a45a-74e4d372b173', 4, '196', 'INV/2526/000046', '2026-02-09', '18:17:47', NULL, 'Test Customer', '9876543210', NULL, NULL, NULL, NULL, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 'Zero Rupees Only', 'pending', '{}', '{}', NULL, NULL, 7)","sqlState":"HY000","sqlMessage":"Lock wait timeout exceeded; try restarting transaction"}
Error: Lock wait timeout exceeded; try restarting transaction
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:85:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:23:10 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:23:15 [ERROR]: Failed to create print job for invoice INV/2526/000046: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:154:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:23:15 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 18:23:17 [ERROR]: Generate bill error: Order not found
Error: Order not found
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:52:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:23:19 [ERROR]: Create order error: Table already has an active order (Order ID: 197). Use existing order or end session first.
Error: Table already has an active order (Order ID: 197). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:23:21 [ERROR]: Create order error: Table already has an active order (Order ID: 197). Use existing order or end session first.
Error: Table already has an active order (Order ID: 197). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:23:23 [ERROR]: Create order error: Table already has an active order (Order ID: 197). Use existing order or end session first.
Error: Table already has an active order (Order ID: 197). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:23:25 [ERROR]: Generate bill error: Order not found
Error: Order not found
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:52:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:27:12 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:27:15 [ERROR]: Failed to create print job for invoice INV/2526/000047: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:180:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:27:15 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 18:27:17 [ERROR]: Failed to create print job for invoice INV/2526/000048: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:180:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:27:19 [ERROR]: Create order error: Table already has an active order (Order ID: 200). Use existing order or end session first.
Error: Table already has an active order (Order ID: 200). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:27:22 [ERROR]: Create order error: Table already has an active order (Order ID: 200). Use existing order or end session first.
Error: Table already has an active order (Order ID: 200). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:27:24 [ERROR]: Create order error: Table already has an active order (Order ID: 200). Use existing order or end session first.
Error: Table already has an active order (Order ID: 200). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:27:25 [ERROR]: Generate bill error: Duplicate entry '4-INV/2526/000048' for key 'uk_invoice_number_outlet' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO invoices (\n          uuid, outlet_id, order_id, invoice_number, invoice_date, invoice_time,\n          customer_id, customer_name, customer_phone, customer_email,\n          customer_gstin, customer_address, billing_address,\n          subtotal, discount_amount, taxable_amount,\n          cgst_amount, sgst_amount, igst_amount, vat_amount, cess_amount, total_tax,\n          service_charge, packaging_charge, delivery_charge, round_off, grand_total,\n          amount_in_words, payment_status, tax_breakup, hsn_summary,\n          notes, terms_conditions, generated_by\n        ) VALUES ('a8c017e5-12f9-4a50-b550-efc0e049d2af', 4, '202', 'INV/2526/000048', '2026-02-09', '18:27:25', NULL, 'Test Customer', '9876543210', NULL, NULL, NULL, NULL, 60, 0, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 60, 'Sixty Rupees Only', 'pending', '{\\\"TAX\\\":{\\\"rate\\\":2.5,\\\"taxableAmount\\\":120,\\\"taxAmount\\\":2.86}}', '{}', NULL, NULL, 7)","sqlState":"23000","sqlMessage":"Duplicate entry '4-INV/2526/000048' for key 'uk_invoice_number_outlet'"}
Error: Duplicate entry '4-INV/2526/000048' for key 'uk_invoice_number_outlet'
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:111:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:31:12 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:31:16 [ERROR]: Failed to create print job for invoice INV/2526/000049: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:183:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:31:16 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 18:31:17 [ERROR]: Failed to create print job for invoice INV/2526/000050: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:183:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:31:20 [ERROR]: Create order error: Table already has an active order (Order ID: 203). Use existing order or end session first.
Error: Table already has an active order (Order ID: 203). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:31:22 [ERROR]: Create order error: Table already has an active order (Order ID: 203). Use existing order or end session first.
Error: Table already has an active order (Order ID: 203). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:31:24 [ERROR]: Create order error: Table already has an active order (Order ID: 203). Use existing order or end session first.
Error: Table already has an active order (Order ID: 203). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:31:26 [ERROR]: Failed to create print job for invoice INV/2526/000051: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:183:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:32:02 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:170:27)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:37:06 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:38:17 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:41:59 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:42:02 [ERROR]: Failed to create print job for invoice INV/2526/000052: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:183:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:42:02 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 18:42:04 [ERROR]: Failed to create print job for invoice INV/2526/000053: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:183:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:42:06 [ERROR]: Create order error: Table already has an active order (Order ID: 206). Use existing order or end session first.
Error: Table already has an active order (Order ID: 206). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:42:09 [ERROR]: Create order error: Table already has an active order (Order ID: 206). Use existing order or end session first.
Error: Table already has an active order (Order ID: 206). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:42:11 [ERROR]: Create order error: Table already has an active order (Order ID: 206). Use existing order or end session first.
Error: Table already has an active order (Order ID: 206). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:42:12 [ERROR]: Failed to create print job for invoice INV/2526/000054: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:183:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:43:38 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:43:41 [ERROR]: Failed to create print job for invoice INV/2526/000055: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:43:41 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 18:43:43 [ERROR]: Failed to create print job for invoice INV/2526/000056: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:43:43 [ERROR]: Process payment error: Order not found
Error: Order not found
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:86:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:449:23)
2026-02-09 18:43:45 [ERROR]: Create order error: Table already has an active order (Order ID: 209). Use existing order or end session first.
Error: Table already has an active order (Order ID: 209). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:43:48 [ERROR]: Create order error: Table already has an active order (Order ID: 209). Use existing order or end session first.
Error: Table already has an active order (Order ID: 209). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:43:50 [ERROR]: Create order error: Table already has an active order (Order ID: 209). Use existing order or end session first.
Error: Table already has an active order (Order ID: 209). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:43:51 [ERROR]: Failed to create print job for invoice INV/2526/000057: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:43:51 [ERROR]: Process payment error: Order not found
Error: Order not found
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:86:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:449:23)
2026-02-09 18:46:35 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:46:38 [ERROR]: Failed to create print job for invoice INV/2526/000058: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:46:38 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 18:46:40 [ERROR]: Failed to create print job for invoice INV/2526/000059: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:46:40 [ERROR]: Process payment error: Order not found
Error: Order not found
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:86:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:449:23)
2026-02-09 18:46:42 [ERROR]: Create order error: Table already has an active order (Order ID: 212). Use existing order or end session first.
Error: Table already has an active order (Order ID: 212). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:46:44 [ERROR]: Create order error: Table already has an active order (Order ID: 212). Use existing order or end session first.
Error: Table already has an active order (Order ID: 212). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:46:47 [ERROR]: Failed to create print job for invoice INV/2526/000060: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:46:48 [ERROR]: Failed to create print job for invoice INV/2526/000061: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:46:52 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-09 18:46:56 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-09 18:47:02 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-09 18:48:32 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"Outlet ID is required for PIN login"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:48:35 [ERROR]: Failed to create print job for invoice INV/2526/000062: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:48:35 [ERROR]: Failed to print KOT reprint: Cannot find module './print.service'
Require stack:
- E:\restro-backend\src\services\kot.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
2026-02-09 18:48:37 [ERROR]: Failed to create print job for invoice INV/2526/000063: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:48:39 [ERROR]: Create order error: Table already has an active order (Order ID: 220). Use existing order or end session first.
Error: Table already has an active order (Order ID: 220). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:48:41 [ERROR]: Create order error: Table already has an active order (Order ID: 220). Use existing order or end session first.
Error: Table already has an active order (Order ID: 220). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:48:44 [ERROR]: Create order error: Table already has an active order (Order ID: 220). Use existing order or end session first.
Error: Table already has an active order (Order ID: 220). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-09 18:48:45 [ERROR]: Failed to create print job for invoice INV/2526/000064: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-09 18:53:45 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:53:56 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:54:00 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 18:54:22 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-09 19:03:41 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"pin","message":"PIN must be exactly 4 digits"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (E:\restro-backend\node_modules\express\lib\router\index.js:175:3)
    at router (E:\restro-backend\node_modules\express\lib\router\index.js:47:12)
2026-02-10 10:46:00 [ERROR]: Failed to create print job for invoice INV/2526/000065: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 10:46:43 [ERROR]: Failed to create print job for invoice INV/2526/000066: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:05:02 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:170:27)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-10 11:07:26 [ERROR]: Failed to create print job for invoice INV/2526/000067: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:07:26 [ERROR]: Failed to create print job for invoice INV/2526/000068: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:07:26 [ERROR]: Failed to create print job for invoice INV/2526/000069: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:07:26 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-10 11:07:26 [ERROR]: Create order error: Table already has an active order (Order ID: 227). Use existing order or end session first.
Error: Table already has an active order (Order ID: 227). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-10 11:09:19 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-10 11:09:19 [ERROR]: Create order error: Table already has an active order (Order ID: 227). Use existing order or end session first.
Error: Table already has an active order (Order ID: 227). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-10 11:09:57 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-10 11:09:57 [ERROR]: Create order error: Table already has an active order (Order ID: 227). Use existing order or end session first.
Error: Table already has an active order (Order ID: 227). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:140:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-10 11:11:27 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:522:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:516:22)
2026-02-10 11:11:27 [ERROR]: Failed to create print job for invoice INV/2526/000070: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:11:27 [ERROR]: Failed to create print job for invoice INV/2526/000071: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:11:27 [ERROR]: Failed to create print job for invoice INV/2526/000072: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:11:27 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:170:27)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-10 11:12:23 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:522:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:516:22)
2026-02-10 11:12:23 [ERROR]: Failed to create print job for invoice INV/2526/000073: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:12:23 [ERROR]: Failed to create print job for invoice INV/2526/000074: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:12:23 [ERROR]: Failed to create print job for invoice INV/2526/000075: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:12:24 [ERROR]: Failed to create print job for invoice INV/2526/000076: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:12:24 [ERROR]: Failed to create print job for invoice INV/2526/000077: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:12:24 [ERROR]: Cancel invoice error: Cannot cancel paid invoice
Error: Cannot cancel paid invoice
    at Object.cancelInvoice (E:\restro-backend\src\services\billing.service.js:513:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelInvoice (E:\restro-backend\src\controllers\order.controller.js:417:22)
2026-02-10 11:12:24 [ERROR]: Failed to create print job for invoice INV/2526/000078: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:12:24 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:558:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:531:22)
2026-02-10 11:12:24 [ERROR]: Generate bill error: Order already paid
Error: Order already paid
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:84:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:12:24 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:103:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:449:23)
2026-02-10 11:12:24 [ERROR]: Generate bill error: Order not found
Error: Order not found
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:79:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:29:57 [ERROR]: Failed to create print job for invoice INV/2526/000079: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:202:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:29:58 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"amount","message":"amount is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-10 11:32:02 [ERROR]: Failed to create print job for invoice INV/2526/000080: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:32:03 [ERROR]: Failed to create print job for invoice INV/2526/000081: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:32:03 [ERROR]: Failed to create print job for invoice INV/2526/000082: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:32:03 [ERROR]: Failed to create print job for invoice INV/2526/000083: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:32:03 [ERROR]: Failed to create print job for invoice INV/2526/000084: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:32:04 [ERROR]: Cancel invoice error: Cannot cancel paid invoice
Error: Cannot cancel paid invoice
    at Object.cancelInvoice (E:\restro-backend\src\services\billing.service.js:635:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelInvoice (E:\restro-backend\src\controllers\order.controller.js:417:22)
2026-02-10 11:32:04 [ERROR]: Failed to create print job for invoice INV/2526/000085: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 11:33:39 [ERROR]: Cancel item error: Manager approval required to cancel prepared items
Error: Manager approval required to cancel prepared items
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:690:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-10 11:33:59 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-10 11:39:35 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 11:44:25 [ERROR]: Could not close connections in time, forcefully shutting down
2026-02-10 12:36:16 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:434:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:272:19)
2026-02-10 12:39:25 [ERROR]: Failed to create print job for invoice INV/2526/000086: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 12:46:00 [ERROR]: Generate bill error: Order already paid
Error: Order already paid
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:205:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 14:26:13 [ERROR]: Failed to create print job for invoice INV/2526/000087: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 14:26:13 [ERROR]: Failed to create print job for invoice INV/2526/000088: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 14:26:13 [ERROR]: Failed to create print job for invoice INV/2526/000089: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 14:26:14 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:836:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 14:26:14 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:815:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 14:26:14 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:718:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:472:23)
2026-02-10 14:26:14 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 14:26:27 [ERROR]: Failed to create print job for invoice INV/2526/000090: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 14:26:27 [ERROR]: Failed to create print job for invoice INV/2526/000091: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 14:26:28 [ERROR]: Failed to create print job for invoice INV/2526/000092: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 14:26:28 [ERROR]: Failed to create print job for invoice INV/2526/000093: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 14:26:28 [ERROR]: Failed to create print job for invoice INV/2526/000094: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 14:26:28 [ERROR]: Cancel invoice error: Cannot cancel paid invoice
Error: Cannot cancel paid invoice
    at Object.cancelInvoice (E:\restro-backend\src\services\billing.service.js:635:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelInvoice (E:\restro-backend\src\controllers\order.controller.js:417:22)
2026-02-10 14:26:28 [ERROR]: Failed to create print job for invoice INV/2526/000095: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:324:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:01:57 [ERROR]: Failed to create print job for invoice INV/2526/000096: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:01:58 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 15:01:59 [ERROR]: Failed to create print job for invoice INV/2526/000097: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:01:59 [ERROR]: Failed to create print job for invoice INV/2526/000098: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:01:59 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:01:59 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:859:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:01:59 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:750:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:478:23)
2026-02-10 15:01:59 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 15:02:10 [ERROR]: Failed to create print job for invoice INV/2526/000099: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:02:11 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 15:02:11 [ERROR]: Failed to create print job for invoice INV/2526/000100: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:02:12 [ERROR]: Failed to create print job for invoice INV/2526/000101: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:02:12 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:02:12 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:859:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:02:12 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:750:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:478:23)
2026-02-10 15:02:12 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 15:02:29 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 15:03:12 [ERROR]: Failed to create print job for invoice INV/2526/000102: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:03:13 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 15:03:14 [ERROR]: Failed to create print job for invoice INV/2526/000103: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:03:14 [ERROR]: Failed to create print job for invoice INV/2526/000104: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:03:14 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:03:14 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:859:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:03:14 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:750:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:478:23)
2026-02-10 15:03:14 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 15:03:37 [ERROR]: Failed to create print job for invoice INV/2526/000105: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:03:38 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 15:03:38 [ERROR]: Failed to create print job for invoice INV/2526/000106: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:03:38 [ERROR]: Failed to create print job for invoice INV/2526/000107: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:03:38 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:03:38 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:859:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:03:38 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:750:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:478:23)
2026-02-10 15:03:39 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 15:03:52 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 15:05:18 [ERROR]: Failed to create print job for invoice INV/2526/000108: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:05:19 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 15:05:19 [ERROR]: Failed to create print job for invoice INV/2526/000109: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:05:19 [ERROR]: Failed to create print job for invoice INV/2526/000110: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:05:20 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:05:20 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:859:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:05:20 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:750:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:478:23)
2026-02-10 15:05:20 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 15:05:31 [ERROR]: Failed to create print job for invoice INV/2526/000111: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:05:33 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 15:05:33 [ERROR]: Failed to create print job for invoice INV/2526/000112: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:05:33 [ERROR]: Failed to create print job for invoice INV/2526/000113: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:05:33 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:05:33 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:859:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:05:33 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:750:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:478:23)
2026-02-10 15:05:34 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 15:05:48 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 15:06:29 [ERROR]: Failed to create print job for invoice INV/2526/000114: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:06:30 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 15:06:30 [ERROR]: Failed to create print job for invoice INV/2526/000115: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:06:31 [ERROR]: Failed to create print job for invoice INV/2526/000116: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 15:06:31 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:06:31 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:859:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 15:06:31 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:750:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:478:23)
2026-02-10 15:06:31 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 16:38:11 [ERROR]: Generate bill error: Order already paid
Error: Order already paid
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:207:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 16:38:24 [ERROR]: Failed to create print job for invoice INV/2526/000117: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:11:53 [ERROR]: Failed to create print job for invoice INV/2526/000118: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:13:14 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:170:27)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-10 17:14:29 [ERROR]: Failed to create print job for invoice INV/2526/000119: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:20:02 [ERROR]: Failed to create print job for invoice INV/2526/000120: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:23:06 [ERROR]: Failed to create print job for invoice INV/2526/000121: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:37:03 [ERROR]: Failed to create print job for invoice INV/2526/000122: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:37:03 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 17:37:03 [ERROR]: Failed to create print job for invoice INV/2526/000123: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:37:04 [ERROR]: Failed to create print job for invoice INV/2526/000124: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:37:04 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:901:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 17:37:04 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 17:37:04 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:771:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:480:23)
2026-02-10 17:37:04 [ERROR]: Failed to create print job for invoice INV/2526/000125: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:37:04 [ERROR]: Cancel order error: Cannot find module '../utils/redis'
Require stack:
- E:\restro-backend\src\services\order.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js {"code":"MODULE_NOT_FOUND","requireStack":["E:\\restro-backend\\src\\services\\order.service.js","E:\\restro-backend\\src\\controllers\\order.controller.js","E:\\restro-backend\\src\\routes\\order.routes.js","E:\\restro-backend\\src\\routes\\index.js","E:\\restro-backend\\src\\app.js"]}
Error: Cannot find module '../utils/redis'
Require stack:
- E:\restro-backend\src\services\order.service.js
- E:\restro-backend\src\controllers\order.controller.js
- E:\restro-backend\src\routes\order.routes.js
- E:\restro-backend\src\routes\index.js
- E:\restro-backend\src\app.js
    at Function._resolveFilename (node:internal/modules/cjs/loader:1225:15)
    at Function._load (node:internal/modules/cjs/loader:1055:27)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:220:24)
    at Module.require (node:internal/modules/cjs/loader:1311:12)
    at require (node:internal/modules/helpers:136:16)
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:951:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 17:38:14 [ERROR]: Failed to create print job for invoice INV/2526/000126: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:38:14 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 17:38:14 [ERROR]: Failed to create print job for invoice INV/2526/000127: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:38:15 [ERROR]: Failed to create print job for invoice INV/2526/000128: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:38:15 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:901:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 17:38:15 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 17:38:15 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:771:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:480:23)
2026-02-10 17:38:15 [ERROR]: Failed to create print job for invoice INV/2526/000129: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:38:16 [ERROR]: Failed to create print job for invoice INV/2526/000130: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:38:16 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 17:38:16 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 17:47:25 [ERROR]: Failed to create print job for invoice INV/2526/000131: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:47:25 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-10 17:47:25 [ERROR]: Failed to create print job for invoice INV/2526/000132: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:47:26 [ERROR]: Failed to create print job for invoice INV/2526/000133: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:47:26 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:901:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 17:47:26 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-10 17:47:26 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:771:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:480:23)
2026-02-10 17:47:26 [ERROR]: Failed to create print job for invoice INV/2526/000134: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:47:27 [ERROR]: Failed to create print job for invoice INV/2526/000135: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:47:27 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 17:47:27 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-10 17:49:57 [ERROR]: Failed to create print job for invoice INV/2526/000136: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:50:28 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-10 17:50:32 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-10 17:50:34 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-10 17:51:14 [ERROR]: Failed to create print job for invoice INV/2526/000137: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 17:52:00 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-10 17:58:10 [ERROR]: Failed to emit KOT update: Cannot read properties of null (reading 'station')
TypeError: Cannot read properties of null (reading 'station')
    at Object.emitKotUpdate (E:\restro-backend\src\services\kot.service.js:875:22)
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:784:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-10 18:17:21 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:434:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:272:19)
2026-02-10 18:18:17 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:434:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:272:19)
2026-02-10 18:20:56 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:434:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:272:19)
2026-02-10 18:22:16 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:434:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:272:19)
2026-02-10 18:25:34 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:434:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:272:19)
2026-02-10 18:25:44 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:434:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:272:19)
2026-02-10 18:26:13 [ERROR]: Cancel item error: Manager approval required to cancel prepared items
Error: Manager approval required to cancel prepared items
    at Object.cancelItem (E:\restro-backend\src\services\order.service.js:690:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelItem (E:\restro-backend\src\controllers\order.controller.js:102:21)
2026-02-10 18:48:41 [ERROR]: Failed to create print job for invoice INV/2526/000138: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-10 18:49:26 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"orderId","message":"orderId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-10 18:49:28 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"orderId","message":"orderId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-10 18:49:29 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"orderId","message":"orderId is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
    at authenticate (E:\restro-backend\src\middlewares\auth.middleware.js:38:7)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-10 18:50:31 [ERROR]: Failed to create print job for invoice INV/2526/000139: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 09:57:30 [ERROR]: Failed to start server: connect ETIMEDOUT {"errorno":"ETIMEDOUT","code":"ETIMEDOUT","syscall":"connect","fatal":true}
Error: connect ETIMEDOUT
    at PoolConnection._handleTimeoutError (E:\restro-backend\node_modules\mysql2\lib\base\connection.js:200:17)
    at listOnTimeout (node:internal/timers:594:17)
    at process.processTimers (node:internal/timers:529:7)
2026-02-11 11:00:30 [ERROR]: Failed to create print job for invoice INV/2526/000140: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:07:45 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:901:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:08:30 [ERROR]: Failed to create print job for invoice INV/2526/000141: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:08:48 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:880:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:13:36 [ERROR]: Failed to create print job for invoice INV/2526/000142: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:32:54 [ERROR]: Failed to create print job for invoice INV/2526/000143: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:32:54 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 11:32:54 [ERROR]: Failed to create print job for invoice INV/2526/000144: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:32:55 [ERROR]: Failed to create print job for invoice INV/2526/000145: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:32:55 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:912:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:32:55 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:891:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:32:55 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:782:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 11:32:56 [ERROR]: Failed to create print job for invoice INV/2526/000146: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:32:56 [ERROR]: Failed to create print job for invoice INV/2526/000147: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:32:56 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 11:33:16 [ERROR]: Failed to create print job for invoice INV/2526/000148: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:33:16 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 11:33:16 [ERROR]: Failed to create print job for invoice INV/2526/000149: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:33:16 [ERROR]: Failed to create print job for invoice INV/2526/000150: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:33:16 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:912:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:33:16 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:891:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:33:16 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:782:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 11:33:17 [ERROR]: Failed to create print job for invoice INV/2526/000151: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:33:18 [ERROR]: Failed to create print job for invoice INV/2526/000152: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:33:18 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 11:33:51 [ERROR]: Failed to create print job for invoice INV/2526/000153: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:34:47 [ERROR]: Failed to create print job for invoice INV/2526/000154: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:34:48 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 11:34:48 [ERROR]: Failed to create print job for invoice INV/2526/000155: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:34:48 [ERROR]: Failed to create print job for invoice INV/2526/000156: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:34:48 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:912:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:34:48 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:891:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:34:48 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:782:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 11:34:49 [ERROR]: Failed to create print job for invoice INV/2526/000157: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:34:49 [ERROR]: Failed to create print job for invoice INV/2526/000158: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:34:49 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 11:37:28 [ERROR]: Failed to create print job for invoice INV/2526/000159: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:38:14 [ERROR]: Failed to create print job for invoice INV/2526/000160: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:38:14 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 11:38:14 [ERROR]: Failed to create print job for invoice INV/2526/000161: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:38:15 [ERROR]: Failed to create print job for invoice INV/2526/000162: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:38:15 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:912:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:38:15 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:891:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:38:15 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:782:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 11:38:15 [ERROR]: Failed to create print job for invoice INV/2526/000163: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:38:16 [ERROR]: Failed to create print job for invoice INV/2526/000164: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:38:16 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 11:42:27 [ERROR]: Failed to create print job for invoice INV/2526/000165: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:42:27 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 11:42:27 [ERROR]: Failed to create print job for invoice INV/2526/000166: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:42:27 [ERROR]: Failed to create print job for invoice INV/2526/000167: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:42:28 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:912:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:42:28 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:891:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:42:28 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:782:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 11:42:28 [ERROR]: Failed to create print job for invoice INV/2526/000168: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:42:29 [ERROR]: Failed to create print job for invoice INV/2526/000169: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:42:29 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 11:42:29 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 11:44:39 [ERROR]: Failed to create print job for invoice INV/2526/000170: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:44:39 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 11:44:39 [ERROR]: Failed to create print job for invoice INV/2526/000171: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:44:40 [ERROR]: Failed to create print job for invoice INV/2526/000172: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:44:40 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:912:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:44:40 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:891:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 11:44:40 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:782:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 11:44:41 [ERROR]: Failed to create print job for invoice INV/2526/000173: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:44:41 [ERROR]: Failed to create print job for invoice INV/2526/000174: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 11:44:41 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 11:44:41 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 11:55:09 [ERROR]: Failed to create print job for invoice INV/2526/000175: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 12:06:23 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-11 12:15:50 [ERROR]: Get captain order detail error: You can only view your own orders
Error: You can only view your own orders
    at Object.getCaptainOrderDetail (E:\restro-backend\src\services\order.service.js:1200:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCaptainOrderDetail (E:\restro-backend\src\controllers\order.controller.js:788:21)
2026-02-11 12:25:20 [ERROR]: Failed to create print job for invoice INV/2526/000176: object is not iterable (cannot read property Symbol(Symbol.iterator))
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
    at Object.formatBillContent (E:\restro-backend\src\services\printer.service.js:503:32)
    at Object.printBill (E:\restro-backend\src\services\printer.service.js:612:26)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:326:30)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:350:23)
2026-02-11 12:26:42 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-11 12:27:13 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-11 12:30:49 [ERROR]: Direct bill print failed for INV/2526/000177:
2026-02-11 12:30:49 [ERROR]: Fallback print job also failed for INV/2526/000177:
2026-02-11 12:30:49 [ERROR]: Print duplicate bill error: Unknown column 'o.address' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT o.name as outlet_name, o.address as outlet_address, o.gstin as outlet_gstin\n       FROM outlets o\n       JOIN invoices i ON i.outlet_id = o.id\n       WHERE i.id = '181'","sqlState":"42S22","sqlMessage":"Unknown column 'o.address' in 'field list'"}
Error: Unknown column 'o.address' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.printDuplicateBill (E:\restro-backend\src\services\billing.service.js:593:37)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async printDuplicateBill (E:\restro-backend\src\controllers\order.controller.js:389:23)
2026-02-11 12:30:49 [ERROR]: Print duplicate bill error: Unknown column 'o.address' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT o.name as outlet_name, o.address as outlet_address, o.gstin as outlet_gstin\n       FROM outlets o\n       JOIN invoices i ON i.outlet_id = o.id\n       WHERE i.id = '181'","sqlState":"42S22","sqlMessage":"Unknown column 'o.address' in 'field list'"}
Error: Unknown column 'o.address' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.printDuplicateBill (E:\restro-backend\src\services\billing.service.js:593:37)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async printDuplicateBill (E:\restro-backend\src\controllers\order.controller.js:389:23)
2026-02-11 12:30:49 [ERROR]: Print duplicate bill error: Unknown column 'o.address' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT o.name as outlet_name, o.address as outlet_address, o.gstin as outlet_gstin\n       FROM outlets o\n       JOIN invoices i ON i.outlet_id = o.id\n       WHERE i.id = '181'","sqlState":"42S22","sqlMessage":"Unknown column 'o.address' in 'field list'"}
Error: Unknown column 'o.address' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.printDuplicateBill (E:\restro-backend\src\services\billing.service.js:593:37)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async printDuplicateBill (E:\restro-backend\src\controllers\order.controller.js:389:23)
2026-02-11 12:30:49 [ERROR]: Print duplicate bill error: Unknown column 'o.address' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT o.name as outlet_name, o.address as outlet_address, o.gstin as outlet_gstin\n       FROM outlets o\n       JOIN invoices i ON i.outlet_id = o.id\n       WHERE i.id = '181'","sqlState":"42S22","sqlMessage":"Unknown column 'o.address' in 'field list'"}
Error: Unknown column 'o.address' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.printDuplicateBill (E:\restro-backend\src\services\billing.service.js:593:37)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async printDuplicateBill (E:\restro-backend\src\controllers\order.controller.js:389:23)
2026-02-11 12:33:37 [ERROR]: Direct bill print failed for INV/2526/000178:
2026-02-11 12:33:37 [ERROR]: Fallback print job also failed for INV/2526/000178:
2026-02-11 12:33:37 [ERROR]: Direct duplicate bill print failed for INV/2526/000178:
2026-02-11 12:33:37 [ERROR]: Fallback print job also failed for duplicate INV/2526/000178:
2026-02-11 12:33:37 [ERROR]: Direct duplicate bill print failed for INV/2526/000178:
2026-02-11 12:33:37 [ERROR]: Fallback print job also failed for duplicate INV/2526/000178:
2026-02-11 12:33:37 [ERROR]: Direct duplicate bill print failed for INV/2526/000178:
2026-02-11 12:33:37 [ERROR]: Fallback print job also failed for duplicate INV/2526/000178:
2026-02-11 12:33:37 [ERROR]: Direct duplicate bill print failed for INV/2526/000178:
2026-02-11 12:33:37 [ERROR]: Fallback print job also failed for duplicate INV/2526/000178:
2026-02-11 12:33:50 [ERROR]: Direct bill print failed for INV/2526/000179:
2026-02-11 12:33:50 [ERROR]: Fallback print job also failed for INV/2526/000179:
2026-02-11 12:33:50 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 12:33:50 [ERROR]: Direct bill print failed for INV/2526/000180:
2026-02-11 12:33:50 [ERROR]: Fallback print job also failed for INV/2526/000180:
2026-02-11 12:33:50 [ERROR]: Direct bill print failed for INV/2526/000181:
2026-02-11 12:33:50 [ERROR]: Fallback print job also failed for INV/2526/000181:
2026-02-11 12:33:51 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1026:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 12:33:51 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1005:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 12:33:51 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:896:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 12:33:51 [ERROR]: Direct bill print failed for INV/2526/000182:
2026-02-11 12:33:51 [ERROR]: Fallback print job also failed for INV/2526/000182:
2026-02-11 12:33:52 [ERROR]: Direct bill print failed for INV/2526/000183:
2026-02-11 12:33:52 [ERROR]: Fallback print job also failed for INV/2526/000183:
2026-02-11 12:33:52 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 12:33:52 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 12:34:17 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-11 12:34:46 [ERROR]: Direct bill print failed for INV/2526/000184:
2026-02-11 12:34:46 [ERROR]: Fallback print job also failed for INV/2526/000184:
2026-02-11 12:48:03 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:622:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:582:22)
2026-02-11 12:48:16 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:586:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:567:22)
2026-02-11 12:52:07 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:586:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:567:22)
2026-02-11 12:55:18 [ERROR]: Direct bill print failed for INV/2526/000185:
2026-02-11 12:55:18 [ERROR]: Bill print failed for INV/2526/000185:
2026-02-11 12:55:18 [ERROR]: Direct bill print failed for INV/2526/000185:
2026-02-11 12:55:18 [ERROR]: Duplicate bill #1 print failed for INV/2526/000185:
2026-02-11 12:55:18 [ERROR]: Direct bill print failed for INV/2526/000185:
2026-02-11 12:55:18 [ERROR]: Duplicate bill #2 print failed for INV/2526/000185:
2026-02-11 12:55:18 [ERROR]: Direct bill print failed for INV/2526/000185:
2026-02-11 12:55:18 [ERROR]: Duplicate bill #3 print failed for INV/2526/000185:
2026-02-11 12:55:18 [ERROR]: Direct bill print failed for INV/2526/000185:
2026-02-11 12:55:18 [ERROR]: Duplicate bill #4 print failed for INV/2526/000185:
2026-02-11 13:02:19 [ERROR]: Direct bill print failed for INV/2526/000186:
2026-02-11 13:02:19 [ERROR]: Bill print failed for INV/2526/000186:
2026-02-11 13:02:19 [ERROR]: Direct bill print failed for INV/2526/000187:
2026-02-11 13:02:19 [ERROR]: Bill print failed for INV/2526/000187:
2026-02-11 13:02:19 [ERROR]: Direct bill print failed for INV/2526/000188:
2026-02-11 13:02:19 [ERROR]: Bill print failed for INV/2526/000188:
2026-02-11 13:03:39 [ERROR]: Direct bill print failed for INV/2526/000189:
2026-02-11 13:03:39 [ERROR]: Bill print failed for INV/2526/000189:
2026-02-11 13:03:39 [ERROR]: Direct bill print failed for INV/2526/000190:
2026-02-11 13:03:39 [ERROR]: Bill print failed for INV/2526/000190:
2026-02-11 13:03:39 [ERROR]: Direct bill print failed for INV/2526/000191:
2026-02-11 13:03:39 [ERROR]: Bill print failed for INV/2526/000191:
2026-02-11 13:03:51 [ERROR]: Direct bill print failed for INV/2526/000192:
2026-02-11 13:03:51 [ERROR]: Bill print failed for INV/2526/000192:
2026-02-11 13:03:52 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 13:03:52 [ERROR]: Direct bill print failed for INV/2526/000193:
2026-02-11 13:03:52 [ERROR]: Bill print failed for INV/2526/000193:
2026-02-11 13:03:52 [ERROR]: Direct bill print failed for INV/2526/000194:
2026-02-11 13:03:52 [ERROR]: Bill print failed for INV/2526/000194:
2026-02-11 13:03:52 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1000:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 13:03:52 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:979:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 13:03:52 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:870:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 13:03:53 [ERROR]: Direct bill print failed for INV/2526/000195:
2026-02-11 13:03:53 [ERROR]: Bill print failed for INV/2526/000195:
2026-02-11 13:03:53 [ERROR]: Direct bill print failed for INV/2526/000196:
2026-02-11 13:03:53 [ERROR]: Bill print failed for INV/2526/000196:
2026-02-11 13:03:53 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 13:03:53 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 13:05:04 [ERROR]: Direct bill print failed for INV/2526/000197:
2026-02-11 13:05:04 [ERROR]: Bill print failed for INV/2526/000197:
2026-02-11 13:05:05 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:434:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:272:19)
2026-02-11 13:17:52 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 13:17:53 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1004:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 13:17:53 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:983:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 13:17:53 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:874:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 13:17:55 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 13:17:55 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 13:41:44 [ERROR]: Add items error: Only the assigned captain can modify this order. Contact manager to transfer table.
Error: Only the assigned captain can modify this order. Contact manager to transfer table.
    at Object.addItems (E:\restro-backend\src\services\order.service.js:297:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-11 13:41:50 [ERROR]: Add items error: Only the assigned captain can modify this order. Contact manager to transfer table.
Error: Only the assigned captain can modify this order. Contact manager to transfer table.
    at Object.addItems (E:\restro-backend\src\services\order.service.js:297:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-11 14:05:44 [ERROR]: Process payment error: order is not defined
ReferenceError: order is not defined
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:277:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:500:23)
2026-02-11 14:07:07 [ERROR]: Process payment error: order is not defined
ReferenceError: order is not defined
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:277:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:500:23)
2026-02-11 14:07:07 [ERROR]: Process payment error: order is not defined
ReferenceError: order is not defined
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:277:18)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:500:23)
2026-02-11 14:09:09 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 14:09:10 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1099:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 14:09:10 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1078:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 14:09:10 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:965:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 14:09:12 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 14:09:12 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 14:24:13 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:582:22)
2026-02-11 14:24:27 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:567:22)
2026-02-11 14:24:41 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:582:22)
2026-02-11 14:30:06 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:582:22)
2026-02-11 14:30:22 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:567:22)
2026-02-11 14:30:33 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:582:22)
2026-02-11 14:31:36 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:567:22)
2026-02-11 14:34:15 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:567:22)
2026-02-11 14:36:59 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:582:22)
2026-02-11 15:12:14 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-11 15:42:21 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"customerGstin","message":"customerGstin is required"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-11 15:42:22 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1119:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 15:42:22 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1098:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:445:21)
2026-02-11 15:42:22 [ERROR]: Update invoice charges error: Cannot modify paid invoice
Error: Cannot modify paid invoice
    at Object.updateInvoiceCharges (E:\restro-backend\src\services\billing.service.js:985:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async updateInvoiceCharges (E:\restro-backend\src\controllers\order.controller.js:481:23)
2026-02-11 15:42:24 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 15:42:24 [ERROR]: Cancel order error: Order cannot be cancelled
Error: Order cannot be cancelled
    at Object.cancelOrder (E:\restro-backend\src\services\order.service.js:857:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async cancelOrder (E:\restro-backend\src\controllers\order.controller.js:116:21)
2026-02-11 15:46:08 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:582:22)
2026-02-11 15:46:36 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:567:22)
2026-02-11 15:46:53 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:582:22)
2026-02-11 15:57:08 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:582:22)
2026-02-11 16:03:48 [ERROR]: Add items error: Only the assigned captain can modify this order. Contact manager to transfer table.
Error: Only the assigned captain can modify this order. Contact manager to transfer table.
    at Object.addItems (E:\restro-backend\src\services\order.service.js:297:17)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:74:22)
2026-02-11 16:19:28 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 16:19:37 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:570:22)
2026-02-11 16:21:56 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:570:22)
2026-02-11 16:22:05 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 16:26:47 [ERROR]: Open cash drawer error: Duplicate entry '4-2026-02-11' for key 'uk_day_session' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO day_sessions (\n        outlet_id, session_date, opening_time, opening_cash, status, opened_by\n      ) VALUES ('4', '2026-02-11', NOW(), 500, 'open', 1)","sqlState":"23000","sqlMessage":"Duplicate entry '4-2026-02-11' for key 'uk_day_session'"}
Error: Duplicate entry '4-2026-02-11' for key 'uk_day_session'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:596:16)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:570:22)
2026-02-11 16:26:47 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 16:26:47 [ERROR]: Open cash drawer error: Duplicate entry '4-2026-02-11' for key 'uk_day_session' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO day_sessions (\n        outlet_id, session_date, opening_time, opening_cash, status, opened_by\n      ) VALUES ('4', '2026-02-11', NOW(), 1000, 'open', 1)","sqlState":"23000","sqlMessage":"Duplicate entry '4-2026-02-11' for key 'uk_day_session'"}
Error: Duplicate entry '4-2026-02-11' for key 'uk_day_session'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:596:16)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:570:22)
2026-02-11 16:26:47 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:629:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 16:28:25 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:570:22)
2026-02-11 16:29:20 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 16:39:49 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 16:57:18 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:10:55 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:570:22)
2026-02-11 17:20:14 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:24:13 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:24:30 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:26:51 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:27:05 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:31:24 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:36:04 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:37:04 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:39:38 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:40:03 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:42:28 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:170:27)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:21:21)
2026-02-11 17:45:52 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:46:17 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-11 17:46:56 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-11 17:55:08 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:570:22)
2026-02-11 17:55:37 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:570:22)
2026-02-11 17:55:51 [ERROR]: Open cash drawer error: Day session already open
Error: Day session already open
    at Object.openCashDrawer (E:\restro-backend\src\services\payment.service.js:593:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async openCashDrawer (E:\restro-backend\src\controllers\order.controller.js:570:22)
2026-02-11 17:56:41 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 17:58:49 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-11 18:25:48 [ERROR]: Close cash drawer error: No open session found
Error: No open session found
    at Object.closeCashDrawer (E:\restro-backend\src\services\payment.service.js:642:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async closeCashDrawer (E:\restro-backend\src\controllers\order.controller.js:585:22)
2026-02-12 10:06:34 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-12 10:10:51 [ERROR]: Socket error: EVIezMVWlVOzDoJHAAAB invalid payload
Error: invalid payload
    at Decoder.decodeString (E:\restro-backend\node_modules\socket.io-parser\build\cjs\index.js:235:23)
    at Decoder.add (E:\restro-backend\node_modules\socket.io-parser\build\cjs\index.js:138:27)
    at Client.ondata (E:\restro-backend\node_modules\socket.io\dist\client.js:185:26)
    at Socket.emit (node:events:518:28)
    at Socket.onPacket (E:\restro-backend\node_modules\engine.io\build\socket.js:117:22)
    at WebSocket.emit (node:events:518:28)
    at WebSocket.onPacket (E:\restro-backend\node_modules\engine.io\build\transport.js:96:14)
    at WebSocket.onData (E:\restro-backend\node_modules\engine.io\build\transport.js:105:14)
    at WebSocket.<anonymous> (E:\restro-backend\node_modules\engine.io\build\transports\websocket.js:40:19)
    at WebSocket.emit (node:events:518:28)
2026-02-12 10:21:20 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-12 10:21:35 [ERROR]: Download invoice PDF error: Table 'restro.companies' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT o.name, o.address, o.phone, o.email, o.gstin, o.logo_url,\n        c.name as company_name\n       FROM outlets o\n       LEFT JOIN companies c ON o.company_id = c.id\n       WHERE o.id = 4","sqlState":"42S02","sqlMessage":"Table 'restro.companies' doesn't exist"}
Error: Table 'restro.companies' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getOutletInfo (E:\restro-backend\src\services\billing.service.js:631:31)
    at Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:651:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 10:21:35 [ERROR]: Download invoice PDF error: Invoice not found
Error: Invoice not found
    at Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:649:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 10:21:35 [ERROR]: Download invoice PDF error: Table 'restro.companies' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT o.name, o.address, o.phone, o.email, o.gstin, o.logo_url,\n        c.name as company_name\n       FROM outlets o\n       LEFT JOIN companies c ON o.company_id = c.id\n       WHERE o.id = 4","sqlState":"42S02","sqlMessage":"Table 'restro.companies' doesn't exist"}
Error: Table 'restro.companies' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getOutletInfo (E:\restro-backend\src\services\billing.service.js:631:31)
    at Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:651:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 10:21:35 [ERROR]: Download invoice PDF error: Table 'restro.companies' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT o.name, o.address, o.phone, o.email, o.gstin, o.logo_url,\n        c.name as company_name\n       FROM outlets o\n       LEFT JOIN companies c ON o.company_id = c.id\n       WHERE o.id = 4","sqlState":"42S02","sqlMessage":"Table 'restro.companies' doesn't exist"}
Error: Table 'restro.companies' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getOutletInfo (E:\restro-backend\src\services\billing.service.js:631:31)
    at Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:651:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 10:21:35 [ERROR]: Print invoice error: Invoice not found
Error: Invoice not found
    at Object.printInvoice (E:\restro-backend\src\services\billing.service.js:667:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async printInvoice (E:\restro-backend\src\controllers\order.controller.js:421:23)
2026-02-12 10:22:44 [ERROR]: Download invoice PDF error: Unknown column 'address' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT name, address, phone, email, gstin, logo_url\n       FROM outlets WHERE id = 4","sqlState":"42S22","sqlMessage":"Unknown column 'address' in 'field list'"}
Error: Unknown column 'address' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getOutletInfo (E:\restro-backend\src\services\billing.service.js:631:31)
    at Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:648:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 10:22:44 [ERROR]: Download invoice PDF error: Invoice not found
Error: Invoice not found
    at Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:646:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 10:22:44 [ERROR]: Download invoice PDF error: Unknown column 'address' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT name, address, phone, email, gstin, logo_url\n       FROM outlets WHERE id = 4","sqlState":"42S22","sqlMessage":"Unknown column 'address' in 'field list'"}
Error: Unknown column 'address' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getOutletInfo (E:\restro-backend\src\services\billing.service.js:631:31)
    at Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:648:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 10:22:44 [ERROR]: Download invoice PDF error: Unknown column 'address' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT name, address, phone, email, gstin, logo_url\n       FROM outlets WHERE id = 4","sqlState":"42S22","sqlMessage":"Unknown column 'address' in 'field list'"}
Error: Unknown column 'address' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getOutletInfo (E:\restro-backend\src\services\billing.service.js:631:31)
    at Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:648:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 10:22:44 [ERROR]: Print invoice error: Invoice not found
Error: Invoice not found
    at Object.printInvoice (E:\restro-backend\src\services\billing.service.js:664:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async printInvoice (E:\restro-backend\src\controllers\order.controller.js:421:23)
2026-02-12 10:24:07 [ERROR]: Download invoice PDF error: Invoice not found
Error: Invoice not found
    at Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:647:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 10:24:07 [ERROR]: Print invoice error: Invoice not found
Error: Invoice not found
    at Object.printInvoice (E:\restro-backend\src\services\billing.service.js:665:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async printInvoice (E:\restro-backend\src\controllers\order.controller.js:421:23)
2026-02-12 10:26:44 [ERROR]: Print invoice error: Invoice not found
Error: Invoice not found
    at Object.printInvoice (E:\restro-backend\src\services\billing.service.js:665:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async printInvoice (E:\restro-backend\src\controllers\order.controller.js:421:23)
2026-02-12 10:33:22 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:454:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:290:19)
2026-02-12 10:36:40 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:158:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:546:22)
2026-02-12 10:37:00 [ERROR]: Print invoice error: Invoice not found
Error: Invoice not found
    at Object.resolveInvoice (E:\restro-backend\src\services\billing.service.js:648:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.printInvoice (E:\restro-backend\src\services\billing.service.js:675:21)
    at async printInvoice (E:\restro-backend\src\controllers\order.controller.js:421:23)
2026-02-12 10:37:00 [ERROR]: Download invoice PDF error: Invoice not found
Error: Invoice not found
    at Object.resolveInvoice (E:\restro-backend\src\services\billing.service.js:648:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:658:21)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 10:40:15 [ERROR]: Direct Bill print failed for INV/2526/000237:
2026-02-12 10:40:15 [ERROR]: Direct bill print failed for INV/2526/000237:
2026-02-12 11:08:24 [ERROR]: Download invoice PDF error: Invoice not found
Error: Invoice not found
    at Object.resolveInvoice (E:\restro-backend\src\services\billing.service.js:668:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:678:21)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:407:48)
2026-02-12 11:08:25 [ERROR]: Print invoice error: Invoice not found
Error: Invoice not found
    at Object.resolveInvoice (E:\restro-backend\src\services\billing.service.js:668:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.printInvoice (E:\restro-backend\src\services\billing.service.js:695:21)
    at async printInvoice (E:\restro-backend\src\controllers\order.controller.js:421:23)
2026-02-12 11:23:28 [ERROR]: Download invoice PDF error: Invoice not found
Error: Invoice not found
    at Object.resolveInvoice (E:\restro-backend\src\services\billing.service.js:674:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.generateInvoicePDF (E:\restro-backend\src\services\billing.service.js:684:21)
    at async downloadInvoicePDF (E:\restro-backend\src\controllers\order.controller.js:410:48)
2026-02-12 11:23:28 [ERROR]: Print invoice error: Invoice not found
Error: Invoice not found
    at Object.resolveInvoice (E:\restro-backend\src\services\billing.service.js:674:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.printInvoice (E:\restro-backend\src\services\billing.service.js:701:21)
    at async printInvoice (E:\restro-backend\src\controllers\order.controller.js:424:23)
2026-02-12 11:55:03 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"password","message":"Password must contain at least one uppercase, one lowercase, and one number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-12 12:09:15 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:275:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:92:22)
2026-02-12 12:27:45 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"appliedOn","message":"appliedOn must be one of [subtotal, item]"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:421:3)
    at next (E:\restro-backend\node_modules\express\lib\router\index.js:280:10)
2026-02-12 12:40:05 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1218:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:506:22)
2026-02-12 12:40:05 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1218:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:506:22)
2026-02-12 12:40:05 [ERROR]: Apply discount error: Percentage discount cannot exceed 100%
Error: Percentage discount cannot exceed 100%
    at Object.applyDiscount (E:\restro-backend\src\services\billing.service.js:1364:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscount (E:\restro-backend\src\controllers\order.controller.js:488:22)
2026-02-12 12:40:05 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1197:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:506:22)
2026-02-12 12:40:05 [ERROR]: Remove discount error: Discount not found on this order
Error: Discount not found on this order
    at Object.removeDiscount (E:\restro-backend\src\services\billing.service.js:1449:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async removeDiscount (E:\restro-backend\src\controllers\order.controller.js:525:22)
2026-02-12 12:40:05 [ERROR]: Get order discounts error: Order not found
Error: Order not found
    at Object.getOrderDiscounts (E:\restro-backend\src\services\billing.service.js:1301:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getOrderDiscounts (E:\restro-backend\src\controllers\order.controller.js:477:22)
2026-02-12 12:40:05 [ERROR]: Apply discount by code error: Minimum order amount of 1000.00 required
Error: Minimum order amount of 1000.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1218:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:506:22)
2026-02-12 12:41:47 [ERROR]: Apply discount by code error: Minimum order amount of 500.00 required
Error: Minimum order amount of 500.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1218:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:506:22)
2026-02-12 12:41:47 [ERROR]: Apply discount error: Percentage discount cannot exceed 100%
Error: Percentage discount cannot exceed 100%
    at Object.applyDiscount (E:\restro-backend\src\services\billing.service.js:1364:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscount (E:\restro-backend\src\controllers\order.controller.js:488:22)
2026-02-12 12:41:47 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1197:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:506:22)
2026-02-12 12:41:47 [ERROR]: Remove discount error: Discount not found on this order
Error: Discount not found on this order
    at Object.removeDiscount (E:\restro-backend\src\services\billing.service.js:1449:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async removeDiscount (E:\restro-backend\src\controllers\order.controller.js:525:22)
2026-02-12 12:41:47 [ERROR]: Get order discounts error: Order not found
Error: Order not found
    at Object.getOrderDiscounts (E:\restro-backend\src\services\billing.service.js:1301:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getOrderDiscounts (E:\restro-backend\src\controllers\order.controller.js:477:22)
2026-02-12 12:41:47 [ERROR]: Apply discount by code error: Minimum order amount of 1000.00 required
Error: Minimum order amount of 1000.00 required
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1218:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:506:22)
2026-02-12 13:02:36 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId must be a number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-12 13:06:59 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId must be a number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-12 13:10:19 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId must be a number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-12 13:15:10 [ERROR]: Unhandled error: Validation failed {"statusCode":422,"isOperational":true,"status":"fail","errors":[{"field":"outletId","message":"outletId must be a number"}]}
Error: Validation failed
    at E:\restro-backend\src\middlewares\validate.js:24:19
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (E:\restro-backend\node_modules\express\lib\router\index.js:346:12)
2026-02-12 13:21:29 [ERROR]: Could not close connections in time, forcefully shutting down
2026-02-12 13:32:59 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1197:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:506:22)
2026-02-12 13:40:52 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1197:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:506:22)
2026-02-12 13:53:40 [ERROR]: Apply discount error: Discount exceeds order total. Maximum additional discount allowed: 0.00
Error: Discount exceeds order total. Maximum additional discount allowed: 0.00
    at Object.applyDiscount (E:\restro-backend\src\services\billing.service.js:1392:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscount (E:\restro-backend\src\controllers\order.controller.js:488:22)
2026-02-12 13:53:40 [ERROR]: Apply discount error: Discount exceeds order total. Maximum additional discount allowed: 0.00
Error: Discount exceeds order total. Maximum additional discount allowed: 0.00
    at Object.applyDiscount (E:\restro-backend\src\services\billing.service.js:1392:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscount (E:\restro-backend\src\controllers\order.controller.js:488:22)
2026-02-12 13:54:56 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:159:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:584:22)
2026-02-12 13:54:57 [ERROR]: Apply discount error: Discount exceeds order total. Maximum additional discount allowed: 0.00
Error: Discount exceeds order total. Maximum additional discount allowed: 0.00
    at Object.applyDiscount (E:\restro-backend\src\services\billing.service.js:1392:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscount (E:\restro-backend\src\controllers\order.controller.js:488:22)
2026-02-12 13:54:57 [ERROR]: Apply discount error: Discount exceeds order total. Maximum additional discount allowed: 0.00
Error: Discount exceeds order total. Maximum additional discount allowed: 0.00
    at Object.applyDiscount (E:\restro-backend\src\services\billing.service.js:1392:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscount (E:\restro-backend\src\controllers\order.controller.js:488:22)
2026-02-12 13:54:57 [ERROR]: Process payment error: Order not found
Error: Order not found
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:148:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:584:22)
2026-02-12 13:54:57 [ERROR]: Process payment error: Order not found
Error: Order not found
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:148:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:584:22)
2026-02-12 14:24:14 [ERROR]: Get takeaway order detail error: Unknown column 'i.hsn_code' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT oi.*,\n        i.short_name, i.image_url, i.hsn_code,\n        ks.name as station_name, ks.station_type,\n        c.name as counter_name,\n        u_cancel.name as cancelled_by_name\n       FROM order_items oi\n       LEFT JOIN items i ON oi.item_id = i.id\n       LEFT JOIN kitchen_stations ks ON i.kitchen_station_id = ks.id\n       LEFT JOIN counters c ON i.counter_id = c.id\n       LEFT JOIN users u_cancel ON oi.cancelled_by = u_cancel.id\n       WHERE oi.order_id = '451'\n       ORDER BY oi.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'i.hsn_code' in 'field list'"}
Error: Unknown column 'i.hsn_code' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:662:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:24:14 [ERROR]: Get takeaway order detail error: Order not found
Error: Order not found
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:659:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:24:14 [ERROR]: Get takeaway order detail error: Unknown column 'i.hsn_code' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT oi.*,\n        i.short_name, i.image_url, i.hsn_code,\n        ks.name as station_name, ks.station_type,\n        c.name as counter_name,\n        u_cancel.name as cancelled_by_name\n       FROM order_items oi\n       LEFT JOIN items i ON oi.item_id = i.id\n       LEFT JOIN kitchen_stations ks ON i.kitchen_station_id = ks.id\n       LEFT JOIN counters c ON i.counter_id = c.id\n       LEFT JOIN users u_cancel ON oi.cancelled_by = u_cancel.id\n       WHERE oi.order_id = '451'\n       ORDER BY oi.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'i.hsn_code' in 'field list'"}
Error: Unknown column 'i.hsn_code' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:662:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:24:14 [ERROR]: Get takeaway order detail error: Unknown column 'i.hsn_code' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT oi.*,\n        i.short_name, i.image_url, i.hsn_code,\n        ks.name as station_name, ks.station_type,\n        c.name as counter_name,\n        u_cancel.name as cancelled_by_name\n       FROM order_items oi\n       LEFT JOIN items i ON oi.item_id = i.id\n       LEFT JOIN kitchen_stations ks ON i.kitchen_station_id = ks.id\n       LEFT JOIN counters c ON i.counter_id = c.id\n       LEFT JOIN users u_cancel ON oi.cancelled_by = u_cancel.id\n       WHERE oi.order_id = '442'\n       ORDER BY oi.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'i.hsn_code' in 'field list'"}
Error: Unknown column 'i.hsn_code' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:662:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:24:14 [ERROR]: Get takeaway order detail error: Unknown column 'i.hsn_code' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT oi.*,\n        i.short_name, i.image_url, i.hsn_code,\n        ks.name as station_name, ks.station_type,\n        c.name as counter_name,\n        u_cancel.name as cancelled_by_name\n       FROM order_items oi\n       LEFT JOIN items i ON oi.item_id = i.id\n       LEFT JOIN kitchen_stations ks ON i.kitchen_station_id = ks.id\n       LEFT JOIN counters c ON i.counter_id = c.id\n       LEFT JOIN users u_cancel ON oi.cancelled_by = u_cancel.id\n       WHERE oi.order_id = '440'\n       ORDER BY oi.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'i.hsn_code' in 'field list'"}
Error: Unknown column 'i.hsn_code' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:662:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:24:14 [ERROR]: Get takeaway order detail error: Unknown column 'i.hsn_code' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT oi.*,\n        i.short_name, i.image_url, i.hsn_code,\n        ks.name as station_name, ks.station_type,\n        c.name as counter_name,\n        u_cancel.name as cancelled_by_name\n       FROM order_items oi\n       LEFT JOIN items i ON oi.item_id = i.id\n       LEFT JOIN kitchen_stations ks ON i.kitchen_station_id = ks.id\n       LEFT JOIN counters c ON i.counter_id = c.id\n       LEFT JOIN users u_cancel ON oi.cancelled_by = u_cancel.id\n       WHERE oi.order_id = '439'\n       ORDER BY oi.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'i.hsn_code' in 'field list'"}
Error: Unknown column 'i.hsn_code' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:662:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:24:14 [ERROR]: Get takeaway order detail error: Unknown column 'i.hsn_code' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT oi.*,\n        i.short_name, i.image_url, i.hsn_code,\n        ks.name as station_name, ks.station_type,\n        c.name as counter_name,\n        u_cancel.name as cancelled_by_name\n       FROM order_items oi\n       LEFT JOIN items i ON oi.item_id = i.id\n       LEFT JOIN kitchen_stations ks ON i.kitchen_station_id = ks.id\n       LEFT JOIN counters c ON i.counter_id = c.id\n       LEFT JOIN users u_cancel ON oi.cancelled_by = u_cancel.id\n       WHERE oi.order_id = '438'\n       ORDER BY oi.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'i.hsn_code' in 'field list'"}
Error: Unknown column 'i.hsn_code' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:662:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:24:14 [ERROR]: Get takeaway order detail error: Unknown column 'i.hsn_code' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT oi.*,\n        i.short_name, i.image_url, i.hsn_code,\n        ks.name as station_name, ks.station_type,\n        c.name as counter_name,\n        u_cancel.name as cancelled_by_name\n       FROM order_items oi\n       LEFT JOIN items i ON oi.item_id = i.id\n       LEFT JOIN kitchen_stations ks ON i.kitchen_station_id = ks.id\n       LEFT JOIN counters c ON i.counter_id = c.id\n       LEFT JOIN users u_cancel ON oi.cancelled_by = u_cancel.id\n       WHERE oi.order_id = '442'\n       ORDER BY oi.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'i.hsn_code' in 'field list'"}
Error: Unknown column 'i.hsn_code' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:662:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:25:59 [ERROR]: Get takeaway order detail error: Unknown column 'od.applied_by' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT od.*, u.name as applied_by_name\n       FROM order_discounts od\n       LEFT JOIN users u ON od.applied_by = u.id\n       WHERE od.order_id = '451'\n       ORDER BY od.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'od.applied_by' in 'on clause'"}
Error: Unknown column 'od.applied_by' in 'on clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:787:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:25:59 [ERROR]: Get takeaway order detail error: Order not found
Error: Order not found
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:659:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:25:59 [ERROR]: Get takeaway order detail error: Unknown column 'od.applied_by' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT od.*, u.name as applied_by_name\n       FROM order_discounts od\n       LEFT JOIN users u ON od.applied_by = u.id\n       WHERE od.order_id = '451'\n       ORDER BY od.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'od.applied_by' in 'on clause'"}
Error: Unknown column 'od.applied_by' in 'on clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:787:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:25:59 [ERROR]: Get takeaway order detail error: Unknown column 'od.applied_by' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT od.*, u.name as applied_by_name\n       FROM order_discounts od\n       LEFT JOIN users u ON od.applied_by = u.id\n       WHERE od.order_id = '442'\n       ORDER BY od.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'od.applied_by' in 'on clause'"}
Error: Unknown column 'od.applied_by' in 'on clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:787:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:25:59 [ERROR]: Get takeaway order detail error: Unknown column 'od.applied_by' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT od.*, u.name as applied_by_name\n       FROM order_discounts od\n       LEFT JOIN users u ON od.applied_by = u.id\n       WHERE od.order_id = '440'\n       ORDER BY od.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'od.applied_by' in 'on clause'"}
Error: Unknown column 'od.applied_by' in 'on clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:787:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:26:00 [ERROR]: Get takeaway order detail error: Unknown column 'od.applied_by' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT od.*, u.name as applied_by_name\n       FROM order_discounts od\n       LEFT JOIN users u ON od.applied_by = u.id\n       WHERE od.order_id = '439'\n       ORDER BY od.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'od.applied_by' in 'on clause'"}
Error: Unknown column 'od.applied_by' in 'on clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:787:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:26:00 [ERROR]: Get takeaway order detail error: Unknown column 'od.applied_by' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT od.*, u.name as applied_by_name\n       FROM order_discounts od\n       LEFT JOIN users u ON od.applied_by = u.id\n       WHERE od.order_id = '438'\n       ORDER BY od.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'od.applied_by' in 'on clause'"}
Error: Unknown column 'od.applied_by' in 'on clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:787:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:26:00 [ERROR]: Get takeaway order detail error: Unknown column 'od.applied_by' in 'on clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT od.*, u.name as applied_by_name\n       FROM order_discounts od\n       LEFT JOIN users u ON od.applied_by = u.id\n       WHERE od.order_id = '442'\n       ORDER BY od.created_at","sqlState":"42S22","sqlMessage":"Unknown column 'od.applied_by' in 'on clause'"}
Error: Unknown column 'od.applied_by' in 'on clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:787:36)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 14:26:42 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:153:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:203:22)
2026-02-12 14:28:04 [ERROR]: Get takeaway order detail error: Order not found
Error: Order not found
    at Object.getTakeawayOrderDetail (E:\restro-backend\src\services\order.service.js:659:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getTakeawayOrderDetail (E:\restro-backend\src\controllers\order.controller.js:82:22)
2026-02-12 15:48:54 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:159:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:595:22)
2026-02-12 16:01:02 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-12 16:01:02 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:855:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-12 16:14:18 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:159:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:595:22)
2026-02-12 16:29:27 [ERROR]: Get daily sales detail error: Unknown column 'oia.addon_price' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT oia.order_item_id, oia.addon_name, oia.addon_price, oia.quantity\n         FROM order_item_addons oia\n         WHERE oia.order_item_id IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 145, 146, 147, 135, 136, 137, 138, 148, 149, 150, 156, 157, 152, 153, 154, 158, 159, 160, 161, 162, 166, 167, 183, 184, 185, 186, 187, 214, 221, 222, 223, 224, 163, 164, 165, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 215, 216, 217, 218, 219, 220, 234, 235, 225, 226, 227, 228, 229, 230, 231, 232, 233, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 289, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 263, 258, 259, 260, 261, 262, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 290, 291, 292, 296, 297, 293, 294, 295, 298, 299, 300, 301, 306, 302, 303, 304, 305, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 326, 327, 322, 323, 324, 325, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 384, 377, 378, 379, 380, 381, 382, 383, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 766, 760, 761, 762, 763, 764, 765, 768, 767, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015, 1021, 1016, 1017, 1018, 1019, 1020, 1022, 1023, 1024, 1025, 1026, 1027, 1028, 1030, 1031, 1032, 1033, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044, 1047, 1045, 1046, 1048, 1049, 1050)","sqlState":"42S22","sqlMessage":"Unknown column 'oia.addon_price' in 'field list'"}
Error: Unknown column 'oia.addon_price' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:867:35)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:757:22)
2026-02-12 16:29:28 [ERROR]: Get daily sales detail error: Unknown column 'oia.addon_price' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT oia.order_item_id, oia.addon_name, oia.addon_price, oia.quantity\n         FROM order_item_addons oia\n         WHERE oia.order_item_id IN (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 145, 146, 147, 135, 136, 137, 138, 148, 149, 150, 156, 157, 152, 153, 154, 158, 159, 160, 161, 162, 166, 167, 183, 184, 185, 186, 187, 214, 221, 222, 223, 224, 163, 164, 165, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 215, 216, 217, 218, 219, 220, 234, 235, 225, 226, 227, 228, 229, 230, 231, 232, 233, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 289, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 263, 258, 259, 260, 261, 262, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 290, 291, 292, 296, 297, 293, 294, 295, 298, 299, 300, 301, 306, 302, 303, 304, 305, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 326, 327, 322, 323, 324, 325, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 384, 377, 378, 379, 380, 381, 382, 383, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 766, 760, 761, 762, 763, 764, 765, 768, 767, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015, 1021, 1016, 1017, 1018, 1019, 1020, 1022, 1023, 1024, 1025, 1026, 1027, 1028, 1030, 1031, 1032, 1033, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044, 1047, 1045, 1046, 1048, 1049, 1050)","sqlState":"42S22","sqlMessage":"Unknown column 'oia.addon_price' in 'field list'"}
Error: Unknown column 'oia.addon_price' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:867:35)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:757:22)
2026-02-12 16:48:34 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:159:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:595:22)
2026-02-12 16:48:39 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:159:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:595:22)
2026-02-12 17:14:01 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:276:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:103:22)
2026-02-12 17:14:06 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:276:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:103:22)
2026-02-12 17:36:06 [ERROR]: Apply discount error: Percentage discount cannot exceed 100%
Error: Percentage discount cannot exceed 100%
    at Object.applyDiscount (E:\restro-backend\src\services\billing.service.js:1365:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscount (E:\restro-backend\src\controllers\order.controller.js:499:22)
2026-02-12 17:36:21 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1198:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:517:22)
2026-02-12 17:36:25 [ERROR]: Apply discount by code error: Invalid discount code
Error: Invalid discount code
    at Object.applyDiscountByCode (E:\restro-backend\src\services\billing.service.js:1198:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async applyDiscountByCode (E:\restro-backend\src\controllers\order.controller.js:517:22)
2026-02-12 18:48:07 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:159:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:595:22)
2026-02-12 19:06:57 [ERROR]: Unhandled error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:858:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async startSession (E:\restro-backend\src\controllers\table.controller.js:141:22)
2026-02-13 11:12:13 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:159:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:595:22)
2026-02-13 12:01:00 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:159:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:595:22)
2026-02-13 12:01:02 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:159:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:595:22)
2026-02-13 13:08:45 [ERROR]: Get daily sales detail error: Unknown column 'NaN' in 'where clause' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"SELECT COUNT(*) as total FROM orders o\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON o.floor_id = f.id\n       LEFT JOIN users u_captain ON o.created_by = u_captain.id\n       LEFT JOIN users u_biller ON o.billed_by = u_biller.id\n       LEFT JOIN users u_cancel ON o.cancelled_by = u_cancel.id WHERE o.outlet_id = '4' AND DATE(o.created_at) BETWEEN '2026-02-01' AND '2026-02-12' AND t.table_number = NaN","sqlState":"42S22","sqlMessage":"Unknown column 'NaN' in 'where clause'"}
Error: Unknown column 'NaN' in 'where clause'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:869:38)
    at getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:760:43)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-13 16:19:31 [ERROR]: Get daily sales detail error: (options.status || "").trim is not a function
TypeError: (options.status || "").trim is not a function
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:866:43)
    at getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:769:43)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-13 16:19:46 [ERROR]: Get daily sales detail error: (options.status || "").trim is not a function
TypeError: (options.status || "").trim is not a function
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:866:43)
    at getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:769:43)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-13 16:21:15 [ERROR]: Get daily sales detail error: (options.status || "").trim is not a function
TypeError: (options.status || "").trim is not a function
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:866:43)
    at getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:769:43)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-13 16:21:16 [ERROR]: Get daily sales detail error: (options.status || "").trim is not a function
TypeError: (options.status || "").trim is not a function
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:866:43)
    at getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:769:43)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-13 16:21:17 [ERROR]: Get daily sales detail error: (options.status || "").trim is not a function
TypeError: (options.status || "").trim is not a function
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:866:43)
    at getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:769:43)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-13 16:21:40 [ERROR]: Get daily sales detail error: (options.status || "").trim is not a function
TypeError: (options.status || "").trim is not a function
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:866:43)
    at getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:769:43)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-13 16:21:49 [ERROR]: Get daily sales detail error: (options.status || "").trim is not a function
TypeError: (options.status || "").trim is not a function
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:866:43)
    at getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:769:43)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-13 16:21:54 [ERROR]: Get daily sales detail error: (options.status || "").trim is not a function
TypeError: (options.status || "").trim is not a function
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:866:43)
    at getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:769:43)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-13 16:22:58 [ERROR]: Get daily sales detail error: (options.status || "").trim is not a function
TypeError: (options.status || "").trim is not a function
    at Object.getDailySalesDetail (E:\restro-backend\src\services\reports.service.js:866:43)
    at getDailySalesDetail (E:\restro-backend\src\controllers\order.controller.js:769:43)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-13 16:57:40 [ERROR]: Unhandled error: A floor with this name already exists in this outlet {"statusCode":409}
Error: A floor with this name already exists in this outlet
    at Object.create (E:\restro-backend\src\services\floor.service.js:32:21)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createFloor (E:\restro-backend\src\controllers\outlet.controller.js:93:21)
2026-02-13 16:57:40 [ERROR]: Unhandled error: A section with this name already exists on this floor {"statusCode":409}
Error: A section with this name already exists on this floor
    at Object.create (E:\restro-backend\src\services\section.service.js:37:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createSection (E:\restro-backend\src\controllers\outlet.controller.js:184:23)
2026-02-13 16:57:40 [ERROR]: Unhandled error: Floor not found or does not belong to this outlet {"statusCode":400}
Error: Floor not found or does not belong to this outlet
    at Object.create (E:\restro-backend\src\services\section.service.js:22:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createSection (E:\restro-backend\src\controllers\outlet.controller.js:184:23)
2026-02-13 16:57:40 [ERROR]: Unhandled error: Duplicate entry '4-T99' for key 'uk_table_outlet_number' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO tables (\n        outlet_id, floor_id, section_id, table_number, name,\n        capacity, min_capacity, shape, status, is_mergeable, is_splittable,\n        display_order, qr_code, is_active\n      ) VALUES (4, 4, 6, 'T99', 'Test Table', 4, 1, 'square', 'available', true, false, 0, NULL, true)","sqlState":"23000","sqlMessage":"Duplicate entry '4-T99' for key 'uk_table_outlet_number'"}
Error: Duplicate entry '4-T99' for key 'uk_table_outlet_number'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.create (E:\restro-backend\src\services\table.service.js:60:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createTable (E:\restro-backend\src\controllers\table.controller.js:28:21)
2026-02-13 16:57:40 [ERROR]: Unhandled error: Duplicate entry '4-T99' for key 'uk_table_outlet_number' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO tables (\n        outlet_id, floor_id, section_id, table_number, name,\n        capacity, min_capacity, shape, status, is_mergeable, is_splittable,\n        display_order, qr_code, is_active\n      ) VALUES (4, 4, 6, 'T99', NULL, 2, 1, 'square', 'available', true, false, 0, NULL, true)","sqlState":"23000","sqlMessage":"Duplicate entry '4-T99' for key 'uk_table_outlet_number'"}
Error: Duplicate entry '4-T99' for key 'uk_table_outlet_number'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.create (E:\restro-backend\src\services\table.service.js:60:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createTable (E:\restro-backend\src\controllers\table.controller.js:28:21)
2026-02-13 16:57:40 [ERROR]: Unhandled error: Section not found or does not belong to this floor {"statusCode":400}
Error: Section not found or does not belong to this floor
    at Object.create (E:\restro-backend\src\services\table.service.js:43:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createTable (E:\restro-backend\src\controllers\table.controller.js:28:21)
2026-02-13 16:57:40 [ERROR]: Unhandled error: Floor not found or does not belong to this outlet {"statusCode":400}
Error: Floor not found or does not belong to this outlet
    at Object.create (E:\restro-backend\src\services\table.service.js:29:21)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createTable (E:\restro-backend\src\controllers\table.controller.js:28:21)
2026-02-13 16:58:55 [ERROR]: Unhandled error: A floor with this name already exists in this outlet {"statusCode":409}
Error: A floor with this name already exists in this outlet
    at Object.create (E:\restro-backend\src\services\floor.service.js:32:21)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createFloor (E:\restro-backend\src\controllers\outlet.controller.js:93:21)
2026-02-13 16:58:55 [ERROR]: Unhandled error: A section with this name already exists on this floor {"statusCode":409}
Error: A section with this name already exists on this floor
    at Object.create (E:\restro-backend\src\services\section.service.js:37:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createSection (E:\restro-backend\src\controllers\outlet.controller.js:184:23)
2026-02-13 16:58:55 [ERROR]: Unhandled error: Floor not found or does not belong to this outlet {"statusCode":400}
Error: Floor not found or does not belong to this outlet
    at Object.create (E:\restro-backend\src\services\section.service.js:22:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createSection (E:\restro-backend\src\controllers\outlet.controller.js:184:23)
2026-02-13 16:58:55 [ERROR]: Unhandled error: A table with this number already exists in this outlet {"statusCode":409}
Error: A table with this number already exists in this outlet
    at Object.create (E:\restro-backend\src\services\table.service.js:55:21)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createTable (E:\restro-backend\src\controllers\table.controller.js:28:21)
2026-02-13 16:58:55 [ERROR]: Unhandled error: Section not found or does not belong to this floor {"statusCode":400}
Error: Section not found or does not belong to this floor
    at Object.create (E:\restro-backend\src\services\table.service.js:43:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createTable (E:\restro-backend\src\controllers\table.controller.js:28:21)
2026-02-13 16:58:55 [ERROR]: Unhandled error: Floor not found or does not belong to this outlet {"statusCode":400}
Error: Floor not found or does not belong to this outlet
    at Object.create (E:\restro-backend\src\services\table.service.js:29:21)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createTable (E:\restro-backend\src\controllers\table.controller.js:28:21)
2026-02-13 18:21:27 [ERROR]: Unhandled error: Duplicate entry '4-AC Section' for key 'uk_section_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO sections (outlet_id, name, code, section_type, description, color_code, display_order, is_active)\n       VALUES (4, 'AC Section', 'AC', 'ac', 'Air-conditioned dining area with a cool and comfortable ambiance.', '#3B82F6', 1, true)","sqlState":"23000","sqlMessage":"Duplicate entry '4-AC Section' for key 'uk_section_outlet_name'"}
Error: Duplicate entry '4-AC Section' for key 'uk_section_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.create (E:\restro-backend\src\services\section.service.js:43:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createSection (E:\restro-backend\src\controllers\outlet.controller.js:184:23)
2026-02-13 18:23:33 [ERROR]: Unhandled error: Duplicate entry '4-AC Section' for key 'uk_section_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO sections (outlet_id, name, code, section_type, description, color_code, display_order, is_active)\n       VALUES (4, 'AC Section', 'AC', 'ac', 'Air-conditioned dining area with a cool and comfortable ambiance.', '#3B82F6', 1, true)","sqlState":"23000","sqlMessage":"Duplicate entry '4-AC Section' for key 'uk_section_outlet_name'"}
Error: Duplicate entry '4-AC Section' for key 'uk_section_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.create (E:\restro-backend\src\services\section.service.js:43:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createSection (E:\restro-backend\src\controllers\outlet.controller.js:184:23)
2026-02-13 18:27:15 [ERROR]: Unhandled error: Duplicate entry '4-AC Section' for key 'uk_section_outlet_name' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO sections (outlet_id, name, code, section_type, description, color_code, display_order, is_active)\n       VALUES (4, 'AC Section', 'AC', 'ac', 'Air-conditioned dining area with a cool and comfortable ambiance.', '#3B82F6', 1, true)","sqlState":"23000","sqlMessage":"Duplicate entry '4-AC Section' for key 'uk_section_outlet_name'"}
Error: Duplicate entry '4-AC Section' for key 'uk_section_outlet_name'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.create (E:\restro-backend\src\services\section.service.js:43:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createSection (E:\restro-backend\src\controllers\outlet.controller.js:184:23)
2026-02-13 19:04:27 [ERROR]: Get pending bills error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at getUserFloorIds (E:\restro-backend\src\utils\helpers.js:146:29)
    at getPendingBills (E:\restro-backend\src\controllers\order.controller.js:558:30)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-13 19:04:51 [ERROR]: Get current user failed: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:293:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-13 19:04:51 [ERROR]: Unhandled error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at AuthService.getCurrentUser (E:\restro-backend\src\services\auth.service.js:293:32)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCurrentUser (E:\restro-backend\src\controllers\auth.controller.js:137:18)
2026-02-13 19:04:54 [ERROR]: Redis max retries reached
2026-02-13 19:04:54 [ERROR]: Redis max retries reached
2026-02-13 19:04:55 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:55 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:55 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:55 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:55 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:55 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:56 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:56 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:56 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:56 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:56 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:56 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:57 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:57 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:57 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:57 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:57 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:57 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:58 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:58 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:58 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:58 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:58 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:58 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:59 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:59 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:59 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:59 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:59 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:04:59 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:00 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:00 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:00 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:00 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:00 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:00 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:03 [ERROR]: Queue report error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:03 [ERROR]: Queue inventory error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:03 [ERROR]: Queue email error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:03 [ERROR]: Queue notification error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:03 [ERROR]: Queue whatsapp error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-13 19:05:03 [ERROR]: Queue print error: {"code":"ECONNREFUSED"}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-14 11:22:39 [ERROR]: Create order error: Table is currently occupied
Error: Table is currently occupied
    at Object.startSession (E:\restro-backend\src\services\table.service.js:898:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async Object.createOrder (E:\restro-backend\src\services\order.service.js:171:27)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:22:21)
2026-02-14 11:40:16 [ERROR]: Unhandled error: Primary table is not mergeable
Error: Primary table is not mergeable
    at Object.mergeTables (E:\restro-backend\src\services\table.service.js:1176:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async mergeTables (E:\restro-backend\src\controllers\table.controller.js:246:22)
2026-02-14 11:40:16 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:153:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:206:22)
2026-02-14 11:40:16 [ERROR]: Unhandled error: No merged tables found
Error: No merged tables found
    at Object.unmergeTables (E:\restro-backend\src\services\table.service.js:1269:38)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async unmergeTables (E:\restro-backend\src\controllers\table.controller.js:263:7)
2026-02-14 11:44:00 [ERROR]: Unhandled error: Primary table is not mergeable
Error: Primary table is not mergeable
    at Object.mergeTables (E:\restro-backend\src\services\table.service.js:1193:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async mergeTables (E:\restro-backend\src\controllers\table.controller.js:246:22)
2026-02-14 11:44:00 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:153:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:206:22)
2026-02-14 11:45:40 [ERROR]: Unhandled error: Primary table is not mergeable
Error: Primary table is not mergeable
    at Object.mergeTables (E:\restro-backend\src\services\table.service.js:1193:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async mergeTables (E:\restro-backend\src\controllers\table.controller.js:246:22)
2026-02-14 11:45:40 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:153:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:206:22)
2026-02-14 11:47:24 [ERROR]: Unhandled error: Primary table is not mergeable
Error: Primary table is not mergeable
    at Object.mergeTables (E:\restro-backend\src\services\table.service.js:1193:45)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async mergeTables (E:\restro-backend\src\controllers\table.controller.js:246:22)
2026-02-14 11:47:24 [ERROR]: Send KOT error: No pending items to send
Error: No pending items to send
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:153:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:206:22)
2026-02-14 11:47:52 [ERROR]: Unhandled error: No active session found
Error: No active session found
    at Object.endSession (E:\restro-backend\src\services\table.service.js:981:40)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async endSession (E:\restro-backend\src\controllers\table.controller.js:203:7)
2026-02-14 11:50:53 [ERROR]: Unhandled error: Table FF3 is not available
Error: Table FF3 is not available
    at Object.mergeTables (E:\restro-backend\src\services\table.service.js:1209:49)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async mergeTables (E:\restro-backend\src\controllers\table.controller.js:246:22)
2026-02-14 15:05:41 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '29' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:1559:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:334:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-14 15:05:42 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '29' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:1559:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:334:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-14 15:05:44 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '29' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:1559:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:334:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-14 15:05:44 [ERROR]: Unhandled error: FUNCTION restro.JSON_ARRAYAGG does not exist {"code":"ER_SP_DOES_NOT_EXIST","errno":1305,"sql":"SELECT kt.*, \n        u.name as created_by_name,\n        (SELECT JSON_ARRAYAGG(\n          JSON_OBJECT('id', ki.id, 'itemName', ki.item_name, 'quantity', ki.quantity, 'status', ki.status)\n        ) FROM kot_items ki WHERE ki.kot_id = kt.id) as items\n       FROM kot_tickets kt\n       JOIN orders o ON kt.order_id = o.id\n       JOIN table_sessions ts ON o.table_session_id = ts.id\n       LEFT JOIN users u ON kt.created_by = u.id\n       WHERE ts.table_id = '29' AND ts.status = 'active' AND kt.status IN ('pending', 'accepted', 'preparing')\n       ORDER BY kt.created_at ASC","sqlState":"42000","sqlMessage":"FUNCTION restro.JSON_ARRAYAGG does not exist"}
Error: FUNCTION restro.JSON_ARRAYAGG does not exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getRunningKots (E:\restro-backend\src\services\table.service.js:1559:31)
    at getRunningKots (E:\restro-backend\src\controllers\table.controller.js:334:39)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-17 10:34:36 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
<<<<<<< HEAD
2026-02-18 12:09:57 [ERROR]: Failed to start server: Access denied for user 'restro'@'localhost' (using password: YES) {"code":"ER_ACCESS_DENIED_ERROR","errno":1045,"sqlState":"28000","sqlMessage":"Access denied for user 'restro'@'localhost' (using password: YES)"}
Error: Access denied for user 'restro'@'localhost' (using password: YES)
    at Packet.asError (D:\Projects\restro-backend\node_modules\mysql2\lib\packets\packet.js:739:17)
    at ClientHandshake.execute (D:\Projects\restro-backend\node_modules\mysql2\lib\commands\command.js:29:26)
    at PoolConnection.handlePacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:508:34)
    at PacketParser.onPacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:93:12)
    at PacketParser.executeStart (D:\Projects\restro-backend\node_modules\mysql2\lib\packet_parser.js:75:16)
    at Socket.<anonymous> (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:100:25)
    at Socket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
2026-02-18 12:16:53 [ERROR]: Failed to start server: Access denied for user 'restro'@'localhost' (using password: YES) {"code":"ER_ACCESS_DENIED_ERROR","errno":1045,"sqlState":"28000","sqlMessage":"Access denied for user 'restro'@'localhost' (using password: YES)"}
Error: Access denied for user 'restro'@'localhost' (using password: YES)
    at Packet.asError (D:\Projects\restro-backend\node_modules\mysql2\lib\packets\packet.js:739:17)
    at ClientHandshake.execute (D:\Projects\restro-backend\node_modules\mysql2\lib\commands\command.js:29:26)
    at PoolConnection.handlePacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:508:34)
    at PacketParser.onPacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:93:12)
    at PacketParser.executeStart (D:\Projects\restro-backend\node_modules\mysql2\lib\packet_parser.js:75:16)
    at Socket.<anonymous> (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:100:25)
    at Socket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
2026-02-18 12:26:00 [ERROR]: Failed to start server: Access denied for user 'restro'@'localhost' (using password: YES) {"code":"ER_ACCESS_DENIED_ERROR","errno":1045,"sqlState":"28000","sqlMessage":"Access denied for user 'restro'@'localhost' (using password: YES)"}
Error: Access denied for user 'restro'@'localhost' (using password: YES)
    at Packet.asError (D:\Projects\restro-backend\node_modules\mysql2\lib\packets\packet.js:739:17)
    at ClientHandshake.execute (D:\Projects\restro-backend\node_modules\mysql2\lib\commands\command.js:29:26)
    at PoolConnection.handlePacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:508:34)
    at PacketParser.onPacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:93:12)
    at PacketParser.executeStart (D:\Projects\restro-backend\node_modules\mysql2\lib\packet_parser.js:75:16)
    at Socket.<anonymous> (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:100:25)
    at Socket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
2026-02-18 12:26:12 [ERROR]: Failed to start server: Access denied for user 'restro'@'localhost' (using password: YES) {"code":"ER_ACCESS_DENIED_ERROR","errno":1045,"sqlState":"28000","sqlMessage":"Access denied for user 'restro'@'localhost' (using password: YES)"}
Error: Access denied for user 'restro'@'localhost' (using password: YES)
    at Packet.asError (D:\Projects\restro-backend\node_modules\mysql2\lib\packets\packet.js:739:17)
    at ClientHandshake.execute (D:\Projects\restro-backend\node_modules\mysql2\lib\commands\command.js:29:26)
    at PoolConnection.handlePacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:508:34)
    at PacketParser.onPacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:93:12)
    at PacketParser.executeStart (D:\Projects\restro-backend\node_modules\mysql2\lib\packet_parser.js:75:16)
    at Socket.<anonymous> (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:100:25)
    at Socket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
2026-02-18 15:38:54 [ERROR]: Failed to start server: Access denied for user 'restro'@'localhost' (using password: YES) {"code":"ER_ACCESS_DENIED_ERROR","errno":1045,"sqlState":"28000","sqlMessage":"Access denied for user 'restro'@'localhost' (using password: YES)"}
Error: Access denied for user 'restro'@'localhost' (using password: YES)
    at Packet.asError (D:\Projects\restro-backend\node_modules\mysql2\lib\packets\packet.js:739:17)
    at ClientHandshake.execute (D:\Projects\restro-backend\node_modules\mysql2\lib\commands\command.js:29:26)
    at PoolConnection.handlePacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:508:34)
    at PacketParser.onPacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:93:12)
    at PacketParser.executeStart (D:\Projects\restro-backend\node_modules\mysql2\lib\packet_parser.js:75:16)
    at Socket.<anonymous> (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:100:25)
    at Socket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
=======
2026-02-19 21:46:52 [ERROR]: Get shift detail error: Shift not found
Error: Shift not found
    at Object.getShiftDetail (E:\restro-backend\src\services\payment.service.js:1113:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getShiftDetail (E:\restro-backend\src\controllers\order.controller.js:1232:21)
2026-02-19 21:46:53 [ERROR]: Get shift detail error: Shift not found
Error: Shift not found
    at Object.getShiftDetail (E:\restro-backend\src\services\payment.service.js:1113:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getShiftDetail (E:\restro-backend\src\controllers\order.controller.js:1232:21)
2026-02-19 22:41:59 [ERROR]: Direct cancel slip print failed:
2026-02-19 22:41:59 [ERROR]: Failed to print cancel slip for KOT KOT0214008:
2026-02-19 22:44:02 [ERROR]: Generate bill error: Column count doesn't match value count at row 1 {"code":"ER_WRONG_VALUE_COUNT_ON_ROW","errno":1136,"sql":"INSERT INTO invoices (\n          uuid, outlet_id, order_id, invoice_number, invoice_date, invoice_time,\n          customer_id, customer_name, customer_phone, customer_email,\n          customer_gstin, customer_address, billing_address,\n          is_interstate, customer_company_name, customer_gst_state, customer_gst_state_code,\n          subtotal, discount_amount, taxable_amount,\n          cgst_amount, sgst_amount, igst_amount, vat_amount, cess_amount, total_tax,\n          service_charge, packaging_charge, delivery_charge, round_off, grand_total,\n          amount_in_words, payment_status, tax_breakup, hsn_summary,\n          notes, terms_conditions, generated_by\n        ) VALUES ('6b665d64-f578-4bb1-8d43-1eb910696ec9', 4, '508', 'INV/2526/000297', '2026-02-19', '22:44:02', NULL, 'riu', '4889915112', NULL, NULL, NULL, NULL, false, NULL, NULL, NULL, 60, 0, 60, 1.5, 1.5, 0, 0, 0, 3, 0, 0, 0, 0, 63, 'pending', 'Sixty Three Rupees Only', '{\\\"CGST_2.5\\\":{\\\"name\\\":\\\"CGST 2.5%\\\",\\\"rate\\\":2.5,\\\"taxableAmount\\\":60,\\\"taxAmount\\\":1.5},\\\"SGST_2.5\\\":{\\\"name\\\":\\\"SGST 2.5%\\\",\\\"rate\\\":2.5,\\\"taxableAmount\\\":60,\\\"taxAmount\\\":1.5}}', '{}', NULL, NULL)","sqlState":"21S01","sqlMessage":"Column count doesn't match value count at row 1"}
Error: Column count doesn't match value count at row 1
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:380:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:387:23)
2026-02-19 22:44:11 [ERROR]: Generate bill error: Column count doesn't match value count at row 1 {"code":"ER_WRONG_VALUE_COUNT_ON_ROW","errno":1136,"sql":"INSERT INTO invoices (\n          uuid, outlet_id, order_id, invoice_number, invoice_date, invoice_time,\n          customer_id, customer_name, customer_phone, customer_email,\n          customer_gstin, customer_address, billing_address,\n          is_interstate, customer_company_name, customer_gst_state, customer_gst_state_code,\n          subtotal, discount_amount, taxable_amount,\n          cgst_amount, sgst_amount, igst_amount, vat_amount, cess_amount, total_tax,\n          service_charge, packaging_charge, delivery_charge, round_off, grand_total,\n          amount_in_words, payment_status, tax_breakup, hsn_summary,\n          notes, terms_conditions, generated_by\n        ) VALUES ('7e7b3c90-1617-4142-a8ea-4727cd1a18ab', 4, '508', 'INV/2526/000297', '2026-02-19', '22:44:11', NULL, 'riu', '4889915112', NULL, NULL, NULL, NULL, false, NULL, NULL, NULL, 60, 0, 60, 1.5, 1.5, 0, 0, 0, 3, 0, 0, 0, 0, 63, 'pending', 'Sixty Three Rupees Only', '{\\\"CGST_2.5\\\":{\\\"name\\\":\\\"CGST 2.5%\\\",\\\"rate\\\":2.5,\\\"taxableAmount\\\":60,\\\"taxAmount\\\":1.5},\\\"SGST_2.5\\\":{\\\"name\\\":\\\"SGST 2.5%\\\",\\\"rate\\\":2.5,\\\"taxableAmount\\\":60,\\\"taxAmount\\\":1.5}}', '{}', NULL, NULL)","sqlState":"21S01","sqlMessage":"Column count doesn't match value count at row 1"}
Error: Column count doesn't match value count at row 1
    at PromisePoolConnection.query (E:\restro-backend\node_modules\mysql2\lib\promise\connection.js:29:22)
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:380:41)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:387:23)
2026-02-19 22:46:05 [ERROR]: Direct Bill print failed for INV/2526/000297:
2026-02-19 22:46:05 [ERROR]: Direct bill print failed for INV/2526/000297:
2026-02-19 23:32:07 [ERROR]: Direct Bill print failed for INV/2526/000297:
2026-02-19 23:32:07 [ERROR]: Direct bill print failed for INV/2526/000297:
2026-02-19 23:32:57 [ERROR]: Direct Bill print failed for INV/2526/000298:
2026-02-19 23:32:57 [ERROR]: Direct bill print failed for INV/2526/000298:
2026-02-19 23:33:53 [ERROR]: Create customer error: Unknown column 'is_gst_customer' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO customers \n        (uuid, outlet_id, name, phone, email, address,\n         is_gst_customer, company_name, gstin, gst_state, gst_state_code,\n         company_phone, company_address, notes)\n       VALUES ('9316a201-dbc9-4f65-b7fb-94ecba19023d', '4', 'new', '7903838017', NULL, NULL, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL)","sqlState":"42S22","sqlMessage":"Unknown column 'is_gst_customer' in 'field list'"}
Error: Unknown column 'is_gst_customer' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.create (E:\restro-backend\src\services\customer.service.js:24:33)
    at create (E:\restro-backend\src\controllers\customer.controller.js:13:46)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:134:5
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-19 23:34:03 [ERROR]: Create customer error: Unknown column 'is_gst_customer' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO customers \n        (uuid, outlet_id, name, phone, email, address,\n         is_gst_customer, company_name, gstin, gst_state, gst_state_code,\n         company_phone, company_address, notes)\n       VALUES ('2246a260-fd44-4fd8-98fe-216eee90a0d3', '4', 'new', '7903838017', NULL, NULL, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL)","sqlState":"42S22","sqlMessage":"Unknown column 'is_gst_customer' in 'field list'"}
Error: Unknown column 'is_gst_customer' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.create (E:\restro-backend\src\services\customer.service.js:24:33)
    at create (E:\restro-backend\src\controllers\customer.controller.js:13:46)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:134:5
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-19 23:34:28 [ERROR]: Create customer error: Unknown column 'is_gst_customer' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO customers \n        (uuid, outlet_id, name, phone, email, address,\n         is_gst_customer, company_name, gstin, gst_state, gst_state_code,\n         company_phone, company_address, notes)\n       VALUES ('75e21bb3-d38b-4909-b2ee-f2c4de93cc94', '4', 'new', '7903838017', NULL, NULL, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL)","sqlState":"42S22","sqlMessage":"Unknown column 'is_gst_customer' in 'field list'"}
Error: Unknown column 'is_gst_customer' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.create (E:\restro-backend\src\services\customer.service.js:24:33)
    at create (E:\restro-backend\src\controllers\customer.controller.js:13:46)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:134:5
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-19 23:39:44 [ERROR]: Create customer error: Unknown column 'is_gst_customer' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO customers \n        (uuid, outlet_id, name, phone, email, address,\n         is_gst_customer, company_name, gstin, gst_state, gst_state_code,\n         company_phone, company_address, notes)\n       VALUES ('87ff9b4b-2778-49ae-8b8a-87bcd9865bb1', '4', 'new', '7903838017', NULL, NULL, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL)","sqlState":"42S22","sqlMessage":"Unknown column 'is_gst_customer' in 'field list'"}
Error: Unknown column 'is_gst_customer' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.create (E:\restro-backend\src\services\customer.service.js:24:33)
    at create (E:\restro-backend\src\controllers\customer.controller.js:13:46)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:134:5
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-19 23:43:28 [ERROR]: Socket error: wD8GK1AFUesy1xw7AAAC invalid payload
Error: invalid payload
    at Decoder.decodeString (E:\restro-backend\node_modules\socket.io-parser\build\cjs\index.js:235:23)
    at Decoder.add (E:\restro-backend\node_modules\socket.io-parser\build\cjs\index.js:138:27)
    at Client.ondata (E:\restro-backend\node_modules\socket.io\dist\client.js:185:26)
    at Socket.emit (node:events:518:28)
    at Socket.onPacket (E:\restro-backend\node_modules\engine.io\build\socket.js:117:22)
    at WebSocket.emit (node:events:518:28)
    at WebSocket.onPacket (E:\restro-backend\node_modules\engine.io\build\transport.js:96:14)
    at WebSocket.onData (E:\restro-backend\node_modules\engine.io\build\transport.js:105:14)
    at WebSocket.<anonymous> (E:\restro-backend\node_modules\engine.io\build\transports\websocket.js:40:19)
    at WebSocket.emit (node:events:518:28)
2026-02-19 23:56:49 [ERROR]: Direct Bill print failed for INV/2526/000298:
2026-02-19 23:56:49 [ERROR]: Direct bill print failed for INV/2526/000298:
2026-02-19 23:59:12 [ERROR]: Direct Bill print failed for INV/2526/000298:
2026-02-19 23:59:12 [ERROR]: Direct bill print failed for INV/2526/000298:
2026-02-20 18:38:52 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1139:18)
    at afterConnectMultiple (node:net:1712:7)
2026-02-20 19:47:48 [ERROR]: Direct Bill print failed for INV/2526/000299:
2026-02-20 19:47:48 [ERROR]: Direct bill print failed for INV/2526/000299:
2026-02-20 20:27:54 [ERROR]: Direct KOT print failed for KOT0220001:
2026-02-20 20:27:54 [ERROR]: Failed to print KOT KOT0220001:
2026-02-20 20:28:01 [ERROR]: Direct Bill print failed for INV/2526/000300:
2026-02-20 20:28:01 [ERROR]: Direct bill print failed for INV/2526/000300:
2026-02-20 20:30:58 [ERROR]: Direct KOT print failed for KOT0220002:
2026-02-20 20:30:58 [ERROR]: Failed to print KOT KOT0220002:
2026-02-20 20:31:00 [ERROR]: Direct Bill print failed for INV/2526/000301:
2026-02-20 20:31:00 [ERROR]: Direct bill print failed for INV/2526/000301:
2026-02-20 20:31:03 [ERROR]: Direct KOT print failed for BOT0220001:
2026-02-20 20:31:03 [ERROR]: Failed to print KOT BOT0220001:
2026-02-20 21:27:07 [ERROR]: Direct KOT print failed for KOT0220003:
2026-02-20 21:27:07 [ERROR]: Failed to print KOT KOT0220003:
2026-02-20 21:27:10 [ERROR]: Direct Bill print failed for INV/2526/000302:
2026-02-20 21:27:10 [ERROR]: Direct bill print failed for INV/2526/000302:
2026-02-20 21:27:12 [ERROR]: Direct KOT print failed for BOT0220002:
2026-02-20 21:27:12 [ERROR]: Failed to print KOT BOT0220002:
2026-02-20 21:33:22 [ERROR]: Direct KOT print failed for KOT0220004:
2026-02-20 21:33:22 [ERROR]: Failed to print KOT KOT0220004:
2026-02-20 21:33:24 [ERROR]: Direct Bill print failed for INV/2526/000303:
2026-02-20 21:33:24 [ERROR]: Direct bill print failed for INV/2526/000303:
2026-02-20 21:34:33 [ERROR]: Get admin order list error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17 {"code":"ER_PARSE_ERROR","errno":1064,"sql":"SELECT \n        o.*,\n        out.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42000","sqlMessage":"You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n  ...' at line 17"}
Error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:34:33 [ERROR]: Get admin order list error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17 {"code":"ER_PARSE_ERROR","errno":1064,"sql":"SELECT \n        o.*,\n        out.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42000","sqlMessage":"You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n  ...' at line 17"}
Error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:34:36 [ERROR]: Get admin order list error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17 {"code":"ER_PARSE_ERROR","errno":1064,"sql":"SELECT \n        o.*,\n        out.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42000","sqlMessage":"You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n  ...' at line 17"}
Error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:34:36 [ERROR]: Get admin order list error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17 {"code":"ER_PARSE_ERROR","errno":1064,"sql":"SELECT \n        o.*,\n        out.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42000","sqlMessage":"You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n  ...' at line 17"}
Error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:34:39 [ERROR]: Get admin order list error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17 {"code":"ER_PARSE_ERROR","errno":1064,"sql":"SELECT \n        o.*,\n        out.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42000","sqlMessage":"You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n  ...' at line 17"}
Error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:34:40 [ERROR]: Get admin order list error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17 {"code":"ER_PARSE_ERROR","errno":1064,"sql":"SELECT \n        o.*,\n        out.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42000","sqlMessage":"You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id\n       LEFT JOIN tables t ON o.table_id = t.id\n  ...' at line 17"}
Error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'out ON o.outlet_id = out.id
       LEFT JOIN tables t ON o.table_id = t.id
  ...' at line 17
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:36:07 [ERROR]: Direct KOT print failed for KOT0220005:
2026-02-20 21:36:07 [ERROR]: Failed to print KOT KOT0220005:
2026-02-20 21:36:10 [ERROR]: Direct Bill print failed for INV/2526/000304:
2026-02-20 21:36:10 [ERROR]: Direct bill print failed for INV/2526/000304:
2026-02-20 21:36:12 [ERROR]: Direct KOT print failed for BOT0220003:
2026-02-20 21:36:13 [ERROR]: Failed to print KOT BOT0220003:
2026-02-20 21:44:57 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:44:57 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:31 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:31 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:33 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:33 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:45 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:45 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:48 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:48 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:50 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:50 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:51:52 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:52:32 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:52:33 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:52:35 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:52:35 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:52:45 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:52:45 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:52:49 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:52:49 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:52:52 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:52:52 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:53:00 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:53:00 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:53:05 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:53:05 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:53:11 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:53:11 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:53:17 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:53:17 [ERROR]: Get admin order list error: Table 'restro.kots' doesn't exist {"code":"ER_NO_SUCH_TABLE","errno":1146,"sql":"SELECT \n        o.*,\n        ol.name as outlet_name,\n        t.table_number,\n        t.name as table_name,\n        f.name as floor_name,\n        s.name as section_name,\n        captain.name as captain_name,\n        inv.id as invoice_id,\n        inv.invoice_number,\n        inv.grand_total as invoice_total,\n        inv.payment_status as invoice_payment_status,\n        (SELECT COUNT(*) FROM order_items WHERE order_id = o.id) as item_count,\n        (SELECT COUNT(*) FROM kots WHERE order_id = o.id) as kot_count,\n        (SELECT SUM(total_amount) FROM payments WHERE order_id = o.id AND status = 'completed') as paid_amount\n       FROM orders o\n       LEFT JOIN outlets ol ON o.outlet_id = ol.id\n       LEFT JOIN tables t ON o.table_id = t.id\n       LEFT JOIN floors f ON t.floor_id = f.id\n       LEFT JOIN sections s ON t.section_id = s.id\n       LEFT JOIN users captain ON o.created_by = captain.id\n       LEFT JOIN invoices inv ON o.id = inv.order_id\n       WHERE o.outlet_id = '4'\n       GROUP BY o.id\n       ORDER BY o.created_at DESC\n       LIMIT 10 OFFSET 0","sqlState":"42S02","sqlMessage":"Table 'restro.kots' doesn't exist"}
Error: Table 'restro.kots' doesn't exist
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.getAdminOrderList (E:\restro-backend\src\services\order.service.js:1944:33)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getAdminOrderList (E:\restro-backend\src\controllers\order.controller.js:1295:22)
2026-02-20 21:53:52 [ERROR]: Direct Bill print failed for INV/2526/000304:
2026-02-20 21:53:52 [ERROR]: Direct bill print failed for INV/2526/000304:
2026-02-20 21:57:24 [ERROR]: Direct Bill print failed for INV/2526/000305:
2026-02-20 21:57:24 [ERROR]: Direct bill print failed for INV/2526/000305:
2026-02-20 22:02:48 [ERROR]: Direct KOT print failed for KOT0220006:
2026-02-20 22:02:48 [ERROR]: Failed to print KOT KOT0220006:
2026-02-20 22:02:53 [ERROR]: Direct KOT print failed for BOT0220004:
2026-02-20 22:02:53 [ERROR]: Failed to print KOT BOT0220004:
2026-02-20 22:03:31 [ERROR]: Direct Bill print failed for INV/2526/000306:
2026-02-20 22:03:31 [ERROR]: Direct bill print failed for INV/2526/000306:
2026-02-20 22:47:09 [ERROR]: Direct KOT print failed for KOT0220007:
2026-02-20 22:47:09 [ERROR]: Failed to print KOT KOT0220007:
2026-02-20 22:47:12 [ERROR]: Direct Bill print failed for INV/2526/000307:
2026-02-20 22:47:12 [ERROR]: Direct bill print failed for INV/2526/000307:
2026-02-20 22:48:39 [ERROR]: Create order error: Table already has an active order (Order ID: 513). Use existing order or end session first.
Error: Table already has an active order (Order ID: 513). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:141:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:22:21)
2026-02-20 22:49:30 [ERROR]: Direct KOT print failed for KOT0220008:
2026-02-20 22:49:30 [ERROR]: Failed to print KOT KOT0220008:
2026-02-20 22:49:31 [ERROR]: Direct Bill print failed for INV/2526/000308:
2026-02-20 22:49:31 [ERROR]: Direct bill print failed for INV/2526/000308:
2026-02-20 22:52:02 [ERROR]: Direct Bill print failed for INV/2526/000308:
2026-02-20 22:52:02 [ERROR]: Direct bill print failed for INV/2526/000308:
2026-02-20 22:59:14 [ERROR]: Create order error: Table already has an active order (Order ID: 513). Use existing order or end session first.
Error: Table already has an active order (Order ID: 513). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:141:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:22:21)
2026-02-20 22:59:22 [ERROR]: Create order error: Table already has an active order (Order ID: 513). Use existing order or end session first.
Error: Table already has an active order (Order ID: 513). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:141:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:22:21)
2026-02-20 22:59:30 [ERROR]: Create order error: Table already has an active order (Order ID: 513). Use existing order or end session first.
Error: Table already has an active order (Order ID: 513). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:141:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:22:21)
2026-02-20 22:59:48 [ERROR]: Create order error: Table already has an active order (Order ID: 513). Use existing order or end session first.
Error: Table already has an active order (Order ID: 513). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:141:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:22:21)
2026-02-20 23:02:29 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:276:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:106:22)
2026-02-20 23:02:33 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:276:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:106:22)
2026-02-20 23:02:44 [ERROR]: Create order error: Table already has an active order (Order ID: 513). Use existing order or end session first.
Error: Table already has an active order (Order ID: 513). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:141:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:22:21)
2026-02-20 23:02:53 [ERROR]: Create order error: Table already has an active order (Order ID: 513). Use existing order or end session first.
Error: Table already has an active order (Order ID: 513). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:141:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:22:21)
2026-02-20 23:03:01 [ERROR]: Create order error: Table already has an active order (Order ID: 513). Use existing order or end session first.
Error: Table already has an active order (Order ID: 513). Use existing order or end session first.
    at Object.createOrder (E:\restro-backend\src\services\order.service.js:141:19)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async createOrder (E:\restro-backend\src\controllers\order.controller.js:22:21)
2026-02-20 23:03:24 [ERROR]: Direct KOT print failed for KOT0220009:
2026-02-20 23:03:24 [ERROR]: Failed to print KOT KOT0220009:
2026-02-20 23:03:29 [ERROR]: Direct KOT print failed for BOT0220005:
2026-02-20 23:03:29 [ERROR]: Failed to print KOT BOT0220005:
2026-02-20 23:03:31 [ERROR]: Direct Bill print failed for INV/2526/000309:
2026-02-20 23:03:31 [ERROR]: Direct bill print failed for INV/2526/000309:
2026-02-20 23:11:11 [ERROR]: Direct Bill print failed for INV/2526/000306:
2026-02-20 23:11:11 [ERROR]: Direct bill print failed for INV/2526/000306:
2026-02-20 23:42:34 [ERROR]: Get captain order detail error: You can only view your own orders
Error: You can only view your own orders
    at Object.getCaptainOrderDetail (E:\restro-backend\src\services\order.service.js:1629:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCaptainOrderDetail (E:\restro-backend\src\controllers\order.controller.js:1156:21)
2026-02-20 23:42:36 [ERROR]: Get captain order detail error: You can only view your own orders
Error: You can only view your own orders
    at Object.getCaptainOrderDetail (E:\restro-backend\src\services\order.service.js:1629:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCaptainOrderDetail (E:\restro-backend\src\controllers\order.controller.js:1156:21)
2026-02-20 23:58:25 [ERROR]: Direct Bill print failed for INV/2526/000309:
2026-02-20 23:58:25 [ERROR]: Direct bill print failed for INV/2526/000309:
2026-02-21 00:01:08 [ERROR]: Direct KOT print failed for KOT0220001:
2026-02-21 00:01:08 [ERROR]: Failed to print KOT KOT0220001:
2026-02-21 00:01:09 [ERROR]: Direct Bill print failed for INV/2526/000310:
2026-02-21 00:01:09 [ERROR]: Direct bill print failed for INV/2526/000310:
2026-02-21 07:33:56 [ERROR]: Failed to start server: connect ETIMEDOUT {"errorno":"ETIMEDOUT","code":"ETIMEDOUT","syscall":"connect","fatal":true}
Error: connect ETIMEDOUT
    at PoolConnection._handleTimeoutError (E:\restro-backend\node_modules\mysql2\lib\base\connection.js:200:17)
    at listOnTimeout (node:internal/timers:594:17)
    at process.processTimers (node:internal/timers:529:7)
2026-02-21 09:54:28 [ERROR]: Direct KOT print failed for KOT0221002:
2026-02-21 09:54:28 [ERROR]: Failed to print KOT KOT0221002:
2026-02-21 09:54:40 [ERROR]: Direct Bill print failed for INV/2526/000311:
2026-02-21 09:54:40 [ERROR]: Direct bill print failed for INV/2526/000311:
2026-02-21 10:31:58 [ERROR]: Ping printer error: Unknown column 'is_online' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE printers SET is_online = false, last_seen_at = NOW() WHERE id = 1","sqlState":"42S22","sqlMessage":"Unknown column 'is_online' in 'field list'"}
Error: Unknown column 'is_online' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.updatePrinterStatus (E:\restro-backend\src\services\printer.service.js:107:16)
    at pingPrinter (E:\restro-backend\src\controllers\printer.controller.js:365:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-21 12:28:37 [ERROR]: Direct KOT print failed for KOT0221003:
2026-02-21 12:28:37 [ERROR]: Failed to print KOT KOT0221003:
2026-02-21 12:28:42 [ERROR]: Direct KOT print failed for BOT0221001:
2026-02-21 12:28:42 [ERROR]: Failed to print KOT BOT0221001:
2026-02-21 12:31:34 [ERROR]: Direct Bill print failed for INV/2526/000312:
2026-02-21 12:31:34 [ERROR]: Direct bill print failed for INV/2526/000312:
2026-02-21 12:50:19 [ERROR]: Direct Bill print failed for INV/2526/000312:
2026-02-21 12:50:19 [ERROR]: Direct bill print failed for INV/2526/000312:
2026-02-21 12:50:29 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:320:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:106:22)
2026-02-21 12:51:11 [ERROR]: Add items error: Cannot add items to this order
Error: Cannot add items to this order
    at Object.addItems (E:\restro-backend\src\services\order.service.js:320:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async addItems (E:\restro-backend\src\controllers\order.controller.js:106:22)
2026-02-21 12:51:49 [ERROR]: Direct Bill print failed for INV/2526/000312:
2026-02-21 12:51:49 [ERROR]: Direct bill print failed for INV/2526/000312:
2026-02-21 12:53:01 [ERROR]: Direct KOT print failed for KOT0221004:
2026-02-21 12:53:01 [ERROR]: Failed to print KOT KOT0221004:
2026-02-21 12:53:55 [ERROR]: Direct Bill print failed for INV/2526/000313:
2026-02-21 12:53:55 [ERROR]: Direct bill print failed for INV/2526/000313:
2026-02-21 13:11:40 [ERROR]: Direct KOT print failed for KOT0221005:
2026-02-21 13:11:40 [ERROR]: Failed to print KOT KOT0221005:
2026-02-21 13:11:45 [ERROR]: Direct Bill print failed for INV/2526/000314:
2026-02-21 13:11:45 [ERROR]: Direct bill print failed for INV/2526/000314:
2026-02-21 13:11:45 [ERROR]: Direct KOT print failed for BOT0221002:
2026-02-21 13:11:45 [ERROR]: Failed to print KOT BOT0221002:
2026-02-21 13:14:18 [ERROR]: Direct KOT print failed for KOT0221006:
2026-02-21 13:14:18 [ERROR]: Failed to print KOT KOT0221006:
2026-02-21 13:14:23 [ERROR]: Direct Bill print failed for INV/2526/000315:
2026-02-21 13:14:23 [ERROR]: Direct bill print failed for INV/2526/000315:
2026-02-21 13:14:23 [ERROR]: Direct KOT print failed for BOT0221003:
2026-02-21 13:14:23 [ERROR]: Failed to print KOT BOT0221003:
2026-02-21 13:15:44 [ERROR]: Direct KOT print failed for KOT0221007:
2026-02-21 13:15:44 [ERROR]: Failed to print KOT KOT0221007:
2026-02-21 13:15:53 [ERROR]: Direct Bill print failed for INV/2526/000316:
2026-02-21 13:15:53 [ERROR]: Direct bill print failed for INV/2526/000316:
2026-02-21 14:44:45 [ERROR]: Direct KOT print failed for KOT0221008:
2026-02-21 14:44:45 [ERROR]: Failed to print KOT KOT0221008:
2026-02-21 14:44:49 [ERROR]: Direct Bill print failed for INV/2526/000317:
2026-02-21 14:44:49 [ERROR]: Direct bill print failed for INV/2526/000317:
2026-02-21 14:44:50 [ERROR]: Direct KOT print failed for BOT0221004:
2026-02-21 14:44:50 [ERROR]: Failed to print KOT BOT0221004:
2026-02-21 15:39:11 [ERROR]: Direct Bill print failed for INV/2526/000313:
2026-02-21 15:39:11 [ERROR]: Direct bill print failed for INV/2526/000313:
2026-02-21 15:40:22 [ERROR]: Direct KOT print failed for KOT0221009:
2026-02-21 15:40:22 [ERROR]: Failed to print KOT KOT0221009:
2026-02-21 15:40:27 [ERROR]: Direct Bill print failed for INV/2526/000318:
2026-02-21 15:40:27 [ERROR]: Direct bill print failed for INV/2526/000318:
2026-02-21 15:42:21 [ERROR]: Direct KOT print failed for KOT0221010:
2026-02-21 15:42:21 [ERROR]: Failed to print KOT KOT0221010:
2026-02-21 15:42:31 [ERROR]: Direct Bill print failed for INV/2526/000319:
2026-02-21 15:42:31 [ERROR]: Direct bill print failed for INV/2526/000319:
2026-02-21 16:23:00 [ERROR]: Direct KOT print failed for KOT0221011:
2026-02-21 16:23:00 [ERROR]: Failed to print KOT KOT0221011:
2026-02-21 16:23:09 [ERROR]: Direct Bill print failed for INV/2526/000320:
2026-02-21 16:23:09 [ERROR]: Direct bill print failed for INV/2526/000320:
2026-02-21 16:37:07 [ERROR]: Direct KOT print failed for KOT0221012:
2026-02-21 16:37:07 [ERROR]: Failed to print KOT KOT0221012:
2026-02-21 16:37:48 [ERROR]: Direct Bill print failed for INV/2526/000321:
2026-02-21 16:37:48 [ERROR]: Direct bill print failed for INV/2526/000321:
2026-02-21 16:41:12 [ERROR]: Direct Bill print failed for INV/2526/000321:
2026-02-21 16:41:12 [ERROR]: Direct bill print failed for INV/2526/000321:
2026-02-21 16:43:50 [ERROR]: Get captain order detail error: You can only view your own orders
Error: You can only view your own orders
    at Object.getCaptainOrderDetail (E:\restro-backend\src\services\order.service.js:1621:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCaptainOrderDetail (E:\restro-backend\src\controllers\order.controller.js:1144:21)
2026-02-21 16:44:45 [ERROR]: Get captain order detail error: You can only view your own orders
Error: You can only view your own orders
    at Object.getCaptainOrderDetail (E:\restro-backend\src\services\order.service.js:1621:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCaptainOrderDetail (E:\restro-backend\src\controllers\order.controller.js:1144:21)
2026-02-21 16:45:25 [ERROR]: Get captain order detail error: You can only view your own orders
Error: You can only view your own orders
    at Object.getCaptainOrderDetail (E:\restro-backend\src\services\order.service.js:1621:13)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async getCaptainOrderDetail (E:\restro-backend\src\controllers\order.controller.js:1144:21)
2026-02-21 16:48:23 [ERROR]: Generate bill error: Order already paid
Error: Order already paid
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:358:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:387:23)
2026-02-21 16:49:36 [ERROR]: Direct KOT print failed for KOT0221013:
2026-02-21 16:49:36 [ERROR]: Failed to print KOT KOT0221013:
2026-02-21 16:51:07 [ERROR]: Direct Bill print failed for INV/2526/000322:
2026-02-21 16:51:07 [ERROR]: Direct bill print failed for INV/2526/000322:
2026-02-21 17:16:35 [ERROR]: Direct Bill print failed for INV/2526/000322:
2026-02-21 17:16:35 [ERROR]: Direct bill print failed for INV/2526/000322:
2026-02-21 17:23:22 [ERROR]: Direct Bill print failed for INV/2526/000322:
2026-02-21 17:23:22 [ERROR]: Direct bill print failed for INV/2526/000322:
2026-02-21 17:27:20 [ERROR]: Direct Bill print failed for INV/2526/000312:
2026-02-21 17:27:20 [ERROR]: Direct bill print failed for INV/2526/000312:
2026-02-21 17:28:21 [ERROR]: Create printer error: Unknown column 'uuid' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"INSERT INTO printers (\n        uuid, outlet_id, name, code, printer_type, station,\n        counter_id, kitchen_station_id, ip_address, port,\n        connection_type, paper_width, characters_per_line,\n        supports_cash_drawer, supports_cutter, supports_logo\n      ) VALUES ('2a42ac9d-b055-4b99-b2df-245867d71aa9', '', 'TEST STATION', 'PRNMLW9M1O4', 'kot', '9', NULL, NULL, '192.168.1.1', 5001, 'network', '80mm', 48, false, true, false)","sqlState":"42S22","sqlMessage":"Unknown column 'uuid' in 'field list'"}
Error: Unknown column 'uuid' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createPrinter (E:\restro-backend\src\services\printer.service.js:24:33)
    at createPrinter (E:\restro-backend\src\controllers\printer.controller.js:16:44)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-21 17:33:26 [ERROR]: Direct Bill print failed for INV/2526/000322:
2026-02-21 17:33:26 [ERROR]: Direct bill print failed for INV/2526/000322:
2026-02-21 17:37:26 [ERROR]: Direct KOT print failed for KOT0221014:
2026-02-21 17:37:26 [ERROR]: Failed to print KOT KOT0221014:
2026-02-21 17:37:35 [ERROR]: Direct Bill print failed for INV/2526/000323:
2026-02-21 17:37:35 [ERROR]: Direct bill print failed for INV/2526/000323:
2026-02-21 17:41:10 [ERROR]: Ping printer error: Unknown column 'is_online' in 'field list' {"code":"ER_BAD_FIELD_ERROR","errno":1054,"sql":"UPDATE printers SET is_online = false, last_seen_at = NOW() WHERE id = 1","sqlState":"42S22","sqlMessage":"Unknown column 'is_online' in 'field list'"}
Error: Unknown column 'is_online' in 'field list'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.updatePrinterStatus (E:\restro-backend\src\services\printer.service.js:107:16)
    at pingPrinter (E:\restro-backend\src\controllers\printer.controller.js:365:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
2026-02-21 17:41:51 [ERROR]: Direct KOT print failed for KOT0221015:
2026-02-21 17:41:51 [ERROR]: Failed to print KOT KOT0221015:
2026-02-21 17:41:56 [ERROR]: Direct KOT print failed for BOT0221005:
2026-02-21 17:41:56 [ERROR]: Failed to print KOT BOT0221005:
2026-02-21 17:41:58 [ERROR]: Direct Bill print failed for INV/2526/000324:
2026-02-21 17:41:58 [ERROR]: Direct bill print failed for INV/2526/000324:
2026-02-21 17:41:59 [ERROR]: Process payment error: Order already paid
Error: Order already paid
    at Object.processPayment (E:\restro-backend\src\services\payment.service.js:159:15)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async processPayment (E:\restro-backend\src\controllers\order.controller.js:605:22)
2026-02-21 17:44:01 [ERROR]: Direct KOT print failed for KOT0221016:
2026-02-21 17:44:01 [ERROR]: Failed to print KOT KOT0221016:
2026-02-21 17:44:04 [ERROR]: Direct Bill print failed for INV/2526/000325:
2026-02-21 17:44:04 [ERROR]: Direct bill print failed for INV/2526/000325:
2026-02-21 18:00:42 [ERROR]: Direct KOT print failed for KOT0221017:
2026-02-21 18:00:42 [ERROR]: Failed to print KOT KOT0221017:
2026-02-21 18:02:41 [ERROR]: Direct KOT print failed for KOT0221018:
2026-02-21 18:02:41 [ERROR]: Failed to print KOT KOT0221018:
2026-02-21 18:02:46 [ERROR]: Direct Bill print failed for INV/2526/000326:
2026-02-21 18:02:46 [ERROR]: Direct bill print failed for INV/2526/000326:
2026-02-21 18:03:45 [ERROR]: Direct KOT print failed for KOT0221019:
2026-02-21 18:03:45 [ERROR]: Failed to print KOT KOT0221019:
2026-02-21 18:03:52 [ERROR]: Direct Bill print failed for INV/2526/000327:
2026-02-21 18:03:52 [ERROR]: Direct bill print failed for INV/2526/000327:
2026-02-21 18:08:06 [ERROR]: Direct KOT print failed for KOT0221020:
2026-02-21 18:08:06 [ERROR]: Failed to print KOT KOT0221020:
2026-02-21 18:08:07 [ERROR]: Direct Bill print failed for INV/2526/000328:
2026-02-21 18:08:07 [ERROR]: Direct bill print failed for INV/2526/000328:
2026-02-21 18:11:30 [ERROR]: Direct Bill print failed for INV/2526/000311:
2026-02-21 18:11:30 [ERROR]: Direct bill print failed for INV/2526/000311:
2026-02-21 18:12:01 [ERROR]: Direct Bill print failed for INV/2526/000325:
2026-02-21 18:12:01 [ERROR]: Direct bill print failed for INV/2526/000325:
2026-02-21 18:32:15 [ERROR]: Direct KOT print failed for BOT0221007:
2026-02-21 18:32:15 [ERROR]: Failed to print KOT BOT0221007:
2026-02-21 18:32:20 [ERROR]: Direct KOT print failed for KOT0221021:
2026-02-21 18:32:20 [ERROR]: Failed to print KOT KOT0221021:
2026-02-21 18:32:21 [ERROR]: Create printer error: Cannot add or update a child row: a foreign key constraint fails (`restro`.`printers`, CONSTRAINT `printers_ibfk_1` FOREIGN KEY (`outlet_id`) REFERENCES `outlets` (`id`) ON DELETE CASCADE) {"code":"ER_NO_REFERENCED_ROW_2","errno":1452,"sql":"INSERT INTO printers (\n        uuid, outlet_id, name, code, printer_type, station,\n        station_id, ip_address, port,\n        connection_type, paper_width, characters_per_line,\n        supports_cash_drawer, supports_cutter, supports_logo\n      ) VALUES ('9b6a1704-df13-4206-8073-37f042e40a67', '', 'TEST PRINTER', 'PRNMLWBWC9Q', 'thermal', NULL, '11', '192.168.1.1', 5001, 'network', '80mm', 48, false, true, false)","sqlState":"23000","sqlMessage":"Cannot add or update a child row: a foreign key constraint fails (`restro`.`printers`, CONSTRAINT `printers_ibfk_1` FOREIGN KEY (`outlet_id`) REFERENCES `outlets` (`id`) ON DELETE CASCADE)"}
Error: Cannot add or update a child row: a foreign key constraint fails (`restro`.`printers`, CONSTRAINT `printers_ibfk_1` FOREIGN KEY (`outlet_id`) REFERENCES `outlets` (`id`) ON DELETE CASCADE)
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.createPrinter (E:\restro-backend\src\services\printer.service.js:24:33)
    at createPrinter (E:\restro-backend\src\controllers\printer.controller.js:16:44)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:119:14
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-21 18:32:45 [ERROR]: Direct Bill print failed for INV/2526/000329:
2026-02-21 18:32:45 [ERROR]: Direct bill print failed for INV/2526/000329:
2026-02-21 19:44:56 [ERROR]: Check printer status error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.checkPrinterStatus (E:\restro-backend\src\services\printer.service.js:892:35)
    at checkPrinterStatus (E:\restro-backend\src\controllers\printer.controller.js:281:45)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-21 19:45:01 [ERROR]: Check printer status error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.checkPrinterStatus (E:\restro-backend\src\services\printer.service.js:892:35)
    at checkPrinterStatus (E:\restro-backend\src\controllers\printer.controller.js:281:45)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-21 21:07:13 [ERROR]: Direct KOT print failed for KOT0221022:
2026-02-21 21:07:13 [ERROR]: Failed to print KOT KOT0221022:
2026-02-21 21:07:18 [ERROR]: Direct KOT print failed for BOT0221008:
2026-02-21 21:07:18 [ERROR]: Failed to print KOT BOT0221008:
2026-02-21 21:19:15 [ERROR]: Direct KOT print failed for KOT0221023:
2026-02-21 21:19:15 [ERROR]: Failed to print KOT KOT0221023:
2026-02-21 21:42:51 [ERROR]: Direct KOT print failed for KOT0221024:
2026-02-21 21:42:51 [ERROR]: Failed to print KOT KOT0221024:
2026-02-21 21:51:26 [ERROR]: Direct KOT print failed for KOT0221025:
2026-02-21 21:51:26 [ERROR]: Failed to print KOT KOT0221025:
2026-02-21 21:52:20 [ERROR]: Direct Bill print failed for INV/2526/000330:
2026-02-21 21:52:20 [ERROR]: Direct bill print failed for INV/2526/000330:
2026-02-21 21:53:10 [ERROR]: Direct KOT print failed for KOT0221026:
2026-02-21 21:53:10 [ERROR]: Failed to print KOT KOT0221026:
2026-02-21 21:55:21 [ERROR]: Direct Bill print failed for INV/2526/000331:
2026-02-21 21:55:21 [ERROR]: Direct bill print failed for INV/2526/000331:
2026-02-21 21:56:11 [ERROR]: Direct Bill print failed for INV/2526/000331:
2026-02-21 21:56:11 [ERROR]: Direct bill print failed for INV/2526/000331:
2026-02-21 21:57:06 [ERROR]: Direct Bill print failed for INV/2526/000332:
2026-02-21 21:57:06 [ERROR]: Direct bill print failed for INV/2526/000332:
2026-02-21 22:30:33 [ERROR]: Direct KOT print failed for KOT0221027:
2026-02-21 22:30:33 [ERROR]: Failed to print KOT KOT0221027:
2026-02-21 22:30:35 [ERROR]: Direct Bill print failed for INV/2526/000333:
2026-02-21 22:30:35 [ERROR]: Direct bill print failed for INV/2526/000333:
2026-02-21 22:59:12 [ERROR]: Direct KOT print failed for KOT0221028:
2026-02-21 22:59:12 [ERROR]: Failed to print KOT KOT0221028:
2026-02-21 22:59:20 [ERROR]: Direct Bill print failed for INV/2526/000334:
2026-02-21 22:59:20 [ERROR]: Direct bill print failed for INV/2526/000334:
2026-02-21 23:16:39 [ERROR]: Direct KOT print failed for KOT0221029:
2026-02-21 23:16:39 [ERROR]: Failed to print KOT KOT0221029:
2026-02-21 23:16:55 [ERROR]: Mark item ready error: KOT item not found
Error: KOT item not found
    at Object.markItemReady (E:\restro-backend\src\services\kot.service.js:454:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async markItemReady (E:\restro-backend\src\controllers\order.controller.js:309:19)
2026-02-21 23:27:12 [ERROR]: Direct KOT print failed for KOT0221030:
2026-02-21 23:27:12 [ERROR]: Failed to print KOT KOT0221030:
2026-02-21 23:27:24 [ERROR]: Direct KOT print failed for KOT0221031:
2026-02-21 23:27:24 [ERROR]: Failed to print KOT KOT0221031:
2026-02-21 23:28:12 [ERROR]: Direct KOT print failed for BOT0221009:
2026-02-21 23:28:12 [ERROR]: Failed to print KOT BOT0221009:
2026-02-21 23:29:49 [ERROR]: Direct KOT print failed for KOT0221032:
2026-02-21 23:29:49 [ERROR]: Failed to print KOT KOT0221032:
2026-02-22 13:55:32 [ERROR]: Check printer status error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.checkPrinterStatus (E:\restro-backend\src\services\printer.service.js:900:35)
    at checkPrinterStatus (E:\restro-backend\src\controllers\printer.controller.js:282:45)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-22 13:55:37 [ERROR]: Check printer status error: {"code":"ECONNREFUSED"}
Error
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.checkPrinterStatus (E:\restro-backend\src\services\printer.service.js:900:35)
    at checkPrinterStatus (E:\restro-backend\src\controllers\printer.controller.js:282:45)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (E:\restro-backend\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at E:\restro-backend\node_modules\express\lib\router\index.js:284:15
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:365:14)
    at param (E:\restro-backend\node_modules\express\lib\router\index.js:376:14)
2026-02-22 14:03:58 [ERROR]: Direct KOT print failed for KOT0222001:
2026-02-22 14:03:58 [ERROR]: Failed to print KOT KOT0222001:
2026-02-22 14:04:01 [ERROR]: Direct Bill print failed for INV/2526/000335:
2026-02-22 14:04:01 [ERROR]: Direct bill print failed for INV/2526/000335:
2026-02-22 14:04:13 [ERROR]: Direct Bill print failed for INV/2526/000335:
2026-02-22 14:04:13 [ERROR]: Direct bill print failed for INV/2526/000335:
2026-02-22 14:04:25 [ERROR]: Direct Bill print failed for INV/2526/000335:
2026-02-22 14:04:25 [ERROR]: Direct bill print failed for INV/2526/000335:
2026-02-22 14:04:34 [ERROR]: Direct Bill print failed for INV/2526/000335:
2026-02-22 14:04:34 [ERROR]: Direct bill print failed for INV/2526/000335:
2026-02-22 15:18:37 [ERROR]: Direct KOT print failed for KOT0222002:
2026-02-22 15:18:37 [ERROR]: Failed to print KOT KOT0222002:
2026-02-22 15:18:42 [ERROR]: Direct KOT print failed for BOT0222001:
2026-02-22 15:18:42 [ERROR]: Failed to print KOT BOT0222001:
2026-02-22 15:19:41 [ERROR]: Direct Bill print failed for INV/2526/000336:
2026-02-22 15:19:41 [ERROR]: Direct bill print failed for INV/2526/000336:
2026-02-22 15:22:31 [ERROR]: Direct Bill print failed for INV/2526/000337:
2026-02-22 15:22:31 [ERROR]: Direct bill print failed for INV/2526/000337:
2026-02-22 15:50:52 [ERROR]: Direct KOT print failed for KOT0222003:
2026-02-22 15:50:52 [ERROR]: Failed to print KOT KOT0222003:
2026-02-22 15:50:57 [ERROR]: Direct KOT print failed for BOT0222002:
2026-02-22 15:50:57 [ERROR]: Failed to print KOT BOT0222002:
2026-02-22 15:51:06 [ERROR]: Direct Bill print failed for INV/2526/000338:
2026-02-22 15:51:06 [ERROR]: Direct bill print failed for INV/2526/000338:
2026-02-22 15:56:07 [ERROR]: Direct Bill print failed for INV/2526/000338:
2026-02-22 15:56:07 [ERROR]: Direct bill print failed for INV/2526/000338:
2026-02-22 16:00:15 [ERROR]: Direct Bill print failed for INV/2526/000338:
2026-02-22 16:00:15 [ERROR]: Direct bill print failed for INV/2526/000338:
2026-02-22 16:01:10 [ERROR]: Direct Bill print failed for INV/2526/000338:
2026-02-22 16:01:10 [ERROR]: Direct bill print failed for INV/2526/000338:
2026-02-22 16:04:10 [ERROR]: Direct Bill print failed for INV/2526/000338:
2026-02-22 16:04:10 [ERROR]: Direct bill print failed for INV/2526/000338:
2026-02-22 16:04:37 [ERROR]: Direct Bill print failed for INV/2526/000338:
2026-02-22 16:04:37 [ERROR]: Direct bill print failed for INV/2526/000338:
2026-02-22 16:05:15 [ERROR]: Direct Bill print failed for INV/2526/000338:
2026-02-22 16:05:15 [ERROR]: Direct bill print failed for INV/2526/000338:
2026-02-22 18:24:41 [ERROR]: Unhandled error: Duplicate entry 'E2ETEST01' for key 'code' {"code":"ER_DUP_ENTRY","errno":1062,"sql":"INSERT INTO outlets (\n        uuid, code, name, legal_name, outlet_type, \n        address_line1, address_line2, city, state, country, postal_code,\n        phone, email, gstin, fssai_number,\n        opening_time, closing_time, is_24_hours,\n        currency_code, timezone, settings,\n        is_active, created_by\n      ) VALUES ('14f5a532-20f1-40f2-8a19-7af4b79ebf80', 'E2ETEST01', 'E2E Test Restaurant', 'E2E Test Restaurant Pvt Ltd', 'restaurant', '999 E2E Test Street', NULL, 'Mumbai', 'Maharashtra', 'India', '400001', '+91-22-99998888', 'e2e@testrestro.com', '27AABCE2E34R1ZP', '99998888776655', '09:00', '23:00', false, 'INR', 'Asia/Kolkata', '{}', true, 141)","sqlState":"23000","sqlMessage":"Duplicate entry 'E2ETEST01' for key 'code'"}
Error: Duplicate entry 'E2ETEST01' for key 'code'
    at PromisePool.query (E:\restro-backend\node_modules\mysql2\lib\promise\pool.js:36:22)
    at Object.create (E:\restro-backend\src\services\outlet.service.js:20:33)
    at createOutlet (E:\restro-backend\src\controllers\outlet.controller.js:17:42)
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\validate.js:36:5
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
    at next (E:\restro-backend\node_modules\express\lib\router\route.js:149:13)
    at E:\restro-backend\src\middlewares\auth.middleware.js:134:5
    at Layer.handle [as handle_request] (E:\restro-backend\node_modules\express\lib\router\layer.js:95:5)
2026-02-22 18:55:16 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:135:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:209:22)
2026-02-22 18:55:16 [ERROR]: Generate bill error: Order not found
Error: Order not found
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:353:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:390:23)
2026-02-22 18:56:28 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:135:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:209:22)
2026-02-22 18:56:28 [ERROR]: Generate bill error: Order not found
Error: Order not found
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:353:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:390:23)
2026-02-22 18:57:52 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:135:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:209:22)
2026-02-22 18:57:52 [ERROR]: Generate bill error: Order not found
Error: Order not found
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:353:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:390:23)
2026-02-22 18:58:51 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:135:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:209:22)
2026-02-22 18:58:51 [ERROR]: Generate bill error: Order not found
Error: Order not found
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:353:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:390:23)
2026-02-22 19:01:34 [ERROR]: Send KOT error: Order not found
Error: Order not found
    at Object.sendKot (E:\restro-backend\src\services\kot.service.js:135:29)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async sendKot (E:\restro-backend\src\controllers\order.controller.js:209:22)
2026-02-22 19:01:34 [ERROR]: Generate bill error: Order not found
Error: Order not found
    at Object.generateBill (E:\restro-backend\src\services\billing.service.js:353:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async generateBill (E:\restro-backend\src\controllers\order.controller.js:390:23)
2026-02-22 23:44:43 [ERROR]: Direct KOT print failed for KOT0222004:
2026-02-22 23:44:43 [ERROR]: Failed to print KOT KOT0222004:
2026-02-22 23:44:47 [ERROR]: Direct Bill print failed for INV/2526/000339:
2026-02-22 23:44:47 [ERROR]: Direct bill print failed for INV/2526/000339:
2026-02-23 18:47:34 [ERROR]: Failed to start server: Access denied for user 'restro'@'localhost' (using password: YES) {"code":"ER_ACCESS_DENIED_ERROR","errno":1045,"sqlState":"28000","sqlMessage":"Access denied for user 'restro'@'localhost' (using password: YES)"}
Error: Access denied for user 'restro'@'localhost' (using password: YES)
    at Packet.asError (D:\Projects\restro-backend\node_modules\mysql2\lib\packets\packet.js:739:17)
    at ClientHandshake.execute (D:\Projects\restro-backend\node_modules\mysql2\lib\commands\command.js:29:26)
    at PoolConnection.handlePacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:508:34)
    at PacketParser.onPacket (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:93:12)
    at PacketParser.executeStart (D:\Projects\restro-backend\node_modules\mysql2\lib\packet_parser.js:75:16)
    at Socket.<anonymous> (D:\Projects\restro-backend\node_modules\mysql2\lib\base\connection.js:100:25)
    at Socket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:561:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:512:3)
    at Readable.push (node:internal/streams/readable:392:5)
2026-02-24 10:06:50 [ERROR]: Failed to start server: {"code":"ECONNREFUSED","fatal":true}
AggregateError [ECONNREFUSED]: 
    at internalConnectMultiple (node:net:1134:18)
    at afterConnectMultiple (node:net:1715:7)
